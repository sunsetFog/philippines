(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-dac5"],{"1X04":function(e,t,a){"use strict";a.r(t);var i=a("QbLZ"),r=a.n(i),n=a("L2JU"),o=a("t3Un");a("Yfch");function l(e){var t=e.formInline.url.join(",");Object(o.a)({url:e.public.url+"/backend/org/getList",method:"post",data:{pageno:e.currentPage,pagerows:e.pagesize,org_id:e.formInline.user,domain_id:t}}).then(function(t){e.tableData=t.data.list,e.total=1*t.data.rownum,e.currentPage=1*t.data.pageno}).catch(function(e){})}function s(e){Object(o.a)({url:e.public.url+"/backend/domain/getdomainlist",method:"post"}).then(function(t){e.domainlist=t.data}).catch(function(e){})}var u={data:function(){return{formInline:{user:"",url:[]},currentPage:1,userlist:[],tableData:[],dialogFormVisible:!1,dialogFormVisible2:!1,form:{name:"",domain:[],type:"1",status:""},form2:{domain:[],name:"",type:""},rules:{name:[{required:!0,message:"请输入玩家渠道",trigger:"blur"}],domain:[{required:!0,message:"请选择域名",trigger:"change"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},rules2:{domain:[{required:!0,message:"请选择域名",trigger:"change"}]},domainlist:[],domainlists:[],formLabelWidth:"120px",title:"",name:"",total:0,pagesize:50,ids:[],typelist:[{name:"内部公司",id:"1"},{name:"外部接入商",id:"2"}]}},created:function(){!function(e){Object(o.a)({url:e.public.url+"/backend/org/getOrglist",method:"post"}).then(function(t){e.userlist=t.data}).catch(function(e){})}(this),function(e){Object(o.a)({url:e.public.url+"/backend/domain/getdomains",method:"post"}).then(function(t){e.domainlists=t.data}).catch(function(e){})}(this);this.org.length||0==this.org.length||(this.currentPage=this.org.currentPage,this.pagesize=this.org.pagesize,this.formInline.user=this.org.user,l(this))},computed:r()({},Object(n.b)(["orgadd","orgdel","orgupdate","orggetlist","org","orgrestcreatekey","orgupdatedomain"])),methods:{reset:function(e){this.dialogFormVisible=!1,this.$refs.form.resetFields()},reset2:function(e){this.dialogFormVisible2=!1,this.$refs.form2.resetFields()},key:function(e){var t=this;Object(o.a)({url:t.public.url+"/backend/org/restcreatekey",method:"post",data:{id:e.id}}).then(function(e){t.$message({type:"success",message:e.message}),l(t)}).catch(function(e){})},cell:function(e){e.row,e.column,e.rowIndex,e.columnIndex},query:function(){this.currentPage=1,l(this);var e={currentPage:this.currentPage,pagesize:this.pagesize,user:this.formInline.user,url:this.formInline.url};this.$store.commit("setorg",e)},edit:function(e){this.title="编辑渠道组管理",this.dialogFormVisible=!0;var t=this;s(this),Object(o.a)({url:t.public.url+"/backend/org/getinfo",method:"post",data:{id:e.id}}).then(function(e){if(t.form.name=e.data.name,t.form.type=e.data.type,t.form.status=1*e.data.status,e.data.url)for(var a=e.data.url.split(","),i=t.domainlist.map(function(e){return e.url}),r=0;r<a.length;r++){var n=a[r],o=n.split("|")[1],l=n.split("|")[0];i.includes(o)||t.domainlist.push({id:l,url:o}),t.form.domain.push(l)}else t.form.domain=[];t.id=e.data.id}).catch(function(e){})},editdomain:function(e){this.dialogFormVisible2=!0;var t=this;s(this),Object(o.a)({url:t.public.url+"/backend/org/getinfo",method:"post",data:{id:e.id}}).then(function(e){if("1"==e.data.type?t.form2.type="内部公司":t.form2.type="外部接入商",t.form2.name=e.data.name,e.data.url)for(var a=e.data.url.split(","),i=t.domainlist.map(function(e){return e.url}),r=0;r<a.length;r++){var n=a[r],o=n.split("|")[1],l=n.split("|")[0];i.includes(o)||t.domainlist.push({id:l,url:o}),t.form2.domain.push(l)}else t.form2.domain=[];t.id=e.data.id}).catch(function(e){})},add:function(){this.title="新增渠道组管理",this.dialogFormVisible=!0,s(this)},sure:function(e){var t=this,a=this;this.$refs.form.validate(function(e){if(!e)return!1;if("编辑渠道组管理"===t.title){var i=t.form.domain.join(",");Object(o.a)({url:a.public.url+"/backend/org/update",method:"post",data:{name:t.form.name,domain_id:i,id:t.id,type:t.form.type,status:t.form.status}}).then(function(e){a.$message({type:"success",message:e.message}),a.dialogFormVisible=!1,a.$refs.form.resetFields(),l(a)}).catch(function(e){})}else{var r=t.form.domain.join(",");Object(o.a)({url:a.public.url+"/backend/org/add",method:"post",data:{name:t.form.name,domain_id:r,type:t.form.type,status:t.form.status}}).then(function(e){a.$message({type:"success",message:e.message}),a.dialogFormVisible=!1,a.$refs.form.resetFields(),l(a)}).catch(function(e){})}})},sure2:function(e){var t=this,a=this;this.$refs.form2.validate(function(e){if(!e)return!1;var i=t.form2.domain.join(",");Object(o.a)({url:a.public.url+"/backend/org/updatedomain",method:"post",data:{domain_id:i,id:t.id}}).then(function(e){a.$message({type:"success",message:e.message}),a.dialogFormVisible2=!1,a.$refs.form2.resetFields(),l(a)}).catch(function(e){})})},delet:function(e){var t=this,a=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){Object(o.a)({url:a.public.url+"/backend/org/del",method:"post",data:{id:e.id}}).then(function(e){l(a)}).catch(function(e){})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleSizeChange:function(e){this.pagesize=e,this.currentPage=1,l(this);var t={currentPage:this.currentPage,pagesize:this.pagesize,user:this.formInline.user,url:this.formInline.url};this.$store.commit("setorg",t)},handleCurrentChange:function(e){this.currentPage=1*e,l(this);var t={currentPage:this.currentPage,pagesize:this.pagesize,user:this.formInline.user,url:this.formInline.url};this.$store.commit("setorg",t)}},filters:{parseTime:function(e){if(e>0){var t=new Date(1e3*e);return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+((t.getDate()<10?"0"+t.getDate():t.getDate())+" ")+((t.getHours()<10?"0"+t.getHours():t.getHours())+":")+((t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":")+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}return""},time:function(e){return"-1"===e?"":e}}},c=(a("CtQP"),a("KHd+")),d=Object(c.a)(u,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"query"},[a("el-row",[a("el-form",{attrs:{inline:!0,"label-width":"150px"}},[a("el-col",{attrs:{span:2}},[e.orgadd?a("el-button",{attrs:{type:"info",round:""},on:{click:e.add}},[e._v("新增 + ")]):e._e()],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"玩家渠道"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择玩家渠道"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}},e._l(e.userlist,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"域名"}},[a("el-select",{attrs:{multiple:"",filterable:""},model:{value:e.formInline.url,callback:function(t){e.$set(e.formInline,"url",t)},expression:"formInline.url"}},e._l(e.domainlists,function(e){return a("el-option",{key:e.id,attrs:{label:e.url,value:e.id}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:2}},[e.orggetlist?a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.query}},[e._v("查询")]):e._e()],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"pagingbox"},[a("div",{staticClass:"paging"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pagesize,background:"",layout:"prev, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1)]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"cell-class-name":e.cell,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"渠道代码"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"玩家渠道"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"secretkey",label:"授权key"}}),e._v(" "),a("el-table-column",{attrs:{prop:"url",width:"350",label:"域名"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("time")(t.row.create_time))+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"修改时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("time")(t.row.update_time))+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.orgupdate?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.edit(t.row)}}},[e._v("修改")]):e._e(),e._v(" "),e.orgupdate?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.editdomain(t.row)}}},[e._v("修改域名")]):e._e(),e._v(" "),e.orgupdate?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.key(t.row)}}},[e._v("重新生成key")]):e._e()]}}])})],1),e._v(" "),a("div",{staticClass:"pagingbox"},[a("div",{staticClass:"paging"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[50,100,200],"page-size":e.pagesize,background:"",layout:"sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1)]),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.dialogFormVisible,"before-close":e.reset},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"类型","label-width":e.formLabelWidth,prop:"type"}},[a("el-select",{attrs:{filterable:""},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.typelist,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"玩家渠道","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"域名","label-width":e.formLabelWidth,prop:"domain"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:""},model:{value:e.form.domain,callback:function(t){e.$set(e.form,"domain",t)},expression:"form.domain"}},e._l(e.domainlist,function(e){return a("el-option",{key:e.id,attrs:{label:e.url,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"状态：","label-width":e.formLabelWidth,prop:"status"}},[a("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-radio",{attrs:{label:0}},[e._v("禁用")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("可用")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.reset(e.form)}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sure(e.form)}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改渠道域名",visible:e.dialogFormVisible2,"before-close":e.reset2},on:{"update:visible":function(t){e.dialogFormVisible2=t}}},[a("el-form",{ref:"form2",attrs:{model:e.form2,rules:e.rules2}},[a("el-form-item",{attrs:{label:"类型","label-width":e.formLabelWidth}},[a("span",[e._v(e._s(e.form2.type))])]),e._v(" "),a("el-form-item",{attrs:{label:"玩家渠道","label-width":e.formLabelWidth}},[a("span",[e._v(e._s(e.form2.name))])]),e._v(" "),a("el-form-item",{attrs:{label:"域名","label-width":e.formLabelWidth,prop:"domain"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:""},model:{value:e.form2.domain,callback:function(t){e.$set(e.form2,"domain",t)},expression:"form2.domain"}},e._l(e.domainlist,function(e){return a("el-option",{key:e.id,attrs:{label:e.url,value:e.id}})}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.reset2(e.form)}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sure2(e.form)}}},[e._v("确 定")])],1)],1)],1)},[],!1,null,null,null);d.options.__file="org.vue";t.default=d.exports},CtQP:function(e,t,a){"use strict";var i=a("mKOv");a.n(i).a},Yfch:function(e,t,a){"use strict";function i(e){return/^[a-zA-Z_]\w{2,17}$/.test(e)}function r(e){return/^[A-Za-z]+$/.test(e)}function n(e){return/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,12}$/.test(e)}a.d(t,"a",function(){return i}),a.d(t,"b",function(){return r}),a.d(t,"c",function(){return n})},mKOv:function(e,t,a){}}]);