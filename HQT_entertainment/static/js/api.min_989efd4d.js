function Basiie(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.encode=function(r){var o,n,i,s,a,c,u,h="",l=0;for(r=e(r);l<r.length;)o=r.charCodeAt(l++),n=r.charCodeAt(l++),i=r.charCodeAt(l++),s=o>>2,a=(3&o)<<4|n>>4,c=(15&n)<<2|i>>6,u=63&i,isNaN(n)?c=u=64:isNaN(i)&&(u=64),h=h+t.charAt(s)+t.charAt(a)+t.charAt(c)+t.charAt(u);return h},this.decode=function(e){var o,n,i,s,a,c,u,h="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)s=t.indexOf(e.charAt(l++)),a=t.indexOf(e.charAt(l++)),c=t.indexOf(e.charAt(l++)),u=t.indexOf(e.charAt(l++)),o=s<<2|a>>4,n=(15&a)<<4|c>>2,i=(3&c)<<6|u,h+=String.fromCharCode(o),64!=c&&(h+=String.fromCharCode(n)),64!=u&&(h+=String.fromCharCode(i));return h=r(h)};var e=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",r=0;r<t.length;r++){var o=t.charCodeAt(r);128>o?e+=String.fromCharCode(o):o>127&&2048>o?(e+=String.fromCharCode(o>>6|192),e+=String.fromCharCode(63&o|128)):(e+=String.fromCharCode(o>>12|224),e+=String.fromCharCode(o>>6&63|128),e+=String.fromCharCode(63&o|128))}return e},r=function(t){for(var e="",r=0,o=0,n=0,i=0;r<t.length;)o=t.charCodeAt(r),128>o?(e+=String.fromCharCode(o),r++):o>191&&224>o?(n=t.charCodeAt(r+1),e+=String.fromCharCode((31&o)<<6|63&n),r+=2):(n=t.charCodeAt(r+1),i=t.charCodeAt(r+2),e+=String.fromCharCode((15&o)<<12|(63&n)<<6|63&i),r+=3);return e}}var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);r.prototype=e.prototype,t.prototype=new r},BaseClass=function(){function t(){}return t.getInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this;if(!r._instance){var o=t.length;0==o?r._instance=new r:1==o?r._instance=new r(t[0]):2==o?r._instance=new r(t[0],t[1]):3==o?r._instance=new r(t[0],t[1],t[2]):4==o?r._instance=new r(t[0],t[1],t[2],t[3]):5==o&&(r._instance=new r(t[0],t[1],t[2],t[3],t[4]))}return r._instance},t}();__reflect(BaseClass.prototype,"BaseClass");var ByteArrayMsg=function(){function t(){this._msgBuffer=new egret.ByteArray}return t.prototype.receive=function(t){if(this._msgBuffer.clear(),t.readBytes(this._msgBuffer),!this._msgBuffer.bytesAvailable)return void Log.error("可读取数据的有效字节数为0!",this._msgBuffer);var e=this.decode(this._msgBuffer);e&&MessageCenter.getInstance().dispatch("Socket_CMD_"+e.key,e.body)},t.prototype.send=function(t,e){var r=this.encode(e);r?(r.position=0,t.writeBytes(r,0,r.bytesAvailable)):Log.error("数据错误：",r)},t.prototype.decode=function(t){return Log.log("decode需要子类重写，根据项目的协议结构解析"),null},t.prototype.encode=function(t){return Log.log("encode需要子类重写，根据项目的协议结构解析"),null},t}();__reflect(ByteArrayMsg.prototype,"ByteArrayMsg",["BaseMsg"]);var UTFMsg=function(){function t(){}return t.prototype.receive=function(t){var e=t.readUTF(),r=this.decode(e);r&&MessageCenter.getInstance().dispatch(r.key,r.body)},t.prototype.send=function(t,e){var r=this.encode(e);r&&(t.type=egret.WebSocket.TYPE_STRING,t.writeUTF(r))},t.prototype.decode=function(t){return Log.log("decode需要子类重写，根据项目的协议结构解析"),null},t.prototype.encode=function(t){return Log.log("encode需要子类重写，根据项目的协议结构解析"),null},t}();__reflect(UTFMsg.prototype,"UTFMsg",["BaseMsg"]);var BaseSound=function(){function t(){this._mLoadingNum=0,this._cache={},this._mCacheError={},this._mLoadCache=[]}return t.prototype.dealSoundTimer=function(){},t.prototype.getSound=function(t){var e=this._cache[t];if(e)return e;var r=RES.getResourceInfo(t);return r?(this._mLoadCache.push(t),this.loadSound(),null):void Log.error("没有这个音效的配置信息:",t)},t.prototype.loadSound=function(){if(!(this._mLoadCache.length<=0||this._mLoadingNum>=3)){var t=this._mLoadCache.shift();if(1!=this._cache[t+"_loading"]){this._cache[t+"_loading"]=1;var e=new egret.Sound;e._name_=t,e.addEventListener(egret.Event.COMPLETE,this.onSoundLoadComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSoundLoadError,this);var r=RES.getResourceInfo(t);e.load(r.root+r.url),this._mLoadingNum++}}},t.prototype.onSoundLoadComplete=function(t){var e=t.currentTarget;e.removeEventListener(egret.Event.COMPLETE,this.onSoundLoadComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSoundLoadError,this);var r=e._name_;this._cache[r]=e,this.loadedPlay(r,e),this._mLoadingNum--},t.prototype.onSoundLoadError=function(t){var e=t.currentTarget,r=e._name_;e.removeEventListener(egret.Event.COMPLETE,this.onSoundLoadComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSoundLoadError,this),Log.warn("音效加载失败:",r,t),this._mCacheError[r]?this._mCacheError[r]++:this._mCacheError[r]=1,this._mLoadingNum--,this._mCacheError[r]<=3&&(this._mLoadCache.push(r),this.loadSound())},t.prototype.loadedPlay=function(t,e){},t.prototype.checkCanClear=function(t){return!0},t.prototype.clear=function(){this.dealSoundTimer()},t}();__reflect(BaseSound.prototype,"BaseSound");var ByteArrayMsgByProtobuf=function(t){function e(){var e=t.call(this)||this;return e.msgClass=null,e.protoConfig=null,e.protoConfigSymmetry=null,e.msgClass={},e.protoConfigSymmetry={},e.protoConfig={},e}return __extends(e,t),e.prototype.initProtocol=function(t){for(var e=Object.keys(t),r=0,o=e.length;o>r;r++){var n=parseInt(e[r]),i=t[n];this.protoConfig[n]&&Log.warn("警告! 协议号重复注册, 将替换原有注册：msgId =",n,this.protoConfig[n],t[n]),this.protoConfig[n]=i,this.protoConfigSymmetry[i]=n}},e.prototype.getMsgClass=function(t){var e=parseInt(""+t),r=this.msgClass[e];if(null==r){var o=this.protoConfig[e];if(!o)return Log.error("当前协议号未注册：msgId =",e,"到指定的游戏资源目录下的proto文件夹下注册对应协议结构体"),null;if(r=egret.getDefinitionByName(o),!r)return Log.error("Protobuf文件里没有找到",o,"结构体，需要编译Protobuf "),null;this.msgClass[t]=r}return r},e.prototype.getMsgID=function(t){return this.protoConfigSymmetry[t]},e.prototype.getMsgName=function(t){return this.protoConfig[t]},e.prototype.decode=function(t){var e=t.readInt()-6,r=t.readShort();if(Log.log("收到数据：",r,this.getMsgName(r)),t.bytesAvailable>=e){var o=ObjectPool.pop("egret.ByteArray");t.readBytes(o,0,e);var n={},i=this.getMsgClass(r);return n.key=r,i&&(n.body=i.decode(o.bytes),Log.log("body:",n.body)),o.clear(),ObjectPool.push(o),n}return Log.error("可读取数据的有效字节数小于指定长度","服务器返回长度:",e,"当前有效长度:",t.bytesAvailable,"msgId:",r,"msg:",t),null},e.prototype.encode=function(t){var e=t.key,r=this.getMsgClass(e);if(!r)return Log.error("Protobuf文件里没有找到",e,"结构体","需要编译Protobuf 或者 添加注册文件.",t),null;var o=r.fromObject(t.body),n=r.encode(o).finish(),i=new egret.ByteArray(n);Log.log("发送数据：",e,this.getMsgName(e),t.body);var s=new egret.ByteArray;return s.writeInt(i.length+6),s.writeShort(e),s.writeBytes(i),s},e}(ByteArrayMsg);__reflect(ByteArrayMsgByProtobuf.prototype,"ByteArrayMsgByProtobuf");var RConst=function(){function t(){}return t.Loading_Show="Loading_Show_Event",t.Loading_Hide="Loading_Hide_Event",t.ProxyUserFlag="",t}();__reflect(RConst.prototype,"RConst");var DragonBonesArmature=function(t){function e(){var e=t.call(this)||this;return e._completeCalls=[],e._frameCalls=[],e._isPlay=!1,e._playName="",e}return __extends(e,t),e.prototype.setSpeed=function(t){this._clock.timeScale=t},e.prototype.updateArmature=function(t,e){this.removeChildren(),this.stop(),this._frameCalls.length=0,this._completeCalls.length=0,this._armature=t,this._clock=e,this.addChild(this._armature.display)},e.prototype.addListeners=function(){this._armature.eventDispatcher.addDBEventListener(dragonBones.EventObject.COMPLETE,this.completeHandler,this),this._armature.eventDispatcher.addDBEventListener(dragonBones.EventObject.FRAME_EVENT,this.frameHandler,this)},e.prototype.removeListeners=function(){this._armature.eventDispatcher.removeDBEventListener(dragonBones.EventObject.COMPLETE,this.completeHandler,this),this._armature.eventDispatcher.removeDBEventListener(dragonBones.EventObject.FRAME_EVENT,this.frameHandler,this)},e.prototype.completeHandler=function(t){for(var e=t.eventObject.animationState.name,r=0,o=this._completeCalls.length;o>r;r++){var n=this._completeCalls[r];n[0].apply(n[1],[t,e])}e==this._playName&&(this._playName="")},e.prototype.frameHandler=function(t){for(var e=0,r=this._frameCalls.length;r>e;e++){var o=this._frameCalls[e];o[0].apply(o[1],[t])}},e.prototype.play=function(t,e,r){return this.playByProgress(t,0,e,r)},e.prototype.playByProgress=function(t,e,r,o){return this.setSpeed(o?o:1),this._playName==t?this._currAnimationState:(this._playName=t,this.start(),this._currAnimationState=this.getAnimation().gotoAndPlayByProgress(t,e,r),this._currAnimationState)},e.prototype.start=function(){this._isPlay||(this._clock.add(this._armature),this._isPlay=!0,this.addListeners())},e.prototype.stop=function(){this._isPlay&&(this._clock.remove(this._armature),this._isPlay=!1,this._playName="",this.removeListeners())},e.prototype.destroy=function(){this.stop(),this.removeChildren(),this.parent&&this.parent.removeChild(this),this._frameCalls.length=0,this._completeCalls.length=0,this._clock=void 0,this._armature=void 0,this._frameCalls=void 0,this._completeCalls=void 0,this._currAnimationState=void 0},e.prototype.addCompleteCallFunc=function(t,e){for(var r=0;r<this._completeCalls.length;r++){var o=this._completeCalls[r];if(o[0]==t&&o[1]==e)return}this._completeCalls.unshift([t,e])},e.prototype.removeCompleteCallFunc=function(t,e){for(var r=0;r<this._completeCalls.length;r++){var o=this._completeCalls[r];o[0]==t&&o[1]==e&&(this._completeCalls.splice(r,1),r--)}},e.prototype.addFrameCallFunc=function(t,e){for(var r=0;r<this._frameCalls.length;r++){var o=this._frameCalls[r];if(o[0]==t&&o[1]==e)return}this._frameCalls.push([t,e])},e.prototype.removeFrameCallFunc=function(t,e){for(var r=0;r<this._frameCalls.length;r++){var o=this._frameCalls[r];o[0]==t&&o[1]==e&&(this._frameCalls.splice(r,1),r--)}},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.stop()},e.prototype.getArmature=function(){return this._armature},e.prototype.getCurrAnimationState=function(){return this._currAnimationState},e.prototype.getClock=function(){return this._clock},e.prototype.getAnimation=function(){return this._armature.animation},e.prototype.getBone=function(t){return this._armature.getBone(t)},e.prototype.getAnimationDuration=function(t){return this._armature.animation.animations[t].duration},e.prototype.getPlayName=function(){return this._playName},e.prototype.getBoneDisplay=function(t){return t.slot.display},e.prototype.changeBone=function(t,e){var r=this.getBone(t);r&&r.slot.setDisplay(e)},e}(egret.DisplayObjectContainer);__reflect(DragonBonesArmature.prototype,"DragonBonesArmature");var DragonBonesArmatureContainer=function(t){function e(){var e=t.call(this)||this;return e.armatures=[],e.actions={},e.cacheBones={},e}return __extends(e,t),e.prototype.register=function(t,e){this.armatures.push(t);for(var r=0,o=e.length;o>r;r++)this.actions[e[r]]=this.armatures.length-1},Object.defineProperty(e.prototype,"armature",{get:function(){return this.armatures[this.currArmatureIndex]},enumerable:!0,configurable:!0}),e.prototype.getCacheBone=function(t){if(!this.cacheBones[t]){this.cacheBones[t]=[];for(var e=0,r=this.armatures.length;r>e;e++){var o=this.armatures[e];this.cacheBones[t].push(o.getBone(t))}}return this.cacheBones[t][this.currArmatureIndex]},e.prototype.play=function(t,e,r){return void 0===e&&(e=void 0),void 0===r&&(r=1),this.playByProgress(t,0,e,r)},e.prototype.playByProgress=function(t,e,r,o){if(void 0===o&&(o=1),null==this.actions[t])return void Log.warn("DragonBonesArmatureContainer不存在动作：",t);var n=this.actions[t];n!=this.currArmatureIndex&&this.remove();var i=this.armatures[n];return i?(i.parent||this.addChild(i),this.currArmatureIndex=n,i.playByProgress(t,e,r,o)):null},e.prototype.stop=function(){var t=this.armatures[this.currArmatureIndex];t&&t.stop()},e.prototype.start=function(){var t=this.armatures[this.currArmatureIndex];t&&t.start()},e.prototype.remove=function(){var t=this.armatures[this.currArmatureIndex];t&&(t.stop(),t.parent&&t.parent.removeChild(t),this.currArmatureIndex=null)},e.prototype.addCompleteCallFunc=function(t,e){for(var r=0,o=this.armatures.length;o>r;r++){var n=this.armatures[r];n.addCompleteCallFunc(t,e)}},e.prototype.removeCompleteCallFunc=function(t,e){for(var r=0,o=this.armatures.length;o>r;r++){var n=this.armatures[r];n.removeCompleteCallFunc(t,e)}},e.prototype.addFrameCallFunc=function(t,e){for(var r=0,o=this.armatures.length;o>r;r++){var n=this.armatures[r];n.addFrameCallFunc(t,e)}},e.prototype.removeFrameCallFunc=function(t,e){for(var r=0,o=this.armatures.length;o>r;r++){var n=this.armatures[r];n.removeFrameCallFunc(t,e)}},e.prototype.removeFromParent=function(){R.removeFromParent(this)},e.prototype.clear=function(){for(;this.armatures.length;){var t=this.armatures.pop();t.parent&&t.parent.removeChild(t),t.destroy()}this.cacheBones={},this.actions={}},e.prototype.destroy=function(){this.clear(),this.armatures=void 0,this.cacheBones=void 0,this.actions=void 0},e}(egret.DisplayObjectContainer);__reflect(DragonBonesArmatureContainer.prototype,"DragonBonesArmatureContainer");var DragonBonesFactory=function(t){function e(){var e=t.call(this)||this;return e.averageUtils=new AverageUtils,e.factory=new dragonBones.EgretFactory,e.clocks=new Array,e.clocksLen=0,e.files=[],e}return __extends(e,t),e.prototype.initArmatureFileByName=function(t){var e=RES.getRes(t+"_ske_json"),r=RES.getRes(t+"_tex_json"),o=RES.getRes(t+"_tex_png");e&&o&&r?this.initArmatureFile(e,o,r):Log.error("无法获取龙骨资源:",t)},e.prototype.initArmatureFile=function(t,e,r){-1==this.files.indexOf(t.name)&&(this.addSkeletonData(t),this.addTextureAtlas(e,r),this.files.push(t.name),this.start())},e.prototype.addSkeletonData=function(t){this.factory.parseDragonBonesData(t)},e.prototype.addTextureAtlas=function(t,e){this.factory.parseTextureAtlasData(e,t)},e.prototype.removeSkeletonData=function(t){this.factory.removeDragonBonesData(t)},e.prototype.removeTextureAtlas=function(t){this.factory.removeTextureAtlasData(t)},e.prototype.makeArmature=function(t,e,r){void 0===r&&(r=1);var o=this.factory.buildArmature(t,e);if(null==o)return Log.warn("不存在Armature： "+t),null;var n=this.createWorldClock(r),i=new DragonBonesArmature;return i.updateArmature(o,n),i},e.prototype.makeFastArmature=function(t,e,r){void 0===r&&(r=1);var o=this.makeArmature(t,e,r);return o.getArmature().cacheFrameRate=24,o},e.prototype.createWorldClock=function(t){for(var e=0;e<this.clocksLen;e++)if(this.clocks[e].timeScale==t)return this.clocks[e];var r=new dragonBones.WorldClock;return r.timeScale=t,this.clocks.push(r),this.clocksLen=this.clocks.length,r},e.prototype.onEnterFrame=function(t){this.averageUtils.push(t);for(var e=.001*this.averageUtils.getValue(),r=0;r<this.clocksLen;r++){var o=this.clocks[r];o.advanceTime(e)}},e.prototype.stop=function(){this.isPlay&&(TimerManager.getInstance().removeAll(this),this.isPlay=!1)},e.prototype.start=function(){this.isPlay||(this.isPlay=!0,TimerManager.getInstance().doFrame(1,0,this.onEnterFrame,this))},e.prototype.removeArmatureFile=function(t){var e=this.files.indexOf(t);-1!=e&&(this.removeSkeletonData(t),this.removeTextureAtlas(t),this.files.splice(e,1))},e.prototype.clear=function(){for(this.stop();this.files.length;)this.removeArmatureFile(this.files[0])},e}(BaseClass);__reflect(DragonBonesFactory.prototype,"DragonBonesFactory");var R;!function(t){function e(e,r,o,n){return t.setTimeOut(e,r,o,n)}function r(t,e,r,o){var n=function(){t.call(e,o)}.bind(e);return TimerManager.getInstance().doTimer(r,1,n,e),n}function o(t,e,r){return TimerManager.getInstance().doTimer(r,1,t,e),t}function n(t,e){TimerManager.getInstance().remove(t,e)}function i(t){TimerManager.getInstance().removeAll(t)}function s(t){t&&t.parent&&t.parent.removeChild(t)}function a(t,e){void 0===t&&(t=300);var r=c,o=e?e:"x_key",n=r[o]?r[o]:0,i=egret.getTimer();return i-n>=t?(r&&(r[o]=i),!0):!1}t.setTimeOnce=e,t.setTimeOut=r,t.setTimeOutOnly=o,t.removeTimeOut=n,t.removeAllTimeOut=i,t.removeFromParent=s;var c={};t.intervalTime=a}(R||(R={}));var BaseMovieClip=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.removeFormParent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.clean=function(){this.destroy()},e.prototype.destroy=function(){this.removeFormParent(),this.stop(),this.movieClipData=void 0},e}(egret.MovieClip);__reflect(BaseMovieClip.prototype,"BaseMovieClip");var MovieClipFactory=function(t){function e(){var e=t.call(this)||this;return e._mcDataList=null,e._mcDataList={},e}return __extends(e,t),e.prototype.initMovieClip=function(t,e){if(!this._mcDataList[e]){var r=RES.getRes(t+"_json"),o=RES.getRes(t+"_png");r||Log.error("mc "+e+" data underfined"),o||Log.error("mc "+e+" texture underfined"),this._mcDataList[e]=new egret.MovieClipDataFactory(r,o)}},e.prototype.createMovieClip=function(t){var e=this._mcDataList[t];if(!e)return void Log.error(t,"没有初始化!");var r=ObjectPool.pop("BaseMovieClip");return r.movieClipData=e.generateMovieClipData(t),r},e.prototype.releseMovieClip=function(t){t.clean(),ObjectPool.push(t)},e.prototype.clear=function(){ObjectPool.clearClass("BaseMovieClip","destroy");var t=Object.keys(this._mcDataList);for(var e in t)this._mcDataList[e]&&(this._mcDataList[e].clearCache(),this._mcDataList[e]=void 0)},e}(BaseClass);__reflect(MovieClipFactory.prototype,"MovieClipFactory");var SpriteMovieClip=function(t){function e(){var e=t.call(this)||this;return e._mInit=!1,e._mCurrCount=0,e._mDealyTime=1,e._mCurrFrame=0,e._mMaxFrame=0,e._mTotalPlayTimes=1,e._mCurrPlayTimes=0,e._mIsStart=!1,e._mIsPause=!1,e.onCreate(),e}return __extends(e,t),e.prototype.onCreate=function(){this._mTexture=new egret.Bitmap,this._mResList=[],this._mTextureList={}},e.prototype.initMc=function(t,e){if(!this._mInit){for(this.addChild(this._mTexture);t.length;){var r=t.shift();this._mResList.push(r)}(1>e||e>60)&&Log.error("帧率不能小于1或者大于60"),this._mDealyTime=Math.floor(60/e),this._mMaxFrame=this._mResList.length,this._mCurrFrame=0,this._mInit=!0}},e.prototype.addCompleteCallFunc=function(t,e){this._mCompleteFun=t,this._mCompleteThisObj=e},e.prototype.removeCompleteCallFunc=function(){this._mCompleteFun=void 0,this._mCompleteThisObj=void 0},e.prototype.reloadRes=function(){for(var t=this._mResList,e=t.length-1;e>=0;e--)RES.getResAsync(t[e],function(t,e){egret.log("smc reloadRes:",e)},this)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.play=function(t){this.gotoAndPlay(1,t)},e.prototype.gotoAndPlay=function(t,e){this._mCurrCount=0,this._mCurrFrame=t-1,this._mTotalPlayTimes=e?e:1,this._mCurrPlayTimes=0,this._mIsStart=!0,TimerManager.getInstance().doFrame(1,0,this.update,this)},e.prototype.rePlay=function(){this._mIsPause&&(this._mIsStart=!0),this._mIsPause=!1,TimerManager.getInstance().doFrame(1,0,this.update,this)},e.prototype.stop=function(){this._mIsPause=!0,this._mIsStart=!1,TimerManager.getInstance().removeAll(this)},e.prototype.update=function(){this._mInit&&this._mIsStart&&(this._mCurrCount++,this._mCurrCount%this._mDealyTime==0&&(this._mCurrFrame++,this.refreshTexture(),this._mCurrFrame>=this._mMaxFrame&&(this._mCurrFrame=0,this._mCurrPlayTimes++,this.checkPlayEnd())))},e.prototype.refreshTexture=function(){var t=this._mTextureList,e=this._mResList[this._mCurrFrame-1],r=t[e];r||(r=RES.getRes(e),t[e]=r),this._mTexture.texture=r,this._mTexture.x=0-this._mTexture.width/2,this._mTexture.y=0-this._mTexture.height/2},e.prototype.checkPlayEnd=function(){this._mCurrPlayTimes>=this._mTotalPlayTimes&&(this._mIsStart=!1,this._mCompleteFun&&this._mCompleteFun.call(this._mCompleteThisObj))},e.prototype.clean=function(){TimerManager.getInstance().removeAll(this),this._mIsStart=!1,this.removeChildren(),this.removeFormParent(),this.removeCompleteCallFunc(),this._mTotalPlayTimes=1,this._mCurrPlayTimes=0,this._mDealyTime=1,this._mCurrCount=0,this._mCurrFrame=0,this._mMaxFrame=0,this._mTexture.texture=void 0;var t=this._mTextureList;for(var e in t)t[e]=void 0,delete t[e];for(var r=this._mResList;r.length;)r.pop()},e.prototype.removeFormParent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.destroy=function(){this._mInit&&(this.clean(),this._mInit=!1,this._mTexture=void 0,this._mResList=void 0,this._mTextureList=void 0)},e}(eui.Component);__reflect(SpriteMovieClip.prototype,"SpriteMovieClip");var ControllerManager=function(t){function e(){var e=t.call(this)||this;return e._modules={},e}return __extends(e,t),e.prototype.clear=function(){this._modules={}},e.prototype.register=function(t,e){this.isExists(t)||(this._modules[t]=e)},e.prototype.unregister=function(t){if(this.isExists(t)){var e=this._modules[t];e&&e.destroy(),this._modules[t]=null,delete this._modules[t]}},e.prototype.isExists=function(t){return null!=this._modules[t]},e.prototype.applyFuncAll=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=this._modules;for(var n in o){var i=parseInt(n);this.applyFunc(i,t,e)}},e.prototype.applyFunc=function(t,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var n=this._modules[t];if(n){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];return n.applyFunc.apply(n,i)}return Log.error("Controller模块",t,"不存在"),null},e.prototype.getController=function(t){return this.isExists(t)?this._modules[t]:(Log.error("Controller 模块:",t,"不存在"),null)},e.prototype.getControllerModel=function(t){var e=this._modules[t];return e?e.getModel():null},e}(BaseClass);__reflect(ControllerManager.prototype,"ControllerManager");var ViewManager=function(t){function e(){var e=t.call(this)||this;return e._views={},e._opens=[],e}return __extends(e,t),e.prototype.clear=function(){this.closeAll(),this._views={}},e.prototype.register=function(t,e){null!=e&&(this._views[t]||(this._views[t]=e))},e.prototype.unregister=function(t){this._views[t]&&(this._views[t]=null,delete this._views[t])},e.prototype.destroyAll=function(){for(var t in this._views)this.destroy(parseInt(t))},e.prototype.destroy=function(t){var e=this.getView(t);e&&(this.close(t),this.unregister(t),e.destroy(),e=null),this.register(t,null)},e.prototype.open=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=this.getView(t);return null==o?void Log.log("UI_"+t+"不存在"):o.isShow()?o:(o.isInit()?(o.addToParent(),o.open.apply(o,e),o.addEvent()):(MessageCenter.getInstance().dispatch(RConst.Loading_Show),o.loadResource(function(){o.setVisible(!1),o.addToParent()}.bind(this),function(){o.initUI(),o.initData(),o.open.apply(o,e),o.setVisible(!0),o.addEvent(),MessageCenter.getInstance().dispatch(RConst.Loading_Hide)}.bind(this))),this._opens.push(t),o)},e.prototype.close=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(this.isShow(t)){var o=this.getView(t);if(null!=o){var n=this._opens.indexOf(t);n>=0&&this._opens.splice(n,1),o.removeEvent(),o.removeFromParent(),o.close.apply(o,e)}}},e.prototype.closeView=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var o=Object.keys(this._views),n=0,i=o.length;i>n;n++){var s=parseInt(o[n]);if(this._views[s]==t)return void this.close(s,e)}},e.prototype.getView=function(t){return this._views[t]},e.prototype.closeAll=function(){for(;this._opens.length;)this.close(this._opens[0])},e.prototype.currOpenNum=function(){return this._opens.length},e.prototype.isShow=function(t){return-1!=this._opens.indexOf(t)},e}(BaseClass);__reflect(ViewManager.prototype,"ViewManager");var BaseController=function(t){function e(){var e=t.call(this)||this;return e._messages={},e}return __extends(e,t),e.prototype.onCreate=function(){},e.prototype.onInit=function(){},e.prototype.onReconstruction=function(){},e.prototype.inits=function(){},e.prototype.registers=function(){},e.prototype.addListeners=function(){},e.prototype.registerFunc=function(t,e,r,o){if(void 0===o&&(o=1),!this.isExists(""+t,e,r)){var n=this._messages[t];n||(n=[],this._messages[t]=n),n.push([e,r,o]),n.sort(function(t,e){return e[2]-t[2]})}},e.prototype.applyFunc=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=this._messages[""+t];if(o)for(var n=o.length-1;n>=0;n--){var i=o[n];i[0].apply(i[1],e)}},e.prototype.isExists=function(t,e,r){var o=this._messages[""+t];if(!o)return!1;var n=0,i=o.length;for(n;i>n;n++)if(o[n][0]==e&&o[n][1]==r)return!0;return!1},e.prototype.applyControllerFunc=function(t,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];return ControllerManager.getInstance().applyFunc.apply(ControllerManager.getInstance(),arguments)},e.prototype.setModel=function(t){this._model=t},e.prototype.getModel=function(){return this._model},e.prototype.getControllerModel=function(t){return ControllerManager.getInstance().getControllerModel(t)},e.prototype.removeListeners=function(){},e.prototype.removeMessages=function(){for(var t in this._messages)this._messages[t]=void 0,delete this._messages[t]},e.prototype.destroy=function(){this.removeListeners(),this.removeMessages()},e}(egret.HashObject);__reflect(BaseController.prototype,"BaseController",["IBaseController"]);var BaseModel=function(){function t(t){t&&(this._controller=t)}return t.prototype.destroy=function(){this._controller=void 0},t}();__reflect(BaseModel.prototype,"BaseModel");var BaseProxy=function(){function t(t,e){this._controller=t,this._model=e}return t.Socket_Type=function(e){return t.Socket_CMD+e},t.prototype.addEvent=function(){},t.prototype.removeEvent=function(){},t.prototype.applyFunc=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this._controller.applyFunc.apply(this._controller,arguments)},t.prototype.applyControllerFunc=function(t,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];return this._controller.applyControllerFunc.apply(this._controller,arguments)},t.prototype.addListener=function(e,r,o){MessageCenter.getInstance().addListener(t.Socket_CMD+e,r,o)},t.prototype.receiveHttpEvent=function(t,e,r){MessageCenter.getInstance().addListener(t+"_HttpUpdate",e,r)},t.prototype.removeListener=function(e,r,o){MessageCenter.getInstance().removeListener(t.Socket_CMD+e,r,o)},t.prototype.removeHttpEvent=function(t,e,r){MessageCenter.getInstance().removeListener(t+"_HttpUpdate",e,r)},t.prototype.removeMsgEventAll=function(t){MessageCenter.getInstance().removeAll(t)},t.prototype.send=function(t,e){var r={};r.key=t,r.body=e,Socket.getInstance().send(r)},t.prototype.sendHttpMsg=function(t,e){void 0===e&&(e=null),Http.getInstance().send(t,this.getURLVariables(t,e))},t.prototype.getURLVariables=function(t,e){var r=t.split("."),o={};o.mod=r[0],o["do"]=r[1],null!=e&&(o.p=e);var n=JSON.stringify(o),i=new egret.URLVariables("data="+n+"&h="+RConst.ProxyUserFlag);return i},t.prototype.destroy=function(){this.removeEvent(),this._controller=void 0,this._model=void 0},t.Socket_CMD="Socket_CMD_",t}();__reflect(BaseProxy.prototype,"BaseProxy");var BaseEuiComponent=function(t){function e(e){var r=t.call(this)||this;return r._isDestroy=!1,e&&(r.skinName=e),r}return __extends(e,t),e.prototype.initComponent=function(t,e){this._controller=t,this._parent=e,this._parent&&this._parent.addChild(this),this._isDestroy=!1},e.prototype.applyFunc=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this._controller.applyFunc.apply(this._controller,arguments)},e.prototype.applyControllerFunc=function(t,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];return this._controller.applyControllerFunc.apply(this._controller,arguments)},e.prototype.destroy=function(){this._isDestroy||(this.removeFromParent(),this._controller=void 0,this._parent=void 0,this._isDestroy=!0)},e.prototype.addEvent=function(){},e.prototype.removeEvent=function(){},e.prototype.addListener=function(t,e,r,o){void 0===o&&(o=1),MessageCenter.getInstance().addListener(t,e,r,o)},e.prototype.removeListener=function(t,e,r){MessageCenter.getInstance().removeListener(t,e,r)},e.prototype.removeListeners=function(t){MessageCenter.getInstance().removeAll(t)},e.prototype.removeFromParent=function(){this._parent&&this._parent.removeChild(this)},e}(eui.Component);__reflect(BaseEuiComponent.prototype,"BaseEuiComponent");var BaseEuiView=function(t){function e(e,r){var o=t.call(this)||this;return o._isInit=!1,o._resources=null,o._isDestroy=!0,o._mIsRemoveEvent=!1,o._controller=e,o._myParent=r,o._isInit=!1,o._isDestroy=!1,o.percentHeight=100,o.percentWidth=100,o}return __extends(e,t),Object.defineProperty(e.prototype,"myParent",{get:function(){return this._myParent},enumerable:!0,configurable:!0}),e.prototype.setResources=function(t){this._resources=t},e.prototype.isInit=function(){return this._isInit},e.prototype.applyFunc=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this._controller.applyFunc.apply(this._controller,arguments)},e.prototype.applyControllerFunc=function(t,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];return this._controller.applyControllerFunc.apply(this._controller,arguments)},e.prototype.isShow=function(){return null!=this.stage&&this.visible},e.prototype.addToParent=function(){this.parent||this._myParent.addChild(this)},e.prototype.removeFromParent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.initUI=function(){this._isInit=!0},e.prototype.initData=function(){},e.prototype.clearDisplay=function(t){for(var e=t.numChildren-1,r=e;r>=0;r--){var o=t.getChildAt(r);if(egret.is(o,"egret.DisplayObjectContainer"))this.clearDisplay(o);else if(egret.is(o,"eui.Image")){var n=o;n.source=void 0,n.texture=void 0,n.$bitmapData=void 0}else if(egret.is(o,"eui.Bitmap")){var n=o;n.texture=void 0,n.$bitmapData=void 0}}},e.prototype.addEvent=function(){this._mIsRemoveEvent=!0},e.prototype.removeEvent=function(){this._mIsRemoveEvent=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.loadResource=function(t,e){this._resources&&this._resources.length>0?(ResourceUtils.getInstance().loadResource(this._resources,[],t,null,this),this.once(eui.UIEvent.CREATION_COMPLETE,e,this)):(t(),e())},e.prototype.getBaseController=function(){return this._controller},e.prototype.setVisible=function(t){this.visible=t},e.prototype.destroy=function(){this._isDestroy||(this._mIsRemoveEvent&&this.removeEvent(),this.clearDisplay(this),this.removeFromParent(),this._controller=void 0,this._myParent=void 0,this._resources=void 0,this._isInit=!1,this._isDestroy=!0)},e}(eui.Component);__reflect(BaseEuiView.prototype,"BaseEuiView",["IBaseView"]);var BaseSpriteView=function(t){function e(e,r){var o=t.call(this)||this;return o._resources=null,o._isDestroy=!0,o._mIsRemoveEvent=!1,o._controller=e,o._myParent=r,o._isInit=!1,o._isDestroy=!1,StageUtils.getInstance().getStage().addEventListener(egret.Event.RESIZE,o.onResize,o),o}return __extends(e,t),e.prototype.setResources=function(t){this._resources=t},Object.defineProperty(e.prototype,"myParent",{get:function(){return this._myParent},enumerable:!0,configurable:!0}),e.prototype.isInit=function(){return this._isInit},e.prototype.applyFunc=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this._controller.applyFunc.apply(this._controller,arguments)},e.prototype.applyControllerFunc=function(t,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];return this._controller.applyControllerFunc.apply(this._controller,arguments)},e.prototype.isShow=function(){return null!=this.stage&&this.visible},e.prototype.addToParent=function(){this._myParent.addChild(this)},e.prototype.removeFromParent=function(){this.parent&&this.parent.removeChild(this)},e.prototype.initUI=function(){this._isInit=!0},e.prototype.initData=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.addEvent=function(){this._mIsRemoveEvent=!0
},e.prototype.removeEvent=function(){this._mIsRemoveEvent=!1},e.prototype.clearDisplay=function(t){for(var e=t.numChildren-1,r=e;r>=0;r--){var o=t.getChildAt(r);if(egret.is(o,"egret.DisplayObjectContainer"))this.clearDisplay(o);else if(egret.is(o,"eui.Image")){var n=o;n.source=void 0,n.texture=void 0,n.$bitmapData=void 0}else if(egret.is(o,"eui.Bitmap")){var n=o;n.texture=void 0,n.$bitmapData=void 0}}},e.prototype.destroy=function(){this._isDestroy||(StageUtils.getInstance().getStage().removeEventListener(egret.Event.RESIZE,this.onResize,this),this._mIsRemoveEvent&&this.removeEvent(),this.clearDisplay(this),this.removeFromParent(),this._controller=null,this._myParent=null,this._resources=null,this._isDestroy=!0)},e.prototype.onResize=function(){},e.prototype.loadResource=function(t,e){this._resources&&this._resources.length>0?ResourceUtils.getInstance().loadResource(this._resources,[],function(){t(),e()},null,this):(t(),e())},e.prototype.setVisible=function(t){this.visible=t},e}(egret.DisplayObjectContainer);__reflect(BaseSpriteView.prototype,"BaseSpriteView",["IBaseView"]);var DynamicChange=function(){function t(){this._dataCache=[],this._pUpdate=new ProxyUpdate(this._dataCache)}return Object.defineProperty(t.prototype,"pUpdate",{get:function(){return this._pUpdate},enumerable:!0,configurable:!0}),t.prototype.getCacheData=function(t){return this._dataCache[t]?this._dataCache[t]:null},t.prototype.clearCache=function(){for(var t=Object.keys(this._dataCache),e=0,r=t.length;r>e;e++){var o=t[e];this._dataCache[o]=null,delete this._dataCache[o]}},t.prototype.getCacheKeyInfos=function(){for(var t=[],e=Object.keys(this._dataCache),r=0,o=e.length;o>r;r++){var n=e[r],i=this._dataCache[n];t.push(i)}return t},t.prototype.isCache=function(t){return this._dataCache[t]},t}();__reflect(DynamicChange.prototype,"DynamicChange");var ProxyUpdate=function(){function t(t){this._cache=t}return t.prototype.isArray=function(t){return t instanceof Array},t.prototype.isObject=function(t){return t.indexOf("object")>-1},t.prototype.isNormal=function(t){var e=t.indexOf("@")>-1,r=t.indexOf(".")>-1,o=t.indexOf("_")>-1;return!e&&!r&&!o},t.prototype.isAddToArray=function(t){return"@a"==t},t.prototype.isRemoveToArray=function(t){var e=t.split("_");return e.length<=3&&"@d"==e[0]},t.prototype.isFilter=function(t){var e=t.split("_");return"@f"==e[0]},t.prototype.isNumeric=function(t){return parseFloat(t).toString()==t.toString()},t.prototype._updateObject=function(t,e,r){var o=t.split(".");"@a"==o[0]||"@s"==o[0]?r[o[1]]=e:"@d"==o[0]&&delete r[o[1]]},t.prototype._getFilterObject=function(t,e){if(e){var r=t.split("_");if(3==r.length&&"@f"==r[0]&&this.isArray(e))for(var o=r[1],n=r[2],i=0;i<e.length;i++){var s=e[i];if(3==r.length&&this.isObject(s.toString())){var a=s[o];if(a&&("@"==n[0]&&(n=n.replace("@","")),n==a))return s}}}return null},t.prototype._addObjectToArray=function(t,e){if(this.isArray(e))for(var r=0;r<e.length;r++)t.push(e[r]);else t.push(e)},t.prototype._removeObjectFromArray=function(t,e,r){var o=e.split("_");if(o.length<=3&&"@d"==o[0]&&this.isArray(t))for(var n=t.length,i=n-1;i>=0;i--){var s=t[i];if(3==o.length){if(s.hasOwnProperty(o[1])){var a=o[2];"@"==a[0]&&(a=a.replace("@","")),a==s[o[1]]&&t.splice(i,1)}}else 2==o.length&&s.hasOwnProperty(o[1])?r==s[o[1]]&&t.splice(i,1):1==o.length&&r==s&&t.splice(i,1)}},t.prototype.update=function(t,e){if(this._cache[t]=e,e.hasOwnProperty("c"))for(var r=e.c,o=Object.keys(r),n=0,i=o.length;i>n;n++){var s=o[n];this._cache[s]&&(this._update(this._cache[s],r[s]),MessageCenter.getInstance().dispatch(s+"_HttpUpdate"))}},t.prototype._update=function(t,e){if(t&&e&&this.isObject(e.toString()))for(var r=Object.keys(e),o=0,n=r.length;n>o;o++){var i=r[o],s=e[i];if(this.isNormal(i)&&this.isObject(s.toString()))t.hasOwnProperty(i)&&this._update(t[i],s);else if(this.isNormal(i)&&this.isNumeric(s)){var a=t[i];t[i]=a+s}else if(this.isNormal(i))t[i]=s;else if(this.isAddToArray(i))this._addObjectToArray(t,s);else if(this.isRemoveToArray(i))this._removeObjectFromArray(t,i,s);else if(this.isFilter(i)){var c=this._getFilterObject(i,t);c&&this._update(c,s)}else this._updateObject(i,s,t)}},t}();__reflect(ProxyUpdate.prototype,"ProxyUpdate");var Http=function(t){function e(){var e=t.call(this)||this;return e._data=new DynamicChange,e._cache=[],e._request=new egret.URLRequest,e._request.method=egret.URLRequestMethod.POST,e._urlLoader=new egret.URLLoader,e._urlLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,e.onError,e),e}return __extends(e,t),e.prototype.initServer=function(t){this._serverUrl=t},Object.defineProperty(e.prototype,"Data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.onError=function(t){this.nextPost()},e.prototype.send=function(t,e){this._cache.push([t,e]),this.post()},e.prototype.post=function(){if(!this._isRequesting&&0!=this._cache.length){var t=this._cache.shift(),e=t[0],r=t[1];this._type=e,this._request.url=this._serverUrl,this._request.data=r,this._urlLoader.addEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this),this._urlLoader.load(this._request),this._isRequesting=!0}},e.prototype.onLoaderComplete=function(t){this._urlLoader.removeEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this);var e=JSON.parse(this._urlLoader.data);e.hasOwnProperty("s")&&0!=e.s?Log.trace("Http错误:"+e.s):(this._data.pUpdate.update(this._type,e),MessageCenter.getInstance().dispatch(this._type,e)),this.nextPost()},e.prototype.nextPost=function(){this._isRequesting=!1,this.post()},e}(BaseClass);__reflect(Http.prototype,"Http");var HttpDownload=function(){function t(){}return Object.defineProperty(t,"i",{get:function(){return null==t._i&&(t._i=new t),t._i},enumerable:!0,configurable:!0}),t.prototype.download=function(t,e,r,o,n,i){Log.log("url:",t);var s=new egret.HttpRequest;s.open(t,egret.HttpMethod.GET),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i==RES.ResourceItem.TYPE_BIN&&(s.responseType=egret.HttpResponseType.ARRAY_BUFFER),s.timeout=n>0?n:3e3,s.m_callBack=e,s.m_errorCallBack=r,s.m_thisObj=o,s.m_itemType=i,s.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),s.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),s.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this),s.send()},t.prototype.onGetComplete=function(t){var e=t.currentTarget,r=e.response;if(e.m_itemType!=RES.ResourceItem.TYPE_BIN){var o=JSON.parse(e.response);r=o.data}Log.log("get onGetComplete : ",t,r),e.m_callBack.call(e.m_thisObj,r),this.clear(e)},t.prototype.onGetIOError=function(t){Log.log("get error : "+t);var e=t.currentTarget;e.m_errorCallBack.call(e.m_thisObj,t),this.clear(e)},t.prototype.onGetProgress=function(t){Log.log("get progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%")},t.prototype.clear=function(t){t.removeEventListener(egret.Event.COMPLETE,this.onGetComplete,this),t.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),t.removeEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this),t.m_callBack=void 0,t.m_errorCallBack=void 0,t.m_thisObj=void 0,t.m_itemType=void 0,delete t.m_callBack,delete t.m_errorCallBack,delete t.m_thisObj,delete t.m_itemType},t._i=null,t}();__reflect(HttpDownload.prototype,"HttpDownload");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,r,o){function n(t){e.call(o,t)}function i(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),r.call(o))}"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(o,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Socket=function(t){function e(){var e=t.call(this)||this;return e._needReconnect=!0,e._maxReconnectCount=2,e._reconnectCount=0,e._arrMsg=null,e._isLostConnect=!1,e._mIsPause=!1,e._mIsTimeOutHandle=!1,e}return __extends(e,t),e.prototype.setPause=function(t){this._mIsPause=t},e.prototype.addEvents=function(){this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},e.prototype.removeEvents=function(){this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},e.prototype.onSocketOpen=function(){this._reconnectCount=0,this._isConnecting=!0,Log.log("服务器连接成功"),this._connectFlag&&this._needReconnect||this._isLostConnect?MessageCenter.i.dispatch(SocketConst.SOCKET_RECONNECT):MessageCenter.i.dispatch(SocketConst.SOCKET_CONNECT),this._isLostConnect=!1,this._connectFlag=!0,this.deletTimeOutConnect()},e.prototype.onSocketClose=function(){this._isConnecting=!1,!this._mIsPause&&this._needReconnect?this.reconnect():(Log.warn("服务器断开连接"),MessageCenter.i.dispatch(SocketConst.SOCKET_CLOSE))},e.prototype.onSocketError=function(t){Log.warn("服务器连接错误:",t),!this._mIsPause&&this._needReconnect?this.reconnect():MessageCenter.i.dispatch(SocketConst.SOCKET_NOCONNECT),this._isConnecting=!1},e.prototype.onReceiveMessage=function(t){this._msg.receive(this._socket),this.deletTimeOut()},e.prototype.initServer=function(t,e,r){this._host=t,this._port=e,this._msg=r},e.prototype.initServerUrl=function(t,e){this.updateUrl(t)&&(this._msg=e)},e.prototype.updateUrl=function(t){return t&&"null"!=t&&"undefined"!=t?(this._url=t,!0):(Log.error("url is invalid",t),!1)},e.prototype.addProtocolNum=function(t){if(this._msg instanceof ByteArrayMsgByProtobuf){var e=this._msg;e.initProtocol(t)}},e.prototype.connect=function(){return this._socket?void egret.warn("Socket Is Going!"):DeviceUtils.getInstance().IsHtml5&&!window.WebSocket?void Log.log("不支持WebSocket"):(this._arrMsg=[],this._socket=new egret.WebSocket,this._msg instanceof ByteArrayMsg&&(this._socket.type=egret.WebSocket.TYPE_BINARY),this.addEvents(),this._url&&this._url.length>0?(this._socket.connectByUrl(this._url),Log.log("WebSocket connecting by url: "+this._url)):(this._socket.connect(this._host,this._port),Log.log("WebSocket connecting on ip-port: "+this._host+":"+this._port)),void this.setTimeOutConnect(3e3))},e.prototype.setTimeOutConnect=function(t){this._mIsTimeOutHandle||(this._mIsTimeOutHandle=!0,TimerManager.i.doTimer(t,1,this.onTimeOutConnect,this))},e.prototype.onTimeOutConnect=function(){this.deletTimeOutConnect(),this.onSocketClose()},e.prototype.deletTimeOutConnect=function(){this._mIsTimeOutHandle=!1,TimerManager.i.remove(this.onTimeOutConnect,this)},e.prototype.reconnect=function(){this._socket&&this.closeCurrentSocket(),this._reconnectCount++,this._reconnectCount<this._maxReconnectCount?(this.connect(),Log.log("重新连接Socket --- Times:",this._reconnectCount),MessageCenter.i.dispatch(SocketConst.SOCKET_START_RECONNECT,this._reconnectCount)):(this._reconnectCount=0,this._connectFlag?MessageCenter.i.dispatch(SocketConst.SOCKET_CLOSE):MessageCenter.i.dispatch(SocketConst.SOCKET_NOCONNECT))},e.prototype.send=function(t){this._msg&&this._socket&&this._isConnecting&&(this._msg.send(this._socket,t),this.setTimeOut(5e3))},e.prototype.setTimeOut=function(t){this._mIsTimeOutHandle||(this._mIsTimeOutHandle=!0,TimerManager.i.doTimer(t,1,this.onTimeOut,this))},e.prototype.onTimeOut=function(){this.deletTimeOut(),MessageCenter.i.dispatch(SocketConst.SOCKET_SEND_TIME_OUT)},e.prototype.deletTimeOut=function(){this._mIsTimeOutHandle=!1,TimerManager.i.remove(this.onTimeOut,this)},e.prototype.close=function(){this._socket&&(this._connectFlag=!1,this.closeCurrentSocket(),this._isLostConnect=!1)},e.prototype.closeAndMessage=function(){this.close(),this._isLostConnect=!0,MessageCenter.i.dispatch(SocketConst.SOCKET_CLOSE)},e.prototype.closeCurrentSocket=function(){Log.log("Socket Closed.."),TimerManager.i.removeAll(this),this.removeEvents(),this._socket.close(),this._socket=void 0,this._arrMsg=void 0,this._isConnecting=!1,this._isLostConnect=!0},e.prototype.isConnecting=function(){return this._isConnecting},e.prototype.isReconnecting=function(){return!this._isConnecting&&this._reconnectCount>0},e.prototype.debugInfo=function(t){MessageCenter.i.dispatch(SocketConst.SOCKET_DEBUG_INFO,t)},e}(BaseClass);__reflect(Socket.prototype,"Socket");var SocketConst=function(){function t(){}return t.SOCKET_CONNECT="SOCKET_CONNECT",t.SOCKET_RECONNECT="SOCKET_RECONNECT",t.SOCKET_START_RECONNECT="SOCKET_START_RECONNECT",t.SOCKET_CLOSE="SOCKET_CLOSE",t.SOCKET_DATA="SOCKET_DATA",t.SOCKET_NOCONNECT="SOCKET_NOCONNECT",t.SOCKET_DEBUG_INFO="SOCKET_DEBUG_INFO",t.SOCKET_SEND_TIME_OUT="SOCKET_SEND_TIME_OUT",t}();__reflect(SocketConst.prototype,"SocketConst");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,r){function o(o){e.call(r,o,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?o(n):RES.getResAsync(t,o,this)}else RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var UTFMsgByJson=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.decode=function(t){return JSON.parse(t)},e.prototype.encode=function(t){return JSON.stringify(t)},e}(UTFMsg);__reflect(UTFMsgByJson.prototype,"UTFMsgByJson");var BaseEuiLayer=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.percentHeight=100,e.touchEnabled=!1,e}return __extends(e,t),e}(eui.UILayer);__reflect(BaseEuiLayer.prototype,"BaseEuiLayer");var BaseScene=function(){function t(){this._layers=new Array}return t.prototype.onEnter=function(t){},t.prototype.onExit=function(){ViewManager.getInstance().closeAll(),this.removeAllLayer()},t.prototype.addLayer=function(t){StageUtils.getInstance().getStage().addChild(t),this._layers.push(t)},t.prototype.addLayerAt=function(t,e){StageUtils.getInstance().getStage().addChildAt(t,e),this._layers.push(t)},t.prototype.removeLayer=function(t){StageUtils.getInstance().getStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1)},t.prototype.layerRemoveAllChild=function(t){t.removeChildren()},t.prototype.removeAllLayer=function(){for(;this._layers.length;){var t=this._layers[0];this.layerRemoveAllChild(t),this.removeLayer(t)}},t}();__reflect(BaseScene.prototype,"BaseScene");var BaseSpriteLayer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(BaseSpriteLayer.prototype,"BaseSpriteLayer");var SceneManager=function(t){function e(){var e=t.call(this)||this;return e._scenes={},e}return __extends(e,t),e.prototype.clear=function(){var t=this._scenes[this._currScene];t&&(t.onExit(),this._currScene=void 0),this._scenes={}},e.prototype.register=function(t,e){this._scenes[t]=e},e.prototype.runScene=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(Log.info("进入场景：",t),this._currScene==t)return void Log.info("连续两次进入场景！",t);var o=this._scenes[t];if(null==o)return void Log.warn("场景",t,"不存在");var n=this._scenes[this._currScene];n&&n.onExit(),o.onEnter.apply(o,e),this._currScene=t},e.prototype.getCurrScene=function(){return this._currScene},e}(BaseClass);__reflect(SceneManager.prototype,"SceneManager");var Keyboard=function(){function t(){}return t.LEFT=37,t.RIGHT=39,t.UP=38,t.DOWN=40,t.W=87,t.A=65,t.S=83,t.D=68,t.J=74,t.K=75,t.L=76,t.U=85,t.I=73,t.O=79,t.P=80,t.SPACE=32,t}();__reflect(Keyboard.prototype,"Keyboard");var SoundBg=function(t){function e(){var e=t.call(this)||this;return e._currBg="",e}return __extends(e,t),e.prototype.stop=function(){this._currSoundChannel&&this._currSoundChannel.stop(),this._currSoundChannel=null,this._currSound=null,this._currBg=""},e.prototype.play=function(t){if(this._currBg!=t){this.stop(),this._currBg=t;var e=this.getSound(t);e&&this.playSound(e)}},e.prototype.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(),this._currSoundChannel.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.loadedPlay=function(t,e){this._currBg==t&&this.playSound(e)},e.prototype.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);__reflect(SoundBg.prototype,"SoundBg");var SoundEffects=function(t){function e(){var e=t.call(this)||this;return e._mPlayingChannels={},e._mLoadTime={},e}return __extends(e,t),e.prototype.play=function(t){var e=this.getSound(t);e?this.playSound(e,t):this._mLoadTime[t]=egret.getTimer()},e.prototype.stop=function(t){for(var r=t,o=Object.keys(this._mPlayingChannels),n=0,i=o.length;i>n;n++){var s=o[n];r?s.split("$")[0]==r&&this.deletec(s):this.deletec(s)}e._mEc>99999&&(e._mEc=0)},e.prototype.playSound=function(t,r){var o=t.play(0,1);o.volume=this._volume,o.m_name=r+"$"+e._mEc++,this._mPlayingChannels[o.m_name]=o,o.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this)},e.prototype.onSoundComplete=function(t){var e=t.currentTarget,r=e.m_name;this.deletec(r)},e.prototype.deletec=function(t){var e=this._mPlayingChannels[t];e&&(e.stop(),e.hasEventListener(egret.Event.SOUND_COMPLETE)&&e.removeEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this),delete this._mPlayingChannels[t])},e.prototype.setVolume=function(t){this._volume=t},e.prototype.loadedPlay=function(t,e){egret.getTimer()-this._mLoadTime[t]>1e4||this.playSound(e,t)},e._mEc=0,e}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects");var SoundManager=function(t){function e(){var e=t.call(this)||this;return e.bgOn=!m.LocalData.getLocalData("Game_BG_Open"),e.effectOn=!m.LocalData.getLocalData("Game_Effect_Open"),e.bgVolume=Number(m.LocalData.getLocalData("Game_BG_Volume"))||.5,e.effectVolume=Number(m.LocalData.getLocalData("Game_Effect_Volume"))||.5,e.bg=new SoundBg,e.bg.setVolume(e.bgVolume),e.effect=new SoundEffects,e.effect.setVolume(e.effectVolume),e}return __extends(e,t),e.prototype.playEffect=function(t){this.effectOn&&R.intervalTime(50,"SoundManager")&&this.effect.play(t)},e.prototype.playBg=function(t){this.currBg=t,this.bgOn&&this.bg.play(t)},e.prototype.stopAll=function(){this.stopBg(),this.stopEff()},e.prototype.stopBg=function(){this.bg.stop()},e.prototype.stopEff=function(t){this.effect.stop(t)},e.prototype.setEffectOn=function(t){this.effectOn=t,m.LocalData.saveLocalData("Game_Effect_Open",t?"":"0")},e.prototype.getEffectOn=function(){return this.effectOn},e.prototype.setBgOn=function(t){this.bgOn=t,this.bgOn?this.currBg&&this.playBg(this.currBg):this.stopBg(),m.LocalData.saveLocalData("Game_BG_Open",t?"":"0")},e.prototype.getBgOn=function(){return this.bgOn},e.prototype.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgVolume=t,this.bg.setVolume(this.bgVolume),m.LocalData.saveLocalData("Game_BG_Volume",""+t)},e.prototype.getBgVolume=function(){return this.bgVolume},e.prototype.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume),m.LocalData.saveLocalData("Game_Effect_Volume",""+t)},e.prototype.getEffectVolume=function(){return this.effectVolume},e.CLEAR_TIME=18e4,e}(BaseClass);__reflect(SoundManager.prototype,"SoundManager");var AverageUtils=function(){function t(t){void 0===t&&(t=10),this.nums=[],this.numsLen=0,this.numSum=0,this.maxNum=t}return t.prototype.push=function(t){this.numsLen>this.maxNum&&(this.numsLen--,this.numSum-=this.nums.shift()),this.nums.push(t),this.numSum+=t,this.numsLen++},t.prototype.getValue=function(){return this.numSum/this.numsLen},t.prototype.clear=function(){this.nums.splice(0),this.numsLen=0,this.numSum=0},t}();__reflect(AverageUtils.prototype,"AverageUtils");var DateUt=function(t){function e(){var e=t.call(this)||this;return e._mDate=new Date,e}return __extends(e,t),e.prototype.getFormatBySecond=function(t,e){if(void 0===e&&(e=1),0>=t)return""+t;var r="";switch(e){case 1:r=this.getFormatBySecond1(t);break;case 2:r=this.getFormatBySecond2(t);break;case 3:r=this.getFormatBySecond3(t);break;case 4:r=this.getFormatBySecond4(t);break;case 5:r=this.getFormatBySecond5(t);break;case 6:r=this.getFormatBySecond6(t)}return r},e.prototype.getFormatBySecond1=function(t){void 0===t&&(t=0);var e,r=Math.floor(t/3600);e=0==r?"00":10>r?"0"+r:""+r;var o,n,i=Math.floor((t-3600*r)/60),s=Math.floor((t-3600*r)%60);return o=0==i?"00":10>i?"0"+i:""+i,n=0==s?"00":10>s?"0"+s:""+s,e+":"+o+":"+n},e.prototype.getFormatBySecond3=function(t){void 0===t&&(t=0);var e,r,o=Math.floor(t/3600),n=Math.floor((t-3600*o)/60),i=Math.floor((t-3600*o)%60);return e=0==n?"00":10>n?"0"+n:""+n,r=0==i?"00":10>i?"0"+i:""+i,e+":"+r},e.prototype.getFormatBySecond2=function(t){var e=this._mDate;e.setTime(t);var r=e.getFullYear(),o=e.getMonth()+1,n=e.getDate(),i=e.getHours(),s=e.getMinutes(),a=e.getSeconds();return r+"-"+this.patch0(o)+"-"+this.patch0(n)+" "+this.patch0(i)+":"+this.patch0(s)+":"+this.patch0(a)},e.prototype.patch0=function(t){return t>=10?""+t:"0"+t},e.prototype.getFormatBySecond4=function(t){var e=Math.floor(t/3600);return e>0?e>24?Math.floor(e/24)+"天前":e+"小时前":Math.floor(t/60)+"分钟前"},e.prototype.getFormatBySecond5=function(t){var e=86400,r=3600,o=60,n=Math.floor(t/e),i=Math.floor(t%e/r),s=Math.floor((t-i*r)/o),a=Math.floor((t-i*r)%o),c="",u="",h="",l="";return t>0?0==n?(c="",0==i?(u="",0==s?(h="",l=0==a?"":10>a?"0"+a+"秒":""+a+"秒"):(h=""+s+"分",l=0==a?"":10>a?"0"+a+"秒":""+a+"秒",h+l)):(u=i+"小时",0==s?(h="",l=0==a?"":10>a?"0"+a+"秒":""+a+"秒"):(h=10>s?"0"+s+"分":""+s+"分",u+h))):(c=n+"天",u=0==i?"":10>i?"0"+i+"小时":""+i+"小时",c+u):""},e.prototype.getFormatBySecond6=function(t){var e=this._mDate;e.setTime(t);var r=e.getFullYear(),o=e.getMonth()+1,n=e.getDate(),i=e.getHours(),s=e.getMinutes(),a=e.getSeconds(),c=e.getMilliseconds();return r+"-"+this.patch0(o)+"-"+this.patch0(n)+" "+this.patch0(i)+":"+this.patch0(s)+":"+this.patch0(a)+"."+this.patch000(c)},e.prototype.patch000=function(t){return t>=100?""+t:t>=10?"0"+t:"00"+t},e}(BaseClass);__reflect(DateUt.prototype,"DateUt");var DebugUtils=function(t){function e(){var e=t.call(this)||this;return e._threshold=3,e._startTimes={},e}return __extends(e,t),e.prototype.isOpen=function(t){this._isOpen=t},Object.defineProperty(e.prototype,"isDebug",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),e.prototype.start=function(t){this._isOpen&&(this._startTimes[t]=egret.getTimer())},e.prototype.stop=function(t){if(!this._isOpen)return 0;if(!this._startTimes[t])return 0;var e=egret.getTimer()-this._startTimes[t];return e>this._threshold&&Log.log(t+": "+e),e},e.prototype.setThreshold=function(t){this._threshold=t},e}(BaseClass);__reflect(DebugUtils.prototype,"DebugUtils");var DeviceUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"IsHtml5",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE||egret.Capabilities.runtimeType==egret.RuntimeType.RUNTIME2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsWxGame",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WXGAME},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsMobile",{get:function(){return egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsPC",{get:function(){return!egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsQQBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MQQBrowser")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsIEBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MSIE")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsFirefoxBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Firefox")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsChromeBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Chrome")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsSafariBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Safari")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsOperaBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Opera")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isIOS",{get:function(){return"iOS"==egret.Capabilities.os},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAndroid",{get:function(){return"Android"==egret.Capabilities.os},enumerable:!0,configurable:!0}),e}(BaseClass);__reflect(DeviceUtils.prototype,"DeviceUtils");var GeometryUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.drawSector=function(t,e,r,o,n,i,s,a){t.graphics.clear(),t.graphics.beginFill(e),t.graphics.moveTo(r,o),t.graphics.lineTo(r+n,o),t.graphics.drawArc(r,o,n,i,s,a),t.graphics.lineTo(r,o),t.graphics.endFill()},e}(BaseClass);__reflect(GeometryUtils.prototype,"GeometryUtils");var m;!function(t){var e=function(){function t(){}return t.getLocalData=function(t){return egret.localStorage.getItem(t)},t.saveLocalData=function(t,e){egret.localStorage.setItem(t,e)},t.GenerateUUID=function(){var t=(new Date).getTime(),e="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=(t+13*Math.random())%13|0;return t=Math.floor(t/13),("x"==e?r:3&r|8).toString(16)});return(new md5).hex_md5(e)},t}();t.LocalData=e,__reflect(e.prototype,"m.LocalData")}(m||(m={}));var Log=function(){function t(){}return t.trace=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];t.log.apply(t,e)},t.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];DebugUtils.getInstance().isDebug&&(e[0]="["+t.time()+"]"+e[0],console.log.apply(console,e))},t.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];DebugUtils.getInstance().isDebug&&(e[0]="["+t.time()+"]"+e[0],console.info.apply(console,e))},t.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];DebugUtils.getInstance().isDebug&&(e[0]="["+t.time()+"]"+e[0],console.warn.apply(console,e))},t.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];DebugUtils.getInstance().isDebug&&(e[0]="["+t.time()+"]"+e[0],console.error.apply(console,e))},t.time=function(){return DateUt.getInstance().getFormatBySecond((new Date).getTime(),6)},t}();__reflect(Log.prototype,"Log");var md5=function(){function t(){this.hexcase=0,this.b64pad=""}return t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,r){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),r)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var r=this.rstr2binl(t);r.length>16&&(r=this.binl_md5(r,8*t.length));for(var o=Array(16),n=Array(16),i=0;16>i;i++)o[i]=909522486^r[i],n[i]=1549556828^r[i];var s=this.binl_md5(o.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(n.concat(s),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var r,o=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",i=0;i<t.length;i++)r=t.charCodeAt(i),n+=o.charAt(r>>>4&15)+o.charAt(15&r);return n},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="",n=t.length,i=0;n>i;i+=3)for(var s=t.charCodeAt(i)<<16|(n>i+1?t.charCodeAt(i+1)<<8:0)|(n>i+2?t.charCodeAt(i+2):0),a=0;4>a;a++)o+=8*i+6*a>8*t.length?this.b64pad:r.charAt(s>>>6*(3-a)&63);return o},t.prototype.rstr2any=function(t,e){var r,o,n,i,s,a=e.length,c=Array(Math.ceil(t.length/2));for(r=0;r<c.length;r++)c[r]=t.charCodeAt(2*r)<<8|t.charCodeAt(2*r+1);var u=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),h=Array(u);for(o=0;u>o;o++){for(s=Array(),i=0,r=0;r<c.length;r++)i=(i<<16)+c[r],n=Math.floor(i/a),i-=n*a,(s.length>0||n>0)&&(s[s.length]=n);h[o]=i,c=s}var l="";for(r=h.length-1;r>=0;r--)l+=e.charAt(h[r]);return l},t.prototype.str2rstr_utf8=function(t){for(var e,r,o="",n=-1;++n<t.length;)e=t.charCodeAt(n),r=n+1<t.length?t.charCodeAt(n+1):0,e>=55296&&56319>=e&&r>=56320&&57343>=r&&(e=65536+((1023&e)<<10)+(1023&r),n++),127>=e?o+=String.fromCharCode(e):2047>=e?o+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?o+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(o+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return o},t.prototype.str2rstr_utf16le=function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(255&t.charCodeAt(r),t.charCodeAt(r)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(t.charCodeAt(r)>>>8&255,255&t.charCodeAt(r));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),r=0;r<e.length;r++)e[r]=0;for(var r=0;r<8*t.length;r+=8)e[r>>5]|=(255&t.charCodeAt(r/8))<<r%32;return e},t.prototype.binl2rstr=function(t){for(var e="",r=0;r<32*t.length;r+=8)e+=String.fromCharCode(t[r>>5]>>>r%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var r=1732584193,o=-271733879,n=-1732584194,i=271733878,s=0;s<t.length;s+=16){var a=r,c=o,u=n,h=i;r=this.md5_ff(r,o,n,i,t[s+0],7,-680876936),i=this.md5_ff(i,r,o,n,t[s+1],12,-389564586),n=this.md5_ff(n,i,r,o,t[s+2],17,606105819),o=this.md5_ff(o,n,i,r,t[s+3],22,-1044525330),r=this.md5_ff(r,o,n,i,t[s+4],7,-176418897),i=this.md5_ff(i,r,o,n,t[s+5],12,1200080426),n=this.md5_ff(n,i,r,o,t[s+6],17,-1473231341),o=this.md5_ff(o,n,i,r,t[s+7],22,-45705983),r=this.md5_ff(r,o,n,i,t[s+8],7,1770035416),i=this.md5_ff(i,r,o,n,t[s+9],12,-1958414417),n=this.md5_ff(n,i,r,o,t[s+10],17,-42063),o=this.md5_ff(o,n,i,r,t[s+11],22,-1990404162),r=this.md5_ff(r,o,n,i,t[s+12],7,1804603682),i=this.md5_ff(i,r,o,n,t[s+13],12,-40341101),n=this.md5_ff(n,i,r,o,t[s+14],17,-1502002290),o=this.md5_ff(o,n,i,r,t[s+15],22,1236535329),r=this.md5_gg(r,o,n,i,t[s+1],5,-165796510),i=this.md5_gg(i,r,o,n,t[s+6],9,-1069501632),n=this.md5_gg(n,i,r,o,t[s+11],14,643717713),o=this.md5_gg(o,n,i,r,t[s+0],20,-373897302),r=this.md5_gg(r,o,n,i,t[s+5],5,-701558691),i=this.md5_gg(i,r,o,n,t[s+10],9,38016083),n=this.md5_gg(n,i,r,o,t[s+15],14,-660478335),o=this.md5_gg(o,n,i,r,t[s+4],20,-405537848),r=this.md5_gg(r,o,n,i,t[s+9],5,568446438),i=this.md5_gg(i,r,o,n,t[s+14],9,-1019803690),n=this.md5_gg(n,i,r,o,t[s+3],14,-187363961),o=this.md5_gg(o,n,i,r,t[s+8],20,1163531501),r=this.md5_gg(r,o,n,i,t[s+13],5,-1444681467),i=this.md5_gg(i,r,o,n,t[s+2],9,-51403784),n=this.md5_gg(n,i,r,o,t[s+7],14,1735328473),o=this.md5_gg(o,n,i,r,t[s+12],20,-1926607734),r=this.md5_hh(r,o,n,i,t[s+5],4,-378558),i=this.md5_hh(i,r,o,n,t[s+8],11,-2022574463),n=this.md5_hh(n,i,r,o,t[s+11],16,1839030562),o=this.md5_hh(o,n,i,r,t[s+14],23,-35309556),r=this.md5_hh(r,o,n,i,t[s+1],4,-1530992060),i=this.md5_hh(i,r,o,n,t[s+4],11,1272893353),n=this.md5_hh(n,i,r,o,t[s+7],16,-155497632),o=this.md5_hh(o,n,i,r,t[s+10],23,-1094730640),r=this.md5_hh(r,o,n,i,t[s+13],4,681279174),i=this.md5_hh(i,r,o,n,t[s+0],11,-358537222),n=this.md5_hh(n,i,r,o,t[s+3],16,-722521979),o=this.md5_hh(o,n,i,r,t[s+6],23,76029189),r=this.md5_hh(r,o,n,i,t[s+9],4,-640364487),i=this.md5_hh(i,r,o,n,t[s+12],11,-421815835),n=this.md5_hh(n,i,r,o,t[s+15],16,530742520),o=this.md5_hh(o,n,i,r,t[s+2],23,-995338651),r=this.md5_ii(r,o,n,i,t[s+0],6,-198630844),i=this.md5_ii(i,r,o,n,t[s+7],10,1126891415),n=this.md5_ii(n,i,r,o,t[s+14],15,-1416354905),o=this.md5_ii(o,n,i,r,t[s+5],21,-57434055),r=this.md5_ii(r,o,n,i,t[s+12],6,1700485571),i=this.md5_ii(i,r,o,n,t[s+3],10,-1894986606),n=this.md5_ii(n,i,r,o,t[s+10],15,-1051523),o=this.md5_ii(o,n,i,r,t[s+1],21,-2054922799),r=this.md5_ii(r,o,n,i,t[s+8],6,1873313359),i=this.md5_ii(i,r,o,n,t[s+15],10,-30611744),n=this.md5_ii(n,i,r,o,t[s+6],15,-1560198380),o=this.md5_ii(o,n,i,r,t[s+13],21,1309151649),r=this.md5_ii(r,o,n,i,t[s+4],6,-145523070),i=this.md5_ii(i,r,o,n,t[s+11],10,-1120210379),n=this.md5_ii(n,i,r,o,t[s+2],15,718787259),o=this.md5_ii(o,n,i,r,t[s+9],21,-343485551),r=this.safe_add(r,a),o=this.safe_add(o,c),n=this.safe_add(n,u),i=this.safe_add(i,h)
}return[r,o,n,i]},t.prototype.md5_cmn=function(t,e,r,o,n,i){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(o,i)),n),r)},t.prototype.md5_ff=function(t,e,r,o,n,i,s){return this.md5_cmn(e&r|~e&o,t,e,n,i,s)},t.prototype.md5_gg=function(t,e,r,o,n,i,s){return this.md5_cmn(e&o|r&~o,t,e,n,i,s)},t.prototype.md5_hh=function(t,e,r,o,n,i,s){return this.md5_cmn(e^r^o,t,e,n,i,s)},t.prototype.md5_ii=function(t,e,r,o,n,i,s){return this.md5_cmn(r^(e|~o),t,e,n,i,s)},t.prototype.safe_add=function(t,e){var r=(65535&t)+(65535&e),o=(t>>16)+(e>>16)+(r>>16);return o<<16|65535&r},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();__reflect(md5.prototype,"md5");var MessageCenter=function(t){function e(e){var r=t.call(this)||this;return r.type=0,r.dict={},r.eVec=[],r.lastRunTime=0,0==r.type&&TimerManager.getInstance().doFrame(1,0,r.run,r),r}return __extends(e,t),Object.defineProperty(e,"i",{get:function(){return e.getInstance()},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.dict={},this.eVec.splice(0)},e.prototype.addListener=function(t,e,r,o){if(void 0===o&&(o=1),!this.isExists(t,e,r)){var n=this.dict[t];n||(n=[],this.dict[t]=n),n.push([e,r,o]),n.sort(function(t,e){return t[2]-e[2]})}},e.prototype.removeListener=function(t,e,r){var o=this.dict[t];if(null!=o){var n=0,i=o.length;for(n;i>n;n++)if(o[n][0]==e&&o[n][1]==r){o.splice(n,1);break}0==o.length&&(this.dict[t]=void 0,delete this.dict[t])}},e.prototype.isExists=function(t,e,r){var o=this.dict[t];if(!o)return!1;var n=0,i=o.length;for(n;i>n;n++)if(o[n][0]==e&&o[n][1]==r)return!0;return!1},e.prototype.removeAll=function(t){for(var e=Object.keys(this.dict),r=0,o=e.length;o>r;r++){for(var n=e[r],i=this.dict[n],s=0;s<i.length;s++)i[s][1]==t&&(i.splice(s,1),s--);0==i.length&&(this.dict[n]=void 0,delete this.dict[n])}},e.prototype.dispatch=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(this.dict[t]){var o=ObjectPool.pop("MessageVo");o.type=t,o.param=e,0==this.type?this.eVec.push(o):this.dealMsg(o)}},e.prototype.run=function(){var t=egret.getTimer(),e=t-this.lastRunTime>100;if(this.lastRunTime=t,e)for(;this.eVec.length>0;)this.dealMsg(this.eVec.shift());else for(;this.eVec.length>0&&(this.dealMsg(this.eVec.shift()),!(egret.getTimer()-t>18)););},e.prototype.dealMsg=function(t){var e=this.dict[t.type];if(e){for(var r=0,o=e.length,n=null;o>r;)n=e[r],n[0].apply(n[1],t.param),e.length!=o&&(o=e.length,r--),r++;t.dispose(),ObjectPool.push(t)}},e}(BaseClass);__reflect(MessageCenter.prototype,"MessageCenter");var MessageVo=function(){function t(){}return t.prototype.dispose=function(){this.type=null,this.param=null},t}();__reflect(MessageVo.prototype,"MessageVo");var ObjectPool=function(){function t(){this._objs=new Array}return t.prototype.pushObj=function(t){this._objs.push(t)},t.prototype.popObj=function(){return this._objs.length>0?this._objs.pop():null},t.prototype.clear=function(){for(;this._objs.length>0;)this._objs.pop()},t.pop=function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];t._content[e]||(t._content[e]=[]);var n=t._content[e];if(n.length)return n.pop();var i=egret.getDefinitionByName(e),s=r.length,a=void 0;return 0==s?a=new i:1==s?a=new i(r[0]):2==s?a=new i(r[0],r[1]):3==s?a=new i(r[0],r[1],r[2]):4==s?a=new i(r[0],r[1],r[2],r[3]):5==s&&(a=new i(r[0],r[1],r[2],r[3],r[4])),a.ObjectPoolKey=e,a},t.popWithExtraKey=function(e,r){t._content[e]||(t._content[e]=[]);var o,n=t._content[e];if(n.length)for(var i=0;i<n.length;i++)if(n[i].extraKey==r){o=n[i],n.splice(i,1);break}if(!o){var s=egret.getDefinitionByName(e);o=new s(r),o.extraKey=r,o.ObjectPoolKey=e}return o},t.push=function(e){if(null==e)return!1;var r=e.ObjectPoolKey;return t._content[r]?(t._content[r].push(e),!0):!1},t.clear=function(){Log.warn("clear ObjectPool"),t._content={}},t.clearClass=function(e,r){void 0===r&&(r=null);for(var o=t._content[e];o&&o.length;){var n=o.pop();r&&n[r](),n=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,r){var o=t._content[e];if(null!=o){var n=0,i=o.length;for(n;i>n;n++)o[n][r]()}},t._content={},t}();__reflect(ObjectPool.prototype,"ObjectPool");var ProfileUtils=function(){function t(){}return t.hashCount=function(){return egret.$hashCount},t.profile=function(){return RES.profile()},t}();__reflect(ProfileUtils.prototype,"ProfileUtils");var RenderTextureManager=function(t){function e(){var e=t.call(this)||this;return e._pool=[],e._useNum=0,e.isLowerQQBrowser()?e._maxNum=18:e._maxNum=-1,e}return __extends(e,t),e.prototype.isLowerQQBrowser=function(){if(DeviceUtils.getInstance().IsQQBrowser){for(var t=["2013022","Lenovo A630t","SM-G3818","vivo X3t","GT-I9100"],e=!1,r=0,o=t.length;o>r;r++)if(-1!=navigator.userAgent.indexOf(t[r])){e=!0;break}return e}return!1},e.prototype.pop=function(){var t=this._pool.pop();return t||(-1==this._maxNum||this._useNum<this._maxNum)&&(t=new egret.RenderTexture,this._useNum++),t},e.prototype.push=function(t){for(var e=!1,r=0,o=this._pool.length;o>r;r++)if(this._pool[r]==t){e=!0;break}e||this._pool.push(t)},e}(BaseClass);__reflect(RenderTextureManager.prototype,"RenderTextureManager");var ResourceUtils=function(t){function e(){var e=t.call(this)||this;return e._groupIndex=0,e._configs=new Array,e._configs_cfg=[],e._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e.onResourceLoadComplete,e),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e.onResourceLoadProgress,e),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e.onResourceLoadError,e),e}return __extends(e,t),e.prototype.addConfig=function(t,e){this._configs.push([t,e]),this._configs_cfg.push(t)},e.prototype.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},e.prototype.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},e.prototype.getResourceInfo=function(t){return RES.getResourceInfo(t)},e.prototype.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},e.prototype.loadGroup=function(t,e,r,o){this._groups[t]=[e,r,o],RES.loadGroup(t)},e.prototype.loadGroups=function(t,e,r,o,n){RES.createGroup(t,e,!0),this.loadGroup(t,r,o,n)},e.prototype.pilfererLoadGroup=function(t,e){void 0===e&&(e=null);var r="pilferer_"+t;e||(e=[t]),RES.createGroup(r,e,!0),RES.loadGroup(r,-1)},e.prototype.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var r=this._groups[e][0],o=this._groups[e][2];null!=r&&r.apply(o,[e]),this._groups[e]=null,delete this._groups[e]}},e.prototype.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var r=this._groups[e][1],o=this._groups[e][2];null!=r&&r.call(o,t.itemsLoaded,t.itemsTotal)}},e.prototype.onResourceLoadError=function(t){Log.log(t.groupName+"资源组有资源加载失败"),this.onResourceLoadComplete(t)},e.prototype.loadResource=function(t,e,r,o,n){void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===n&&(n=null);var i=t.concat(e),s="loadGroup"+this._groupIndex++;RES.createGroup(s,i,!0),this._groups[s]=[r,o,n],RES.loadGroup(s)},e.prototype.createGroup=function(t,e){RES.createGroup(t,e,!0)},e.prototype.createResource=function(t,e,r){var o={name:t,type:e,url:r};RES.$addResourceData(o)},e.prototype.loadModuleTheme=function(t,e,r){var o=RES.getRes(t);return void 0==o||void 0==o.exmls||0==o.exmls.length?(Log.warn(t,"这个主题文件没有内容"),void e.call(r)):void EXML.$loadAll(o.exmls,function(t,o){e.call(r)})},e}(BaseClass);__reflect(ResourceUtils.prototype,"ResourceUtils");var StageUtils=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getHeight=function(){return this.getStage().stageHeight},e.prototype.getWidth=function(){return this.getStage().stageWidth},e.prototype.setTouchChildren=function(t){this.getStage().touchChildren=t},e.prototype.setMaxTouches=function(t){this.getStage().maxTouches=t},e.prototype.setFrameRate=function(t){this.getStage().frameRate=t},e.prototype.setScaleMode=function(t){this.getStage().scaleMode=t},e.prototype.setOrientationMode=function(t){this.getStage().orientation=t},e.prototype.getStage=function(){return egret.MainContext.instance.stage},e.prototype.startFullscreenAdaptation=function(t,e,r){this.designWidth=t,this.designHeight=e,this.resizeCallback=r,this.stageOnResize()},e.prototype.stageOnResize=function(){this.getStage().removeEventListener(egret.Event.RESIZE,this.stageOnResize,this);var t=this.designWidth,e=this.designHeight,r=window.innerWidth,o=window.innerHeight,n=r/o,i=t/e,s=n/i;if(n>i){var a=s,c=s;t=Math.floor(t*a),e=Math.floor(e*c)}this.resizeCallback&&this.resizeCallback(),this.getStage().addEventListener(egret.Event.RESIZE,this.stageOnResize,this)},e}(BaseClass);__reflect(StageUtils.prototype,"StageUtils");var TimerManager=function(t){function e(){var e=t.call(this)||this;return e._mTimerDatas=[],e._currTime=egret.getTimer(),e._currFrame=0,e._timeScale=1,egret.startTick(e.onEnterFrame,e),e}return __extends(e,t),Object.defineProperty(e,"i",{get:function(){return e.getInstance()},enumerable:!0,configurable:!0}),e.prototype.setTimeScale=function(t){this._timeScale=t},e.prototype.onEnterFrame=function(t){this._currFrame++,this._currTime=egret.getTimer();for(var e=this._mTimerDatas,r=e.length-1;r>=0;r--){var o=e[r];if(o.isRelese)o.clear(),this.remove2Pool(o),e.splice(r,1);else{var n=o.userFrame?this._currFrame:this._currTime;n>=o.exeTime&&(o.method.call(o.methodObj,(this._currTime-o.dealTime)*this._timeScale),o.dealTime=this._currTime,o.exeTime+=o.delay,o.repeat||(o.repeatCount>1?o.repeatCount--:(o.complateMethod&&o.complateMethod.apply(o.complateMethodObj),o.isRelese=!0)))}}return!1},e.prototype.create=function(t,e,r,o,n,i,s){if(!(0>e||0>r)&&o){var a=this.isExists(o,n);a||(a=ObjectPool.pop("TimerData"),this._mTimerDatas.push(a)),a.userFrame=t,a.repeat=0==r,a.repeatCount=r,a.delay=e,a.method=o,a.methodObj=n,a.complateMethod=i,a.complateMethodObj=s,a.exeTime=e+(t?this._currFrame:this._currTime),a.dealTime=this._currTime,a.isRelese=!1}},e.prototype.doTimer=function(t,e,r,o,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this.create(!1,t,e,r,o,n,i)},e.prototype.doFrame=function(t,e,r,o,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this.create(!0,t,e,r,o,n,i)},Object.defineProperty(e.prototype,"count",{get:function(){return this._mTimerDatas.length},enumerable:!0,configurable:!0}),e.prototype.remove2Pool=function(t){t.clear(),ObjectPool.push(t)},e.prototype.remove=function(t,e){for(var r=this._mTimerDatas.length-1;r>=0;r--){var o=this._mTimerDatas[r];if(o.method==t&&o.methodObj==e){o.isRelese=!0;break}}},e.prototype.removeAll=function(t){for(var e=this._mTimerDatas.length-1;e>=0;e--){var r=this._mTimerDatas[e];r.methodObj==t&&(r.isRelese=!0)}},e.prototype.isExists=function(t,e){for(var r=this._mTimerDatas.length-1;r>=0;r--){var o=this._mTimerDatas[r];if(o.method==t&&o.methodObj==e&&!o.isRelese)return o}return null},e}(BaseClass);__reflect(TimerManager.prototype,"TimerManager");var TimerData=function(){function t(){this.delay=0,this.repeat=!1,this.repeatCount=0,this.userFrame=!1,this.exeTime=0,this.dealTime=0,this.isRelese=!1}return t.prototype.clear=function(){this.method=void 0,this.methodObj=void 0,this.complateMethod=void 0,this.complateMethodObj=void 0,this.delay=0,this.repeat=!1,this.repeatCount=0,this.userFrame=!1,this.exeTime=0,this.dealTime=0,this.isRelese=!0},t}();__reflect(TimerData.prototype,"TimerData");