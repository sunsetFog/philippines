var __reflect=this&&this.__reflect||function(t,e,o){t.__class__=e,o?o.push(e):o=[e],t.__types__=t.__types__?o.concat(t.__types__):o},__extends=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);o.prototype=e.prototype,t.prototype=new o},cpnn;!function(t){var e=function(e){function o(){var t=e.call(this,"FkdnChartSkin")||this;return t.record=[],t.chartRecord=[],t.isOpenRoad=!1,t}return __extends(o,e),o.prototype.openChart=function(){console.log("isOpenRoad",this.isOpenRoad),this.isOpenRoad?this.closeChart():(this.applyFunc("showRoadMap"),egret.Tween.get(this.GroupChart).to({right:0},200,egret.Ease.sineInOut),this.isOpenRoad=!0)},o.prototype.closeChart=function(){egret.Tween.get(this.GroupChart).to({right:-280},200,egret.Ease.sineInOut),this.applyFunc("closeRoadMap"),this.isOpenRoad=!1},o.prototype.renderApproach=function(e){this.record=JSON.parse(JSON.stringify(e)),this.record.length>19&&this.record.splice(0,this.record.length-19);var o=3,n=-1;this.record.forEach(function(e){var i=new eui.Image;i.x=o,i.y=n,i.source=e==t.TypeConst.LOONG?RES.getRes("lhd_ui_long"):e==t.TypeConst.TIGER?RES.getRes("lhd_ui_hu"):RES.getRes("lhd_ui_she"),o+=40,this.GroupApproach.addChild(i)}.bind(this))},o.prototype.renderChart=function(t,e){if(this.chartRecord=JSON.parse(JSON.stringify(t)),this.longCount=0,this.huCount=0,this.tieCount=0,this.allCount=0,this.chartRecord.length){this.chartRecord.length>60&&this.chartRecord.splice(0,60);for(var o=0;o<this.chartRecord.length;o++){var n=this.chartRecord[o];0==n?this.longCount+=1:1==n?this.huCount+=1:this.tieCount+=1}this.allCount=this.chartRecord.length,this.CountLong.text=""+this.longCount,this.CountHu.text=""+this.huCount,this.CountTie.text=""+this.tieCount,this.CountAll.text=""+this.allCount}var i=this.ChartOther.getAskRoad(0),s=this.ChartOther.getAskRoad(1);this.renderRedAskRoad(i),this.renderBlackAskRoad(s)},o.prototype.renderRedAskRoad=function(t){this.LongAskRoad.removeChildren(),this.renderAskRoad(t,this.LongAskRoad)},o.prototype.renderBlackAskRoad=function(t){this.HuAskRoad.removeChildren(),this.renderAskRoad(t,this.HuAskRoad)},o.prototype.renderAskRoad=function(t,e){if(t.length){var o=new eui.Image;o.x=0,o.y=2,o.source=RES.getRes("lhd_ui_dyl_"+t[0]),e.addChild(o)}if(t.length>1){var o=new eui.Image;o.x=12,o.y=2,o.source=RES.getRes("lhd_ui_xl_"+t[1]),e.addChild(o)}if(t.length>2){var o=new eui.Image;o.x=24,o.y=2,o.source=RES.getRes("lhd_ui_xql_"+t[2]),e.addChild(o)}},o.prototype.addEvent=function(){this.BtnCloseChart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeChart,this),App.CommonUtils.effectButton(this.BtnOpenChart,this.openChart,this,{})},o.prototype.removeEvent=function(){this.BtnCloseChart.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeChart,this),App.CommonUtils.removeButton(this.BtnOpenChart)},o.prototype.destroy=function(){e.prototype.destroy.call(this),common.BeadFactory.i.clear(),this.record=void 0,this.chartRecord=void 0},o}(BaseEuiComponent);t.ChartView=e,__reflect(e.prototype,"cpnn.ChartView")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(t){function e(){var e=t.call(this,null)||this;return e._mSpeed=0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.initPlayedEndCallBack=function(t,e){this._mCallBack=t,this._mThisobj=e},e.prototype.updateId=function(t){this.initDBRes(t),this.armature=this.createArmature("Armature",t,e._mActionList),this.armature.addCompleteCallFunc(this.armaturePlayEnd,this)},e.prototype.setPosition=function(t,o){this.x=t,this.y=o,this.armature.play(e.Animation,1)},e.prototype.play=function(t){void 0===t&&(t=1),this._mSpeed=t,this.armature.play(e.Animation,999999,t),App.TimerManager.doFrame(1,99999,this.update,this)},e.prototype.update=function(t){this.x+=t/16*3*this._mSpeed,this.x>=App.StageUtils.getWidth()&&(this.x=0,this.armature.stop(),App.TimerManager.removeAll(this))},e.prototype.clean=function(){t.prototype.clean.call(this)},e.prototype.armaturePlayEnd=function(t){t.animationName==e.AnimationDead&&this._mCallBack&&this._mCallBack.call(this._mThisobj)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.armature.destroy(),this._mCallBack=void 0,this._mThisobj=void 0,this.armature=void 0},e.Animation="move",e.AnimationDead="dead",e._mActionList=[e.Animation,e.AnimationDead],e}(base.BaseGameObject);t.EffectBones=e,__reflect(e.prototype,"cpnn.EffectBones")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(){function t(){}return t.TableListReq=130100,t}();t.DeskConst=e,__reflect(e.prototype,"cpnn.DeskConst")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(){function t(){}return t.Desk_ListInfo="11901",t.Desk_ListInfo_Back="11902",t.DeskChartChange="11903",t.DeskStateChange="11923",t}();t.DeskProxyKeyConst=e,__reflect(e.prototype,"cpnn.DeskProxyKeyConst")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t._proxy=null,t._view=null,Log.trace("DeskController init()"),t}return __extends(o,e),o.prototype.onCreate=function(){e.prototype.onCreate.call(this),this.inits(),this.addListeners()},o.prototype.onInit=function(o){e.prototype.onInit.call(this),this.registers(),App.ViewManager.open(t.ViewConst.Base)},o.prototype.inits=function(){this._model=new t.DeskModel(this),this._proxy=new t.DeskProxy(this,this.getModel()),this._view=new t.DeskView(this)},o.prototype.registers=function(){e.prototype.registers.call(this),App.ViewManager.register(t.ViewConst.Base,this._view),this.registerFunc("onClickBackLobby",this.onBack2Lobby,this),this.registerFunc("onEnterGame",this.onEnterGame,this),this.registerFunc(t.DeskConst.TableListReq,this.tableListReq,this)},o.prototype.tableListReq=function(t){this._proxy.tableListReq(t)},o.prototype.onBack2Lobby=function(){this._proxy.sendLeaveGame()},o.prototype.onEnterGame=function(t,e,o){this.enterGameByDeskId(t,{tableType:e,tableName:o})},o.prototype.onExitGame=function(){e.prototype.onExitGame.call(this),this.goBack2Lobby()},o.prototype.addListeners=function(){this._proxy.addEvent()},o.prototype.removeListeners=function(){this._proxy.removeEvent()},Object.defineProperty(o.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),o.prototype.destroy=function(){e.prototype.destroy.call(this),this._model.destroy(),this._proxy.destroy(),this._view.destroy(),this._view=void 0,this._model=void 0,this._proxy=void 0},o}(base.DeskController);t.DeskController=e,__reflect(e.prototype,"cpnn.DeskController")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(t){function e(e){var o=t.call(this,e)||this;return o.roleName="",o.repeatMessage=0,o.roomListInfo=[],o}return __extends(e,t),e}(base.DeskModel);t.DeskModel=e,__reflect(e.prototype,"cpnn.DeskModel")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(t,o){return e.call(this,t,o)||this}return __extends(o,e),o.prototype.tableListReq=function(e){var o={req_id:e.req_id,table_id:e.table_id};this.send(t.DeskProxyKeyConst.Desk_ListInfo,o),App.EasyLoading.showOnTimeOut()},o.prototype.onTableListAck=function(t){Log.trace("桌子列表信息",t),App.MessageCenter.dispatch("onCpnnTableListAck",t),App.EasyLoading.hideLoading()},o.prototype.onTableChartChange=function(t){App.MessageCenter.dispatch("onCpnnTableChartChange",t)},o.prototype.onTableStateChange=function(t){App.MessageCenter.dispatch("onCpnnTableStateChange",t)},Object.defineProperty(o.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),o.prototype.addEvent=function(){e.prototype.addEvent.call(this),this.addListener(t.DeskProxyKeyConst.Desk_ListInfo_Back,this.onTableListAck,this),this.addListener(t.DeskProxyKeyConst.DeskChartChange,this.onTableChartChange,this),this.addListener(t.DeskProxyKeyConst.DeskStateChange,this.onTableStateChange,this)},o.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.removeListener(t.DeskProxyKeyConst.Desk_ListInfo_Back,this.onTableListAck,this),this.removeListener(t.DeskProxyKeyConst.DeskChartChange,this.onTableChartChange,this),this.removeListener(t.DeskProxyKeyConst.DeskStateChange,this.onTableStateChange,this)},o.prototype.destroy=function(){e.prototype.destroy.call(this)},o}(base.DeskProxy);t.DeskProxy=e,__reflect(e.prototype,"cpnn.DeskProxy")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(t){return e.call(this,t,LayerManager.Game_Bg,"cpnn","CpnnDeskSkin")||this}return __extends(o,e),o.prototype.initUI=function(){e.prototype.initUI.call(this);var o=new eui.VerticalLayout;this.deskList.layout=o,this.deskScroller.viewport=this.deskList,this.deskScroller.scrollPolicyV=eui.ScrollPolicy.ON,this.deskScroller.scrollPolicyH=eui.ScrollPolicy.OFF,this.deskList.itemRenderer=t.CpnnDeskItem,this.tempCollection=new eui.ArrayCollection,this.deskHelp.initComponent(),this.initBroadcast(this),this.exitBtn.visible=!App.isWebInsert},o.prototype.open=function(){e.prototype.open.call(this);var o={req_id:2,table_id:0};this.applyFunc(t.DeskConst.TableListReq,o)},o.prototype.onBackRoom=function(){this.applyFunc("onClickBackLobby")},o.prototype.onEnterGame=function(t){App.SoundManager.playEffect("click_mp3");var e=this.deskList.selectedIndex,o=this.deskList.getElementAt(e),n=this.tempCollection.getItemAt(e).tablename;this.applyFunc("onEnterGame",o.tableId,2,n)},o.prototype.createList=function(t){this.tempCollection.refresh();var e=t,o=this.initListData(e);this.tempCollection.replaceAll(o),this.deskList.dataProvider=this.tempCollection,this.tempCollection.refresh()},o.prototype.onTableChartChange=function(t){if(Log.trace("正常数据",t),0==t.infos.length||!this.tempCollection)return void Log.trace("数据有误",this.tempCollection,this);for(var e=this.tempCollection.source.length,o=0;e>o;o++)if(this.tempCollection.getItemAt(o).tableid==t.table_id){var n=t.infos[0];this.tempCollection.getItemAt(o).historyinfo.length>=4?(this.tempCollection.getItemAt(o).historyinfo.unshift(n),this.tempCollection.getItemAt(o).historyinfo.pop()):this.tempCollection.getItemAt(o).historyinfo.unshift(n),this.tempCollection.itemUpdated(this.tempCollection.getItemAt(o))}},o.prototype.onTableStateChange=function(t){var e=this.tempCollection.source.length;if(Log.trace("页签时间状态更新",t),!this.tempCollection)return void Log.trace("数据有误",this.tempCollection,this);for(var o=function(e){if(n.tempCollection.getItemAt(e)&&n.tempCollection.getItemAt(e).tableid==t.table_id){n.tempCollection.getItemAt(e).curry_issue=t.issue;var o=Math.floor(t.remaining_time/1e3);if(n.tempCollection.getItemAt(e).gametime=o,n.tempCollection.getItemAt(e).gamestatus=t.state,n.tempCollection.itemUpdated(n.tempCollection.getItemAt(e)),0==o||5==t.state)return{value:void 0};App.TimerManager.doTimer(1e3,o,function(){this.tempCollection.getItemAt(e).gametime>0&&(this.tempCollection.getItemAt(e).gametime--,this.tempCollection.itemUpdated(this.tempCollection.getItemAt(e)))}.bind(n),n)}},n=this,i=0;e>i;i++){var s=o(i);if("object"==typeof s)return s.value}},o.prototype.initListData=function(t){if(!(t.table_info_list.length<=0)){for(var e=[],o=0;o<t.table_info_list.length;o++)e[o]={tableid:t.table_info_list[o].table_id,gamestatus:t.table_info_list[o].state,total_time:Math.floor(t.table_info_list[o].total_time/1e3),gametime:Math.floor(t.table_info_list[o].remaining_time/1e3),historyinfo:t.table_info_list[o].info.reverse(),curry_issue:t.table_info_list[o].issue,tablename:t.table_info_list[o].table_name,bet_limit:t.table_info_list[o].bet_limit,bet_max:t.table_info_list[o].bet_max,sortid:t.table_info_list[o].sort_id,tableinfo:t.table_info_list[o]};return e.sort(function(t,e){return t.sortid-e.sortid!=0?t.sortid-e.sortid:void 0}),Log.trace("cpnnDeskList",e),e}},o.prototype.onClickHelp=function(){App.MouseUtils.removeMouseWheel(),this.deskHelp.showPopup()},o.prototype.onMouseWheel=function(t){common.GUtils.touchMouseWheel(this.deskScroller,this.deskList,t.data)},o.prototype.onCloseHelp=function(){App.MouseUtils.addMouseWheel(this.onMouseWheel,this)},o.prototype.addEvent=function(){e.prototype.addEvent.call(this),this.deskHelp.addEvent(),App.CommonUtils.effectButton(this.exitBtn,this.onBackRoom,this),App.CommonUtils.effectButton(this.helpBtn,this.onClickHelp,this),this.deskList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onEnterGame,this),App.MessageCenter.addListener("onCpnnTableListAck",this.createList,this),App.MessageCenter.addListener("onCpnnTableStateChange",this.onTableStateChange,this),App.MessageCenter.addListener("onCpnnTableChartChange",this.onTableChartChange,this),App.MessageCenter.addListener("closeHelpAtDesk",this.onCloseHelp,this),App.MouseUtils.addMouseWheel(this.onMouseWheel,this)},o.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.deskHelp.removeEvent(),App.CommonUtils.removeButton(this.exitBtn),App.CommonUtils.removeButton(this.helpBtn),this.deskList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onEnterGame,this),App.MessageCenter.removeListener("onCpnnTableListAck",this.createList,this),App.MessageCenter.removeListener("onCpnnTableStateChange",this.onTableStateChange,this),App.MessageCenter.removeListener("onCpnnTableChartChange",this.onTableChartChange,this),App.MessageCenter.removeListener("closeHelpAtDesk",this.onCloseHelp,this),App.MouseUtils.removeMouseWheel()},o.prototype.destroy=function(){e.prototype.destroy.call(this),this.deskHelp.destroy(),this.tempCollection&&(this.tempCollection.removeAll(),this.tempCollection=null),App.TimerManager.removeAll(this),this.deskList.removeChildren()},o}(base.DeskView);t.DeskView=e,__reflect(e.prototype,"cpnn.DeskView")}(cpnn||(cpnn={}));var cpnn;!function(t){var e;!function(e){var o=function(){function e(){}return e.prototype.getVersion=function(){return"v1.1.6"},e.prototype.reconstruction=function(t){var e=base.getController(t);e&&e.onReconstruction()},e.prototype.create=function(e){e==ControllerConst.Room||(e==ControllerConst.Game?App.ControllerManager.register(ControllerConst.Game,new t.GameController):e==ControllerConst.Desk&&App.ControllerManager.register(ControllerConst.Desk,new t.DeskController));var o=base.getController(e);o&&o.onCreate()},e.prototype.initialize=function(t,e){var o=base.getController(t);o&&o.onInit(e)},e.prototype.destroy=function(t){},e}();e.cpnn=o,__reflect(o.prototype,"cpnn.Entrance.cpnn",["base.IEntranceface"])}(e=t.Entrance||(t.Entrance={}))}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(t){function e(){var e=t.call(this,null)||this;return e._mIsInPool=!1,e._currState="",e._index=0,e}return __extends(e,t),e.create=function(){var t,o=e.fkdnBonePool;return o&&(t=o.shift()),t||(t=new e),t._mIsInPool=!1,t},e.realese=function(t){if(!t._mIsInPool){var o=e.fkdnBonePool;o||(o=[]),t._mIsInPool=!0,t.clean(),o.push(t),e.fkdnBonePool=o}},e.cleanFormPool=function(){var t=e.fkdnBonePool;if(t)for(;t.length;){var o=t.pop();o.destroy()}},e.prototype.getState=function(){return this._currState},e.prototype.setState=function(t){this._currState=t},e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.updateId=function(t){this.initDBRes(t),this.armature=this.createArmature("Armature",t,e._mActionList),this.armature.addCompleteCallFunc(this.armaturePlayEnd,this)},e.prototype.addPlayEndCallBack=function(t,e){this._mPlayEndCallBacK=t,this._mPlayEndThisObj=e},e.prototype.destroy=function(){t.prototype.destroy.call(this),this._mPlayEndCallBacK=void 0,this._mPlayEndThisObj=void 0,this.armature=void 0},e.prototype.clean=function(){t.prototype.clean.call(this),this.stopGame(),this._mPlayEndCallBacK=void 0,this._mPlayEndThisObj=void 0},e.prototype.stopGame=function(){this.armature&&this.armature.stop()},e.prototype.armaturePlayEnd=function(){this._mPlayEndCallBacK&&this._mPlayEndCallBacK.call(this._mPlayEndThisObj)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.play=function(t){this.armature.play(e.Animation,t)},e.prototype.play2=function(t){this.armature.play(e.Animation2,t)},e.fkdnBonePool=null,e.Animation="play",e.Animation2="play2",e._mActionList=[e.Animation,e.Animation2],e}(base.BaseGameObject);t.CpnnBones=e,__reflect(e.prototype,"cpnn.CpnnBones")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(t){function e(){var e=t.call(this,null)||this;return e._mIsInPool=!1,e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.create=function(){var t=ObjectPool.pop("brnn.Shuffle");return t._mIsInPool=!1,t},e.realese=function(t){t._mIsInPool||(t._mIsInPool=!0,t.clean(),ObjectPool.push(t))},e.cleanFormPool=function(){ObjectPool.clearClass("brnn.Shuffle","destroy")},e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.updateId=function(t,o){this.initDBRes(t),this.armature=this.createArmature("play",t,e._mActionList),this.armature.addCompleteCallFunc(this.armaturePlayEnd,this)},e.prototype.addPlayEndCallBack=function(t,e){this._mPlayEndCallBacK=t,this._mPlayEndThisObj=e},e.prototype.stopGame=function(){this.armature&&this.armature.stop()},e.prototype.removeArmaturePlayEnd=function(){this.armature.removeCompleteCallFunc(this.armaturePlayEnd,this)},e.prototype.armaturePlayEnd=function(){this._mPlayEndCallBacK&&this._mPlayEndCallBacK.call(this._mPlayEndThisObj)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.play=function(t){this.armature.play(e.Animation,t)},e.prototype.clean=function(){t.prototype.clean.call(this),this._mPlayEndCallBacK=void 0,this._mPlayEndThisObj=void 0},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.clean(),this._mPlayEndCallBacK=void 0,this._mPlayEndThisObj=void 0,this.armature=void 0},e.Animation="clean",e._mActionList=[e.Animation],e}(base.BaseGameObject);t.Shuffle=e,__reflect(e.prototype,"cpnn.Shuffle")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(){var t=e.call(this,"CpnnBetBoxSkin")||this;return t.coinArr=[],t.winpos=[],t.allChipList=[],t.isBetList={},t.coinBox=[],t}return __extends(o,e),o.prototype.bet=function(e){var o=e.currentTarget.name;this.applyFunc(t.CpnnCallBacks.bet,o)},o.prototype.setIsBetList=function(){for(var t=0;15>t;t++)this.isBetList["isBet_"+t]=!1},o.prototype.setTouchBtnAlpha=function(){for(var t=0;15>t;t++)this["TouchBtn_"+t].alpha=0},o.prototype.initCoinBox=function(){this.coinBox.length=0;for(var t={coinBoxObj0:{_coinType:"",_coinNum:0,_currentY:0},coinBoxObj1:{_coinType:"",_coinNum:0,_currentY:0},coinBoxObj2:{_coinType:"",_coinNum:0,_currentY:0}},e={coinBoxObj0:{_coinType:"",_coinNum:0,_currentY:0},coinBoxObj1:{_coinType:"",_coinNum:0,_currentY:0},coinBoxObj2:{_coinType:"",_coinNum:0,_currentY:0}},o={coinBoxObj0:{_coinType:"",_coinNum:0,_currentY:0},coinBoxObj1:{_coinType:"",_coinNum:0,_currentY:0},coinBoxObj2:{_coinType:"",_coinNum:0,_currentY:0}},n=0;15>n;n++){var i={coinBoxObj0:{_coinType:"",_coinNum:0,_currentY:0}};this.coinBox.push(i)}this.coinBox[0]=t,this.coinBox[5]=e,this.coinBox[10]=o},o.prototype.showBetMoney=function(t){for(var e=0;e<t.length;e++)if(t[e]){var o=Math.floor(App.CommonUtils.money(t[e]));o&&(this["TotalBet_"+e].text=""+o,this.isBetList["isBet_"+e]=!0,this.showCoin(e,o))}else this["TotalBet_"+e].text=""},o.prototype.showCoin=function(t,e){var o=this.getNumObj(e),n=Object.keys(o),i=this["BetBox"+t].$children[0],s=this["BetBox"+t].$children[1],r=this["BetBox"+t].$children[2];this.renderCoinType(n[0],o[n[0]],this.coinBox[t].coinBoxObj0,i),this["BetBox"+t].$children.length>1&&(n.length>1?this.renderCoinType(n[1],o[n[1]],this.coinBox[t].coinBoxObj1,s):(s.removeChildren(),this.coinBox[t].coinBoxObj1._coinType="",this.coinBox[t].coinBoxObj1._coinNum=0,this.coinBox[t].coinBoxObj1._currentY=0),n.length>2?this.renderCoinType(n[2],o[n[2]],this.coinBox[t].coinBoxObj2,r):(r.removeChildren(),this.coinBox[t].coinBoxObj2._coinType="",this.coinBox[t].coinBoxObj2._coinNum=0,this.coinBox[t].coinBoxObj2._currentY=0))},o.prototype.renderCoinType=function(t,e,o,n){t==o._coinType?e>o._coinNum?this.addCoin(n,t,e-o._coinNum,o):e<o._coinNum&&(n.removeChildren(),o._currentY=0,this.addCoin(n,t,e,o)):(n.removeChildren(),o._currentY=0,this.addCoin(n,t,e,o)),o._coinType=t,o._coinNum=e},o.prototype.addCoin=function(e,o,n,i){var s,r="";switch(o){case"sw":r="common_ui_10_png",s=1e5;break;case"w":r="common_ui_4_png",s=1e4;break;case"q":r="common_ui_8_png",s=1e3;break;case"b":r="common_ui_5_png",s=100;break;case"s":r="common_ui_2_png",s=10;break;case"g":r="common_ui_0_png",s=1}for(var a=0,l=-100,h=0,p=[],c=0;n>c;c++){var u=common.CoinFactory.i.createCoin();u.refresh(r,s,a,l),u.alpha=0,p.push(u),e.addChild(u)}for(var d,m=function(){0==i._currentY?h=0:y.randomNum()>.65?(d=y.randomNum(),h=d>.5?2.5:-2.5):h=0;var e=y;egret.Tween.get(p[C]).wait(150*C).to({y:i._currentY,x:h},150).call(function(){App.SoundManager.playEffect(t.SoundConst.BET)},y),function(t){App.TimerManager.doTimer(150*t,1,function(){p[t].alpha=1},e)}(C),i._currentY-=5},y=this,C=0;C<p.length;C++)m()},o.prototype.randomNum=function(){return Math.random()},o.prototype.getNumObj=function(t){var e=String(t).split(""),o={sw:0,w:0,q:0,b:0,s:0,g:0};switch(e.length){case 1:o.g=Number(e[0]);break;case 2:o.s=Number(e[0]),o.g=Number(e[1]);break;case 3:o.b=Number(e[0]),o.s=Number(e[1]),o.g=Number(e[2]);break;case 4:o.q=Number(e[0]),o.b=Number(e[1]),o.s=Number(e[2]),o.g=Number(e[3]);break;case 5:o.w=Number(e[0]),o.q=Number(e[1]),o.b=Number(e[2]),o.s=Number(e[3]),o.g=Number(e[4]);break;case 6:o.sw=Number(e[0]),o.w=Number(e[1]),o.q=Number(e[2]),o.b=Number(e[3]),o.s=Number(e[4]),o.g=Number(e[5])}for(var n in o)0==o[n]&&delete o[n];return o},o.prototype.showSelfBet=function(t){for(var e=0;e<t.length;e++){var o=Math.floor(App.CommonUtils.money(t[e]));o?this["MyBet_"+e].text=""+o:this["MyBet_"+e].text=""}},o.prototype.showMyPreBet=function(t){for(var e=0;e<t.length;e++){var o=Math.floor(App.CommonUtils.money(t[e]));o?this["MyPreBet_"+e].text=""+o:this["MyPreBet_"+e].text=""}},o.prototype.coinFlicker=function(t){var e=t;console.log("筹码柱闪烁1",e);for(var o=0;o<e.length;o++)for(var n=e[o],i=this["BetBox"+n],s=0;s<i.numChildren;s++){var r=i.getChildAt(s);console.log("筹码柱闪烁2",r),egret.Tween.get(r).to({alpha:0},150)}},o.prototype.coinStopFlicker=function(t){for(var e=t,o=0;o<e.length;o++)for(var n=e[o],i=this["BetBox"+n],s=0;s<i.numChildren;s++){var r=i.getChildAt(s);r.alpha=1}},o.prototype.createHeadPosition=function(){for(var t=0;t<this.GroupHeadPos.numChildren;t++){var e=void 0,o=void 0;switch(t){case 0:e=this.HeadPos0.left,o=App.StageUtils.getHeight()/2+this.HeadPos0.verticalCenter;break;case 1:e=this.HeadPos1.left,o=App.StageUtils.getHeight()/2+this.HeadPos1.verticalCenter;break;case 2:e=App.StageUtils.getWidth()-this.HeadPos2.right,o=App.StageUtils.getHeight()/2+this.HeadPos2.verticalCenter;break;case 3:e=App.StageUtils.getWidth()-this.HeadPos3.right,o=App.StageUtils.getHeight()/2+this.HeadPos3.verticalCenter;break;case 4:e=this.HeadPos4.left,o=App.StageUtils.getHeight()-(this.HeadPos4.bottom+this.HeadPos4.height);break;case 5:e=this.HeadPos5.left,o=App.StageUtils.getHeight()-(this.HeadPos5.bottom+this.HeadPos5.height)}var n=this.GroupHeadPos.localToGlobal(e,o);this.winpos.push(n)}},o.prototype.betToPlaceAni=function(t,e,o){base.GameCoinMgr.i.flyToPlace(t,this["BetPoint_"+e],o,this.winpos,this.GroupChip)},o.prototype.cleanChip=function(){base.GameCoinMgr.i.clean()},o.prototype.createWinChip=function(t,e){if(console.log("生成赢钱筹码",t,e),this.isBetList["isBet_"+t])for(var o=this["BetBox"+t],n=this["ChipPos"+t],i=this.winpos[e],s=this.GroupChip.globalToLocal(i.x,i.y),r=0;5>r;r++){var a=App.MathUtils.random(0,o.width),l=App.MathUtils.random(0,o.height),h=common.chipBtn.create();h.init(r),h.setNameNum(e);var p=Math.floor(n.x+a),c=Math.floor(n.y+l),u=Math.floor(s.x),d=Math.floor(s.y);this.GroupChip.addChild(h),h.x=o.x+o.width/2,h.y=o.y+o.height/2,h.scaleX=.5,h.scaleY=.5,h.alpha=0,h.setScore(),h.setFlyX(p),h.setFlyY(c),h.setFlyChipX(u),h.setFlyChipY(d),this.allChipList.push(h)}},o.prototype.flyWinChip=function(){var e=this.allChipList;if(e&&e.length){for(var o=0;o<e.length;o++){var n=e[o];n.moveTo()}App.SoundManager.playEffect(t.SoundConst.WIN_BET)}},o.prototype.clearFlyWinChip=function(){for(;this.allChipList&&this.allChipList.length;){var t=this.allChipList.pop();common.chipBtn.release(t)}},o.prototype.clearCoin=function(){for(var t=0;15>t;t++)for(var e=this["BetBox"+t],o=0;o<e.numChildren;o++){var n=e.getChildAt(o);this.removeCoins(n)}},o.prototype.clearNum=function(){for(var t=0;15>t;t++)this.isBetList["isBet_"+t]=!1,this["TotalBet_"+t].text="",this["MyBet_"+t].text="";this.clearPreMoney()},o.prototype.clearPreMoney=function(){for(var t=0;15>t;t++)this["MyPreBet_"+t].text=""},o.prototype.coinAniClear=function(t){var e=this;t.length&&(this.coinFlicker(t),R.setTimeOnce(function(){e.coinStopFlicker(t)},this,200)),R.setTimeOnce(function(){e.clearCoin(),e.flyWinChip()},this,350)},o.prototype.removeCoins=function(t){for(;t.numChildren;){var e=t.removeChildAt(0);common.CoinFactory.i.releaseCoin(e)}},o.prototype.getStarEndPoint=function(t){var e;return e=this["StarPos_"+t].parent.localToGlobal(this["StarPos_"+t].x,this["StarPos_"+t].y)},o.prototype.getParabolicPoint=function(t){var e;return e=this["Parabolic_"+t].parent.localToGlobal(this["Parabolic_"+t].x,this["Parabolic_"+t].y)},o.prototype.showStar=function(t){this["StarPos_"+t].visible=!0},o.prototype.hideStar=function(){for(var t=0;15>t;t++)this["StarPos_"+t].visible=!1},o.prototype.hideTableLight=function(){for(var t=0;15>t;t++)this["highLight_"+t].alpha=0},o.prototype.showTableLight=function(t){for(var e=t,o=0;o<e.length;o++){var n=e[o],i=this["highLight_"+n];egret.Tween.get(i).wait(0).to({alpha:1},0),egret.Tween.get(i).wait(100).to({alpha:.7},400),egret.Tween.get(i).wait(550).to({alpha:1},0),egret.Tween.get(i).wait(650).to({alpha:.7},400),egret.Tween.get(i).wait(1050).to({alpha:1},0)}},o.prototype.directTableLight=function(t){for(var e=t,o=0;o<e.length;o++){var n=e[o],i=this["highLight_"+n];i.alpha=1}},o.prototype.stopRegion=function(){for(var t=0;15>t;t++)this["TouchBtn_"+t].touchEnabled=!1},o.prototype.startRegion=function(){for(var t=0;15>t;t++)this["TouchBtn_"+t].touchEnabled=!0},o.prototype.addEvent=function(){for(var t=0;15>t;t++)this["TouchBtn_"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.bet,this)},o.prototype.removeEvent=function(){for(var t=0;15>t;t++)this["TouchBtn_"+t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bet,this)},o.prototype.destroy=function(){e.prototype.destroy.call(this),this.clearFlyWinChip(),this.cleanChip(),R.removeAllTimeOut(this),common.chipBtn.cleanchipBtnPool(),common.CoinFactory.i.clear(),this.allChipList=void 0,this.coinArr=void 0,this.winpos=void 0},o}(BaseEuiComponent);t.BetBox=e,__reflect(e.prototype,"cpnn.BetBox")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(){var t=e.call(this,"CpnnCardSkin")||this;return t.blackList=[],t.redList=[],t.cardList=[],t.blackPos=[],t.redPos=[],t.posList=[],t.WAIT_CARD_TIME=200,t.pokerAllList=[],t}return __extends(o,e),o.prototype.open=function(){this.clearWinner(),this.cleanwinAndlose()},o.prototype.clearWinner=function(){this.HuWin.visible=!1,this.LongWin.visible=!1,this.He.visible=!1},o.prototype.createNewCard=function(){var t=this.GroupDeal.getChildAt(0),e=this.GroupDeal.localToGlobal(t.x,t.y);this.redPoint=this.GroupLong.globalToLocal(e.x,e.y),this.blackPoint=this.GroupHu.globalToLocal(e.x,e.y);for(var o=0;10>o;o++){var n=new eui.Image;n.source="common_ui_cardback_png",n.scaleX=.5,n.scaleY=.5,n.x=t.x,n.y=t.y,n.name=o+"",n.alpha=0,5>o?(n.x=this.redPoint.x,n.y=this.redPoint.y,this.GroupLong.addChild(n),this.redList.push(n)):(n.x=this.blackPoint.x,n.y=this.blackPoint.y,this.GroupHu.addChild(n),this.blackList.push(n)),this.cardList.push(n)}},o.prototype.dealCard=function(e){this.revealTripCard(),t.CpnnUtil.dealCard(this.cardList,this.posList,this.WAIT_CARD_TIME,1),App.TimerManager.doTimer(this.WAIT_CARD_TIME/2,1,this.dealRed,this),R.setTimeOnce(function(){this.applyFunc(t.CpnnCallBacks.onShowTimerCallBack)},this,1500)},o.prototype.dealRed=function(){t.CpnnUtil.dealCard(this.cardList,this.posList,this.WAIT_CARD_TIME,2)},o.prototype.setCardPos=function(){var e=t.CpnnUtil.getPoints(this.GroupLong),o=t.CpnnUtil.getPoints(this.GroupHu);this.posList=e.concat(o),this.createNewCard()},o.prototype.revealTripCard=function(){for(var t=this.cardList,e=0;e<t.length;e++){var o=t[e];o.alpha=1}},o.prototype.directFapai=function(){this.initializationcardPos();for(var t=this.cardList,e=0;e<t.length;e++){var o=t[e],n=this.posList[e];o.x=n.x,o.y=n.y,o.scaleX=1,o.scaleY=1,o.source="common_ui_cardback_png",o.alpha=1,o.rotation=0}},o.prototype.initializationcardPos=function(){var t=this.cardList;if(t.length)for(var e=0;e<t.length;e++){var o=t[e],n=o.name<5?this.redPoint:this.blackPoint;o.x=n.x,o.y=n.y,o.scaleX=.5,o.scaleY=.5,o.source="common_ui_cardback_png",o.alpha=0,o.rotation=0}},o.prototype.clearCard=function(){App.TimerManager.removeAll(this);var t=this.cardList;if(t.length)for(var e=0;e<t.length;e++){var o=t[e];o.parent&&(egret.Tween.removeTweens(o),o.parent.removeChild(o))}this.cardList=[],this.posList=[],this.redPoint=void 0,this.blackPoint=void 0},o.prototype.getcardsrc=function(t){this.pokerAllList=[],this.pokerAllList.length=0;for(var e=0;e<t.length;e++){var o=t[e];this.pokerAllList.push(this.getCardWithNum(o))}},o.prototype.getCardWithNum=function(t){var e=t>>4&15,o=15&t,n=11==o?"j":12==o?"q":13==o?"k":o;if(console.log("hua:",e,"number:",n,"cardNum:",t),0==e)var i="black";else if(1==e)var i="heart";else if(2==e)var i="flower";else if(3==e)var i="square";var s="common_ui_card"+i+n+"_png";return 0==e&&0==n&&(s="",Log.warn("cardNum:",t)),console.log("cardStr:",s),s},o.prototype.kaipaiAnimation=function(e){var o=0;this.initializationcardPos(),this.directFapai();for(var n=function(){var t=i.cardList[s];egret.Tween.removeTweens(t),egret.Tween.get(t).wait(100*o).to({scaleX:0},300,egret.Ease.sineInOut).call(function(){t.source=this.pokerAllList[t.name],egret.Tween.get(t).to({scaleX:1},300,egret.Ease.sineInOut)},i),o++},i=this,s=0;s<this.cardList.length;s++)n();this.showCowType(e),R.setTimeOnce(function(){this.applyFunc(t.CpnnCallBacks.onRunWinnerCallBack)}.bind(this),this,2e3),this.setCardTypePos(e)},o.prototype.directKaipai=function(t){this.initializationcardPos(),this.directFapai();for(var e=0;e<this.cardList.length;e++)this.cardList[e].source=this.pokerAllList[e];this.directSetCardTypePos(t),this.directCowType(t)},o.prototype.setCardTypePos=function(t){var e=0,o=this,n=0;App.TimerManager.doTimer(580,2,function(){n=0==e?t.redcow_open_type:t.blackcow_open_type,o.setCardsPos(e,n,!0),e++},this)},o.prototype.setCardsPos=function(t,e,o){console.log(t,e,o);var n=5*t,i=5*t+5;if(e)for(var s=n;i>s;s++){var r=this.cardList[s];o?egret.Tween.get(r).to({x:this.posList[s].x,y:this.posList[s]._y,alpha:1},300,egret.Ease.sineInOut):r.y=this.posList[s]._y}},o.prototype.directSetCardTypePos=function(t){for(var e=0;2>e;e++){var o=0;o=0==e?t.redcow_open_type:t.blackcow_open_type,this.setCardsPos(e,o,!1)}},o.prototype.setCowTypeNum=function(t,e,o){},o.prototype.showCowType=function(t){var e=0,o=this,n=this.findRedAndBlackIsWin(t.place_results);App.TimerManager.doTimer(600,2,function(){var i=0;0==e?(i=t.redcow_open_type,o.setCowTypeNum(i,e,n[e])):(i=t.blackcow_open_type,o.setCowTypeNum(i,e,n[e])),e++},this,function(){},this)},o.prototype.directCowType=function(t){for(var e=this.findRedAndBlackIsWin(t.place_results),o=0;2>o;o++){var n=0;0==o?(n=t.redcow_open_type,this.setCowTypeNum(n,o,e[o])):(n=t.blackcow_open_type,this.setCowTypeNum(n,o,e[o]))}},o.prototype.cleanwinAndlose=function(){App.TimerManager.removeAll(this),egret.Tween.removeTweens(this);for(var t=0;2>t;t++)this["Lottery"+t].visible=!1,this["beefCard"+t].source=""},o.prototype.findRedAndBlackIsWin=function(t){for(var e=t,o=[],n=0;n<e.length;n++){var i=e[n];(0==i.place||1==i.place)&&o.push(i.is_win)}return o},o.prototype.cleanOpenAndTurnPoker=function(){var t=this.cardList;App.TimerManager.removeAll(this);for(var e=0;e<t.length;e++){var o=t[e];egret.Tween.removeTweens(o)}},o.prototype.runWinner=function(t,e){this.showWinner(t),e&&(this.GroupWin.scaleX=this.GroupWin.scaleY=4,egret.Tween.get(this.GroupWin).to({scaleX:1,scaleY:1},150,egret.Ease.sineInOut))
},o.prototype.showWinner=function(e){switch(e){case t.TypeConst.LOONG:this.LongWin.visible=!0,this.HuWin.visible=!1,this.He.visible=!1;break;case t.TypeConst.TIGER:this.LongWin.visible=!1,this.HuWin.visible=!0,this.He.visible=!1;break;case t.TypeConst.TIE:this.LongWin.visible=!1,this.HuWin.visible=!1,this.He.visible=!0}},o.prototype.addEvent=function(){},o.prototype.removeEvent=function(){},o.prototype.destroy=function(){e.prototype.destroy.call(this),this.clearCard(),this.cleanwinAndlose()},o}(BaseEuiComponent);t.CardView=e,__reflect(e.prototype,"cpnn.CardView")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(t){var o=e.call(this,"CpnnChangeTableSkin")||this;return o.visible=!1,o}return __extends(o,e),o.prototype.initComponent=function(o){e.prototype.initComponent.call(this,o),this.tempCollection=new eui.ArrayCollection,this.deskList.itemRenderer=t.CpnnDeskItem,this.scrollerItem.viewport.scrollH=0,this.scrollerItem.viewport=this.deskList},o.prototype.addEvent=function(){this.close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePopup,this),this.deskList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onEnterGame,this),this.ScrollBox.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this),this.ScrollBox.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchMove,this),this.ScrollBox.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this),this.ScrollBox.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchEnd,this)},o.prototype.removeEvent=function(){this.close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closePopup,this),this.deskList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onEnterGame,this),this.ScrollBox.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this),this.ScrollBox.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchMove,this),this.ScrollBox.removeEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this),this.ScrollBox.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchEnd,this)},o.prototype.touchMove=function(t){this.ScrollBox.width=1e3,this.ScrollBox.x=0,common.GUtils.touchScrollMove(this.scrollerItem,t,100)},o.prototype.touchEnd=function(){this.ScrollBox.width=50,this.ScrollBox.x=850},o.prototype.onEnterGame=function(e){var o=this.deskList.selectedIndex,n=this.deskList.getElementAt(o),i={table_id_old:GameModuleMgr.i.getCurrDeskId(),table_id_new:n.tableId,table_name:n.tableName};this.applyFunc(t.CpnnCallBacks.changeTable,i)},o.prototype.onMouseWheel=function(t){common.GUtils.touchMouseWheel(this.scrollerItem,this.deskList,t.data)},o.prototype.showPopup=function(){this.visible=!0,this.changeBg.visible=!0,this.changeMenu.scaleX=this.changeMenu.scaleY=0,App.EffectUtils.showUI(this.changeMenu),App.MouseUtils.addMouseWheel(this.onMouseWheel,this)},o.prototype.closePopup=function(){this.changeBg.visible=!1,App.SoundManager.playEffect("click_mp3");var e=this;App.EffectUtils.hideUI(this.changeMenu,300,0,function(){e.visible=!1}),App.TimerManager.removeAll(this),this.applyFunc(t.CpnnCallBacks.onChangeTableMenu,!1),App.MouseUtils.removeMouseWheel()},o.prototype.createList=function(t,e){Log.trace("gaming createList",t),this.tempCollection.refresh();var o=t,n=[],i=[],s=this.initListData(o);s.forEach(function(t){e&&e==t.tableid?t.isCurrentTable=!0:t.isCurrentTable=!1,1==t.tabletype?n.push(t):i.push(t)}),n.sort(function(t,e){return t.sortid-e.sortid}),s=n.concat(i),this.tempCollection.replaceAll(s),this.deskList.dataProvider=this.tempCollection,this.tempCollection.refresh()},o.prototype.initListData=function(t){if(!(t.table_info_list.length<=0)){for(var e=[],o=0;o<t.table_info_list.length;o++)e[o]={tableid:t.table_info_list[o].table_id,gamestatus:t.table_info_list[o].state,total_time:Math.floor(t.table_info_list[o].total_time/1e3),gametime:Math.floor(t.table_info_list[o].remaining_time/1e3),historyinfo:t.table_info_list[o].info.reverse(),curry_issue:t.table_info_list[o].issue,tablename:t.table_info_list[o].table_name,bet_limit:t.table_info_list[o].bet_limit,bet_max:t.table_info_list[o].bet_max,sortid:t.table_info_list[o].sort_id,tableinfo:t.table_info_list[o]};return e}},o.prototype.onTableChartChange=function(t){if(Log.trace("正常数据",t),0==t.infos.length||!this.tempCollection)return void Log.trace("数据有误",this.tempCollection,this);for(var e=this.tempCollection.source.length,o=0;e>o;o++)if(this.tempCollection.getItemAt(o).tableid==t.table_id){var n=t.infos[0];this.tempCollection.getItemAt(o).historyinfo.length>=4?(this.tempCollection.getItemAt(o).historyinfo.unshift(n),this.tempCollection.getItemAt(o).historyinfo.pop()):this.tempCollection.getItemAt(o).historyinfo.unshift(n),this.tempCollection.itemUpdated(this.tempCollection.getItemAt(o))}},o.prototype.onTableStateChange=function(t){var e=this.tempCollection.source.length;if(Log.trace("页签时间状态更新",t),!this.tempCollection)return void Log.trace("数据有误",this.tempCollection,this);for(var o=function(e){if(n.tempCollection.getItemAt(e)&&n.tempCollection.getItemAt(e).tableid==t.table_id){n.tempCollection.getItemAt(e).curry_issue=t.issue;var o=Math.floor(t.remaining_time/1e3);if(n.tempCollection.getItemAt(e).gametime=o,n.tempCollection.getItemAt(e).gamestatus=t.state,n.tempCollection.itemUpdated(n.tempCollection.getItemAt(e)),0==o||5==t.state)return{value:void 0};App.TimerManager.doTimer(1e3,o,function(){this.tempCollection.getItemAt(e).gametime>0&&(this.tempCollection.getItemAt(e).gametime--,this.tempCollection.itemUpdated(this.tempCollection.getItemAt(e)))}.bind(n),n)}},n=this,i=0;e>i;i++){var s=o(i);if("object"==typeof s)return s.value}},o.prototype.destroy=function(){e.prototype.destroy.call(this),this.tempCollection&&(this.tempCollection.removeAll(),this.tempCollection=null),App.TimerManager.removeAll(this)},o}(BaseEuiComponent);t.ChangeTable=e,__reflect(e.prototype,"cpnn.ChangeTable")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(){function t(){this.initChips()}return Object.defineProperty(t,"i",{get:function(){return null==t._i&&(t._i=new t),t._i},enumerable:!0,configurable:!0}),t.prototype.initChips=function(){this._chips="[0, 2, 5, 8, 9]"},t.prototype.setChips=function(t){this._chips=t},Object.defineProperty(t.prototype,"Chips",{get:function(){return this._chips},enumerable:!0,configurable:!0}),t._i=null,t}();t.CpnnChips=e,__reflect(e.prototype,"cpnn.CpnnChips")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.lastTableId=-1,eui.Watcher.watch(e,["data","tableinfo"],e.onLoadedData,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.destroy,e),e}return __extends(e,t),e.prototype.onLoadedData=function(){JSON.stringify(this.tempTableInfo)!=JSON.stringify(this.data.tableinfo)&&(this._tableName.text=this.data.tablename,this._date.text="期号:"+this.data.curry_issue,this._limited.text="限红:"+this.data.bet_limit/1e4+"~"+this.data.bet_max/1e4),this.tempTableInfo=this.data.tableinfo},e.prototype.updataRoadMap=function(){Log.trace("更新历史记录",this.data.historyinfo);for(var t=this.data.historyinfo.length,e=0;t>e;e++){var o=this.roadMapMain.getChildAt(e),n=o.getChildAt(0),i=o.getChildAt(1);n.text=this.data.historyinfo[e].issue,i.text=App.DateUtils.getFormatBySecond(1e3*this.data.historyinfo[e].open_time,2).slice(10);for(var s=JSON.parse("["+this.data.historyinfo[e].code+"]"),r=0;r<s.length;r++){var a=o.getChildAt(2+r);a.source="cpnn_ui_qiu"+s[r]}}},e.prototype.updataStatus=function(){var t;2==this.data.gamestatus?(t="投注中  "+this.data.gametime,this.MaskBetTimer.visible=!0,this.data.gametime>=this.data.total_time&&(this.data.total_time=this.data.gametime),this.mask_progress.scaleX=this.data.gametime/this.data.total_time):5==this.data.gamestatus&&1==this.data.tabletype&&(t="结算中...",this.MaskBetTimer.visible=!1),this._gameStatus.text=t},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&(this.data.isCurrentTable?(this.EnterGame.visible=!1,this.CurrentRoom.visible=!0):(this.EnterGame.visible=!0,this.CurrentRoom.visible=!1),this.updataStatus(),this._date.text="期号:"+this.data.curry_issue,JSON.stringify(this.tempRoadInfo)!=JSON.stringify(this.data.historyinfo[0])&&(Log.trace("121212",this.tempRoadInfo),this.updataRoadMap()),this.tempRoadInfo=this.data.historyinfo[0])},Object.defineProperty(e.prototype,"tableId",{get:function(){return this.data?this.data.tableid:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableType",{get:function(){return this.data.tabletype},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableName",{get:function(){return this.data.tablename},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.destroy,this)},e}(eui.ItemRenderer);t.CpnnDeskItem=e,__reflect(e.prototype,"cpnn.CpnnDeskItem")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e}(eui.ItemRenderer);t.CpnnHelpItem=e,__reflect(e.prototype,"cpnn.CpnnHelpItem")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(t){var o=e.call(this,"CpnnLotteryRecord")||this;return o.isCreateEnd=!1,o.visible=!1,o}return __extends(o,e),o.prototype.initUI=function(){var e=new eui.VerticalLayout;this.gameList.layout=e,this.scrollerItem.viewport=this.gameList,this.scrollerItem.scrollPolicyV=eui.ScrollPolicy.ON,this.scrollerItem.scrollPolicyH=eui.ScrollPolicy.OFF,this.gameList.itemRenderer=t.CpnnLotteryRecordItem,this.tempCollection=new eui.ArrayCollection},o.prototype.showPopup=function(){this.visible=!0,this.Bg.visible=!0,this.Menu.scaleX=this.Menu.scaleY=0,App.EffectUtils.showUI(this.Menu,300,0,1,function(){App.MouseUtils.addMouseWheel(this.onMouseWheel,this)}.bind(this))},o.prototype.closePoput=function(){this.Bg.visible=!1,App.SoundManager.playEffect("click_mp3");var t=this;App.EffectUtils.hideUI(this.Menu,300,0,function(){t.visible=!1}),App.MouseUtils.removeMouseWheel()},o.prototype.onMouseWheel=function(t){common.GUtils.touchMouseWheel(this.scrollerItem,this.gameList,t.data)},o.prototype.refreshData=function(t){Log.trace("历史开奖",t),t.length&&(this.isCreateEnd=!1,this.tempCollection.refresh(),this.tempCollection.replaceAll(t),this.gameList.dataProvider=this.tempCollection,this.tempCollection.refresh())},o.prototype.touchMove=function(t){this.scrollerItem.stopAnimation(),this.ScrollBox.width=786,this.ScrollBox.x=0;var e=this.scrollerItem.viewport;t.localY<24?e.scrollV=0:t.localY>e.height-24?e.scrollV=this.gameList.contentHeight-e.height:e.scrollV=(this.gameList.contentHeight-e.height)/(e.height-48)*(t.localY-24)},o.prototype.touchEnd=function(){this.ScrollBox.width=34,this.ScrollBox.x=649},o.prototype.LotteryRecordCreated=function(){this.isCreateEnd||(this.isCreateEnd=!0,this.gameList.contentHeight<this.scrollerItem.viewport.height?(this.scrollerItem.verticalScrollBar.visible=!1,this.ScrollBg.visible=!1,this.ScrollBox.touchEnabled=!1):(this.scrollerItem.verticalScrollBar.visible=!0,this.ScrollBg.visible=!0,this.ScrollBox.touchEnabled=!0))},o.prototype.addEvent=function(){e.prototype.addEvent.call(this),this.Close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePoput,this),this.ScrollBox.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this),this.ScrollBox.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchMove,this),this.ScrollBox.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this),this.ScrollBox.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchEnd,this)},o.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.Close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closePoput,this),this.ScrollBox.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMove,this),this.ScrollBox.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchMove,this),this.ScrollBox.removeEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this),this.ScrollBox.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchEnd,this)},o.prototype.destroy=function(){e.prototype.destroy.call(this),this.tempCollection=void 0},o}(BaseEuiComponent);t.CpnnLotteryRecord=e,__reflect(e.prototype,"cpnn.CpnnLotteryRecord")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(){return e.call(this)||this}return __extends(o,e),o.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.data){this.GroupOther.visible=!0,this.issue.text=this.data.issue_id,this.time.text=this.data.time,this.data.issue_id==t.CpnnConst.newIssueId?(this.issue.textColor=16711935,this.time.textColor=16711935):(this.issue.textColor=10582988,this.time.textColor=10582988),0==this.data.open_type?this.resultNum.text="没牛":10==this.data.open_type?this.resultNum.text="牛牛":this.resultNum.text="牛"+this.data.open_type;for(var o=JSON.parse("["+this.data.issue_number+"]"),n=0;n<o.length;n++){var i=this.GroupOther.getChildAt(4+n);i.source="history_"+o[n]}}},o}(eui.ItemRenderer);t.CpnnLotteryRecordItem=e,__reflect(e.prototype,"cpnn.CpnnLotteryRecordItem")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(t){var o=e.call(this,"CpnnHelpSkin")||this;return o.visible=!1,o}return __extends(o,e),o.prototype.initComponent=function(){this.help_collection=new eui.ArrayCollection,this.helpList.itemRenderer=t.CpnnHelpItem,this.helpScroller.viewport.scrollH=0,this.helpScroller.viewport=this.helpList},o.prototype.showPopup=function(){this.visible=!0,this.bg.visible=!0,this.helpMain.scaleX=this.helpMain.scaleY=0,App.EffectUtils.showUI(this.helpMain),App.MouseUtils.addMouseWheel(this.onMouseWheel,this)},o.prototype.closePopup=function(){this.bg.visible=!1;var t=this;App.EffectUtils.hideUI(this.helpMain,200,0,function(){t.visible=!1}),App.MessageCenter.dispatch("closeHelpAtDesk"),App.MouseUtils.removeMouseWheel()},o.prototype.onMouseWheel=function(t){common.GUtils.touchMouseWheel(this.helpScroller,this.helpList,t.data)},o.prototype.touchMoveHandel=function(t){var e=this.helpScroller.viewport;e.scrollV=(this.helpList.getChildAt(0).height-e.height)/e.height*t.localY},o.prototype.touchTapHandle=function(t){var e=this.helpScroller.viewport,o=(this.helpList.getChildAt(0).height-e.height)/e.height*t.localY;egret.Tween.get(e).to({scrollV:o},1e3)},o.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.addEvent()},o.prototype.addEvent=function(){App.CommonUtils.effectButton(this.closeBtn,this.closePopup,this),this.scrollerBar_Area.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMoveHandel,this),this.scrollerBar_Area.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchTapHandle,this)},o.prototype.removeEvent=function(){App.CommonUtils.removeButton(this.closeBtn),this.scrollerBar_Area.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMoveHandel,this),this.scrollerBar_Area.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchTapHandle,this)},o.prototype.destroy=function(){e.prototype.destroy.call(this),this.removeEvent(),egret.Tween.removeTweens(this.helpScroller.viewport)},o}(BaseEuiComponent);t.HelpView=e,__reflect(e.prototype,"cpnn.HelpView")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(t){return e.call(this,"CpnnTimerSkin")||this}return __extends(o,e),o.prototype.open=function(){},o.prototype.startTimer=function(t){this._currentSecond=Math.round(t.remaining_time/1e3),this._currentState=t.state,this._currentSecond>0&&App.TimerManager.doTimer(1e3,this._currentSecond,this.timerFunc,this)},o.prototype.renderLottery=function(){if(this._currentSecond<3600){var t=this._currentSecond%60,e=Math.floor(this._currentSecond/60);this.timeSecond.text=10>t?"0"+t:""+t,this.timeMinute.text=10>e?"0"+e:""+e}},o.prototype.numShake=function(){R.setTimeOnce(function(){},this,500)},o.prototype.timerFunc=function(){this._currentSecond?(this._currentSecond--,this._currentState==t.GameStateConst.BETTING&&(this.renderLottery(),this._currentSecond<4&&App.SoundManager.playEffect(t.SoundConst.COUNT_DOWN))):this.stopTimer()},o.prototype.stopTimer=function(){App.TimerManager.remove(this.timerFunc,this),R.removeAllTimeOut(this),this._currentSecond=0},o.prototype.setCurIssue=function(t){this.Issue.text="第"+t+"期投注剩余时间:"},o.prototype.getRemaniTime=function(){return this._currentSecond},o.prototype.destroy=function(){e.prototype.destroy.call(this),this.stopTimer()},o}(BaseEuiComponent);t.Timer=e,__reflect(e.prototype,"cpnn.Timer")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(){function t(){}return t.Overweight={yy:235,index:0,isEnd:!1},t.addPageSignMove="addPageSignMove",t.Scroll_Bar_Height=50,t.Scroll_Width=50,t.Renew_Scroll_Width=1e3,t.Help_bar_X=602,t.Table_Bar_X=850,t.Record_Bar_X=975,t}();t.CpnnConst=e,__reflect(e.prototype,"cpnn.CpnnConst");var o;!function(t){t[t.Base=1200]="Base",t[t.Popup=1201]="Popup"}(o=t.CpnnViewConst||(t.CpnnViewConst={}));var n=function(){function t(){}return t.BG="cpnn_bg_mp3",t.CARD_WASH="cpnn_cardwash_mp3",t.DEAL="cpnn_sendcard_mp3",t.START="cpnn_start_mp3",t.STOP="cpnn_stop_mp3",t.COUNT_DOWN="cpnn_countdown_mp3",t.ALERT="cpnn_alert_mp3",t.BET="cpnn_bet_mp3",t.SHOW="cpnn_show_mp3",t.HE="cpnn_he_mp3",t.WIN_BET="cpnn_win_bet_mp3",t.WIN_GAME="cpnn_win_game_mp3",t.RESULT=["cpnn_cow0_mp3","cpnn_cow1_mp3","cpnn_cow2_mp3","cpnn_cow3_mp3","cpnn_cow4_mp3","cpnn_cow5_mp3","cpnn_cow6_mp3","cpnn_cow7_mp3","cpnn_cow8_mp3","cpnn_cow9_mp3","cpnn_cow10_mp3"],t}();t.SoundConst=n,__reflect(n.prototype,"cpnn.SoundConst");var i;!function(t){t[t.PSYCHIC=0]="PSYCHIC",t[t.PLUTE1=1]="PLUTE1",t[t.PLUTE2=2]="PLUTE2",t[t.PLUTE3=3]="PLUTE3",t[t.SELF=4]="SELF",t[t.ONLINE=5]="ONLINE"}(i=t.PlayerConst||(t.PlayerConst={}));var s;!function(t){t[t.LOONG=0]="LOONG",t[t.TIGER=1]="TIGER",t[t.TIE=2]="TIE",t[t.one=3]="one",t[t.two=4]="two",t[t.three=5]="three",t[t.four=6]="four",t[t.five=7]="five",t[t.six=8]="six",t[t.seven=9]="seven",t[t.eight=10]="eight",t[t.nine=11]="nine",t[t.ten=12]="ten",t[t.eleven=13]="eleven",t[t.twelve=14]="twelve"}(s=t.TypeConst||(t.TypeConst={}));var r;!function(t){t[t.BetSucc=0]="BetSucc",t[t.BetErrorPlace=1]="BetErrorPlace",t[t.BetErrorMoney=2]="BetErrorMoney",t[t.BetErrorState=3]="BetErrorState",t[t.BetErrorOutLimitMin=4]="BetErrorOutLimitMin",t[t.BetErrorOutLimitMax=5]="BetErrorOutLimitMax",t[t.BetErrorOutLimitTotal=6]="BetErrorOutLimitTotal",t[t.BetErrorNoEnoughMoney=7]="BetErrorNoEnoughMoney",t[t.BetErrorNULL=8]="BetErrorNULL"}(r=t.CpnnBetResultCode||(t.CpnnBetResultCode={}));var a;!function(t){t[t.CLASSIC=1]="CLASSIC",t[t.LOTTORY=2]="LOTTORY"}(a=t.TableTypeConst||(t.TableTypeConst={}));var l=function(){function t(){}return t.NET_MSG={ENTER_GAME_R:"11904",ONLINE_NUM:"11905",ISSUE_NOTIFY:"11906",STATENOTIFY:"11907",LIMIT_NOTIFY:"11908",ME_BET:"11909",BET_RESPONSE:"11910",PLAYER_BET_INFONOTIFY:"11911",GAME_BET_INFO_NOTIFY:"11912",GAME_RESULT_NOTIFY:"11913",EXCHANGE_NOTIFY:"11914",CHART_REQ:"11812",CHART_NOTIFY:"11813",WIN_RECORD_REQ:"11915",WIN_RECORD_RES:"11916",RANKING_LIST_REQ:"11917",RANKING_LIST_RES:"11918",DEBUG_SET_CARD_REQ:"11818",DEBUG_SET_CARD_RES:"11819",SPECIAL_PLAYER_RES:"11919",SPECIAL_PLAYER_ACTION_RES:"11920",CHIPS_RECORD_REQ:"11921",CHIPS_RECORD_NOTIFY:"11922",HALL_CHART_REQ:"11901",HALL_CHART_RES:"11902",HALL_CHART_NOTIFY:"11903",HALL_STATUS_NOTIFY:"11923",ISSUE_HISTORY_REQ:"11924",ISSUE_HISTORY_RES:"11925",SWITCH_TABLE_REQ:"11926",ENTER_TABLE_REQ:"11927",ENTER_TABLE_RES:"11928",CANCEL_BET_RES:"11929",STATE_TEQ:"11930",STATE_TES:"11931",ABNORMAL_NOTIFY:"11932",HIT_RATE_RES:"11933"},t}();t.CpnnProxyConst=l,__reflect(l.prototype,"cpnn.CpnnProxyConst");var h;!function(t){t[t.onFirstEnterGameNotify=130001]="onFirstEnterGameNotify",t[t.onLastIssueNotifyBack=130002]="onLastIssueNotifyBack",t[t.onLimitNotifyBack=130003]="onLimitNotifyBack",t[t.onStateNotifyyBack=130004]="onStateNotifyyBack",t[t.onExchangeNotifyBack=130005]="onExchangeNotifyBack",t[t.onSelfBetCallBack=130006]="onSelfBetCallBack",t[t.onBetResponseBack=130007]="onBetResponseBack",t[t.onPlayerBetInfoNotifyBack=130008]="onPlayerBetInfoNotifyBack",t[t.onGameBetInfoNotify=130009]="onGameBetInfoNotify",t[t.onOnlineNumCallBack=130010]="onOnlineNumCallBack",t[t.onChartNotifyBack=130011]="onChartNotifyBack",t[t.onGameResultNotifyBack=130012]="onGameResultNotifyBack",t[t.onWinningRecordResBack=130013]="onWinningRecordResBack",t[t.onrankinglistresBack=130014]="onrankinglistresBack",t[t.onSpecialPlayerActionResBack=130015]="onSpecialPlayerActionResBack",t[t.onLeaveSceneResBack=130016]="onLeaveSceneResBack",t[t.onHitRateResBack=130017]="onHitRateResBack",t[t.onResultHistroy=130018]="onResultHistroy",t[t.HallChartNotify=80001]="HallChartNotify",t[t.btnHallcharTReq=80002]="btnHallcharTReq",t[t.createHallChart=80003]="createHallChart",t[t.createGameHallChart=80004]="createGameHallChart",t[t.changeHallChart=80005]="changeHallChart",t[t.changeGameChart=80006]="changeGameChart",t[t.changeHallstaus=80007]="changeHallstaus",t[t.changeGamestaus=80008]="changeGamestaus",t[t.closeHallChart=80009]="closeHallChart",t[t.getEnterTableRes=80010]="getEnterTableRes",t[t.onEnterBrnnGame=80011]="onEnterBrnnGame",t[t.onEnterTableGame=80012]="onEnterTableGame",t[t.onStateTimeResBack=80013]="onStateTimeResBack",t[t.addPageSignMove=80014]="addPageSignMove",t[t.Special_Player=80015]="Special_Player",t[t.Special_Player_Action=80016]="Special_Player_Action",t[t.Chips_Record_Notify=80017]="Chips_Record_Notify",t[t.rechargeMoney=80018]="rechargeMoney",t[t.resultHistroy=80019]="resultHistroy"}(h=t.CpnnCallBackConst||(t.CpnnCallBackConst={}));var p;!function(t){t[t.BETTING=2]="BETTING",t[t.EXCHANGE=5]="EXCHANGE"}(p=t.GameStateConst||(t.GameStateConst={}));var c;!function(t){t[t.bet=13e3]="bet",t[t.onIssueCallBack=13001]="onIssueCallBack",t[t.onGameStateCallBack=13002]="onGameStateCallBack",t[t.onChipsRecordCallBack=13003]="onChipsRecordCallBack",t[t.onShowTimerCallBack=13004]="onShowTimerCallBack",t[t.onSpecialPlayerCallBack=13005]="onSpecialPlayerCallBack",t[t.onGameResultCallBack=13006]="onGameResultCallBack",t[t.onRunWinnerCallBack=13007]="onRunWinnerCallBack",t[t.onBetCallBack=13008]="onBetCallBack",t[t.onBetActionCallBack=13009]="onBetActionCallBack",t[t.onBetInfoCallBack=13010]="onBetInfoCallBack",t[t.onGameBetInfoCallBack=13011]="onGameBetInfoCallBack",t[t.onExchangeCallBack=13012]="onExchangeCallBack",t[t.onChartCallBack=13013]="onChartCallBack",t[t.onRankingCallBack=13014]="onRankingCallBack",t[t.onOnlineCountCallBack=13015]="onOnlineCountCallBack",t[t.onChangeTableMenu=13016]="onChangeTableMenu",t[t.onSwitchTableCallBack=13017]="onSwitchTableCallBack",t[t.onOpenNumberCallBack=13018]="onOpenNumberCallBack",t[t.onLotteryRuel=13019]="onLotteryRuel",t[t.onRemainTimeCallBack=13020]="onRemainTimeCallBack",t[t.onTableInfoCallBack=13021]="onTableInfoCallBack",t[t.lobbySetOff=13022]="lobbySetOff",t[t.changeTable=13023]="changeTable",t[t.openLotteryRecord=13024]="openLotteryRecord",t[t.onHitRateCallBack=13025]="onHitRateCallBack"}(c=t.CpnnCallBacks||(t.CpnnCallBacks={}));var u=function(){function t(){}return t.ERRTXT_LIST=["","下注位置错误","下注金额太小或太大溢出","不在下注状态","超出单人限额","超出所有人总共限额","没有足够的余额"],t}();t.CpnnCodeErrorTxt=u,__reflect(u.prototype,"cpnn.CpnnCodeErrorTxt");var d;!function(t){t[t.BET_SUCC=0]="BET_SUCC",t[t.BET_ERROR_PLACE=1]="BET_ERROR_PLACE",t[t.BET_ERROR_MONEY=2]="BET_ERROR_MONEY",t[t.BET_ERROR_STATE=3]="BET_ERROR_STATE",t[t.BET_ERROR_OUTLIMIT=4]="BET_ERROR_OUTLIMIT",t[t.BET_ERROR_OUTTOTALLIMIT=5]="BET_ERROR_OUTTOTALLIMIT",t[t.BET_ERROR_NOENOUGH_MONEY=6]="BET_ERROR_NOENOUGH_MONEY"}(d=t.CpnnBetCodeConst||(t.CpnnBetCodeConst={}));var m=function(){function t(){}return t.CLASSIC_POINT={COUNTER_PICK1:"CNcounter_pick1",COUNTER_PICK5:"CNcounter_pick5",COUNTER_PICK10:"CNcounter_pick10",COUNTER_PICK20:"CNcounter_pick20",COUNTER_PICK50:"CNcounter_pick50",COUNTER_PICK100:"CNcounter_pick100",COUNTER_PICK200:"CNcounter_pick200",COUNTER_PICK500:"CNcounter_pick500",COUNTER_PICK1000:"CNcounter_pick1000",COUNTER_PICK0:"CNcounter_pickAllin",COUNTER_BET1:"CNcounter_bet1",COUNTER_BET5:"CNcounter_bet5",COUNTER_BET10:"CNcounter_bet10",COUNTER_BET20:"CNcounter_bet20",COUNTER_BET50:"CNcounter_bet50",COUNTER_BET100:"CNcounter_bet100",COUNTER_BET200:"CNcounter_bet200",COUNTER_BET500:"CNcounter_bet500",COUNTER_BET1000:"CNcounter_bet1000",COUNTER_BET0:"CNcounter_betallin",OPERATE_BUTTONCANCEL:"CNoperate_buttoncancel",OPERATE_BUTTONREPEAT:"CNoperate_buttonrepeat",OPERATE_BUTTONCONFIRM:"CNoperate_buttonconfirm",OPERATE_AUTOCONFIRM:"CNoperate_autoconfirm",OPERATE_SETCOUNTER:"CNoperate_setcounter",OPERATE_ADDCOUNTER:"CNoperate_addcounter",BETS_0:"CNbets_n0",BETS_1:"CNbets_n1",BETS_2:"CNbets_n2",BETS_3:"CNbets_n3",BETS_4:"CNbets_n4",BETS_5:"CNbets_n5",BETS_6:"CNbets_n6",BETS_7:"CNbets_n7",BETS_8:"CNbets_n8",BETS_9:"CNbets_n9",BETS_10:"CNbets_nn",BETS_11:"CNbets_big",BETS_12:"CNbets_small",BETS_13:"CNbets_signal",BETS_14:"CNbets_paire",DIRECT_MAPS:"CNdirect_maps",LEADERBOARD_BUTTON:"CNleaderboard_button",MENU_BUTTON:"CNmenu_button",MENU_HELP_BUTTON:"CNmenu_help_button",MENU_SET_BUTTON:"CNmenu_set_button",MENU_RECORD_BUTTON:"CNmenu_record_button",MENU_BACK_BUTTON:"CNmenu_back_button"},t}();t.PointConst=m,__reflect(m.prototype,"cpnn.PointConst")}(cpnn||(cpnn={}));var cpnn;!function(t){var e;!function(t){t[t.Base=301e3]="Base",t[t.CpnnHelp=301001]="CpnnHelp"}(e=t.ViewConst||(t.ViewConst={}))}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t._view=null,t._proxy=null,t._ranking=null,t._gameSet=null,t._popupView=null,t.isFly=!0,t}return __extends(o,e),o.prototype.onCreate=function(){e.prototype.onCreate.call(this),this.inits(),this.addListeners()},o.prototype.onInit=function(t){e.prototype.onInit.call(this),Log.trace("GameController init()"),this.registers(),this.gameInit()},Object.defineProperty(o.prototype,"model",{get:function(){return e.prototype.getModel.call(this)},enumerable:!0,configurable:!0}),o.prototype.inits=function(){e.prototype.inits.call(this),this._model=new t.GameModel(this),this._proxy=new t.GameProxy(this,this.getModel()),this._view=new t.GameView(this),this._popupView=new t.PopView(this),this._popupView.GameSet.initSet()},o.prototype.registers=function(){e.prototype.registers.call(this),App.ViewManager.register(t.CpnnViewConst.Base,this._view),App.ViewManager.register(t.CpnnViewConst.Popup,this._popupView),this.registerRecharge(),this.registerRedpacket(),this.registerFunc("touch",this.touch,this),this.registerFunc("showRank",this.showRank,this),this.registerFunc("showHelp",this.showHelp,this),this.registerFunc("conserBet",this.conserBet,this),this.registerFunc("repeatBet",this.repeatBet,this),this.registerFunc("setAutoBet",this.setAutoBet,this),this.registerFunc("confirmBet",this.confirmBet,this),this.registerFunc("showRecord",this.showRecord,this),this.registerFunc("showRoadMap",this.showRoadMap,this),this.registerFunc("showGameSet",this.showGameSet,this),this.registerFunc("backToLobby",this.backToLobby,this),this.registerFunc("btnShowMenu",this.menuPoints,this),this.registerFunc("showGameSet",this.showGameSet,this),this.registerFunc("ShowsetChip",this.ShowsetChip,this),this.registerFunc("getFiveChip",this.getFiveChip,this),this.registerFunc("closeRoadMap",this.closeRoadMap,this),this.registerFunc("getChipValue",this.getChipValue,this),this.registerFunc("rechargeMoney",this.rechargeMoney,this),this.registerFunc("changeMultiple",this.changeMultiple,this),this.registerFunc("confirmLimitBet",this.confirmLimitBet,this),this.registerFunc("confirmShowhand",this.confirmShowhand,this),this.registerFunc("operateAddcounter",this.addCounterPoints,this),this.registerFunc("confirmShowRecharge",this.confirmShowRecharge,this),this.registerFunc(t.CpnnCallBacks.bet,this.bet,this),this.registerFunc(t.CpnnCallBacks.onChangeTableMenu,this.onChangeTableMenu,this),this.registerFunc(t.CpnnCallBacks.onRunWinnerCallBack,this.onRunWinnerCallBack,this),this.registerFunc(t.CpnnCallBackConst.getEnterTableRes,this.getEnterTableRes,this),this.registerFunc(t.CpnnCallBackConst.Chips_Record_Notify,this.ChipsRecordNotify,this),this.registerFunc(t.CpnnCallBackConst.resultHistroy,this.resultHisReq,this),this.addEventListeners()},o.prototype.addEventListeners=function(){this.registerFunc(t.CpnnCallBackConst.onFirstEnterGameNotify,this.onFirstEnterGameAck,this),this.registerFunc(t.CpnnCallBackConst.onLastIssueNotifyBack,this.onIssueNotifyAck,this),this.registerFunc(t.CpnnCallBackConst.onLimitNotifyBack,this.onLimitNotifyBack,this),this.registerFunc(t.CpnnCallBackConst.onStateNotifyyBack,this.onStateNotifyyBack,this),this.registerFunc(t.CpnnCallBackConst.onExchangeNotifyBack,this.onExchangeNotifyBack,this),this.registerFunc(t.CpnnCallBackConst.onBetResponseBack,this.onBetResponseBack,this),this.registerFunc(t.CpnnCallBackConst.onPlayerBetInfoNotifyBack,this.onPlayerBetInfoNotifyBack,this),this.registerFunc(t.CpnnCallBackConst.onGameBetInfoNotify,this.onGameBetInfoNotify,this),this.registerFunc(t.CpnnCallBackConst.onOnlineNumCallBack,this.onOnlineNumCallBack,this),this.registerFunc(t.CpnnCallBackConst.onChartNotifyBack,this.onChartNotifyBack,this),this.registerFunc(t.CpnnCallBackConst.onGameResultNotifyBack,this.onGameResultNotifyBack,this),this.registerFunc(t.CpnnCallBackConst.onrankinglistresBack,this.onrankinglistresBack,this),this.registerFunc(t.CpnnCallBackConst.onStateTimeResBack,this.onStateTimeResBack,this),this.registerFunc(t.CpnnCallBackConst.onHitRateResBack,this.onHitRateResBack,this),this.registerFunc(t.CpnnCallBackConst.Special_Player,this.specialPlayer,this),this.registerFunc(t.CpnnCallBackConst.Special_Player_Action,this.specialPlayerAction,this),this.registerFunc(t.CpnnCallBackConst.createGameHallChart,this.createGameHallChart,this),this.registerFunc(t.CpnnCallBackConst.changeGamestaus,this.changeGamestaus,this),this.registerFunc(t.CpnnCallBackConst.changeGameChart,this.changeGameChart,this),this.registerFunc(t.CpnnCallBacks.changeTable,this.changeTable,this),this.registerFunc(t.CpnnCallBacks.lobbySetOff,this.lobbySetOff,this),this.registerFunc(t.CpnnCallBackConst.onResultHistroy,this.resultHisAck,this)},o.prototype.onReconstruction=function(){e.prototype.onReconstruction.call(this),this.model.isBackstage=!1},o.prototype.addListeners=function(){e.prototype.addListeners.call(this),this._proxy.addEvent()},o.prototype.removeListeners=function(){e.prototype.removeListeners.call(this),this._proxy.removeEvent()},o.prototype.onUserMoneyChange=function(e){this.model.playerMoneys[t.PlayerConst.SELF]=e.balance,this._view.setUserMoney(App.CommonUtils.money2Str(this.model.playerMoneys[t.PlayerConst.SELF]))},o.prototype.getModel=function(){return e.prototype.getModel.call(this)},o.prototype.gameInit=function(){App.ViewManager.open(t.CpnnViewConst.Base),App.ViewManager.open(t.CpnnViewConst.Popup),this.initUserInfo(),this._view.initCoinBox(),App.SoundManager.playBg(t.SoundConst.BG),this.model.tableId=this.currDeskId,this.model.playerMoneys[t.PlayerConst.SELF]=this.player.getMoney(),this.model.isAutoBet=!0,this._view.setAutoConfirm(!0)},o.prototype.initUserInfo=function(){this.model.playerIds[t.PlayerConst.SELF]=this.player.getUserId(),this.model.playerMoneys[t.PlayerConst.SELF]=this.player.getMoney(),this._view.setUserInfo(this.player)},o.prototype.initJebutton=function(){this._view.createChip(this.model.chipArr),this._view.setchipValue(this.model._mTempMultiple),this._popupView.setDefaultChip(this.model.chipArr),this.touch(this.model.selBtnIndex)},o.prototype.GameFrameResume=function(){e.prototype.GameFrameResume.call(this),this._proxy.fknnRequestRemainTime(),this.clearTable(),egret.Tween.removeTweens(this),R.removeAllTimeOut(this),App.TimerManager.removeAll(this),this.model.isBackstage=!0},o.prototype.clearTable=function(){this._view.initInfo(),this._view.stopRegion(),this._view.hideTableLight()},o.prototype.clearCoins=function(){this._view.hideStar(),this._view.cleanChip(),this._view.clearFlyWinChip(),this.resetBet(),this.resetPerBet(),this.resetAllBet(),this._view.clearCoin(),this._view.initCoinBox(),this._view.setUserBet(0)
},o.prototype.betOverCallback=function(){this._view.clearPreMoney(),this._view.LoginBtn.betAsh(),this._view.disabledRepeatBet(),this._view.stopRegion()},o.prototype.onFirstEnterGameAck=function(t){t.table_id==this.model.tableId&&this.gameJoin(t)},o.prototype.onIssueNotifyAck=function(t){Log.trace("期号更新",t),t.table_id==this.model.tableId&&(this.model.issueId=t.issue,this._view.setLastIssue(t.issue)),this._view.showLotteryBall(t.issue_number),t.issue!=this.model.currIssue&&this.model.currIssue&&(Log.trace("data.issue",t.issue,this.model.currIssue),App.ScrollTxtTips.showTip(t.issue+"期：已开奖")),this.model.currIssue=t.issue},o.prototype.onLimitNotifyBack=function(t){Log.log("onLimitNotifyBack",t),t.table_id==this.model.tableId&&(this.model.limits=t.limits,this._view.setTableOdds(t.limits))},o.prototype.onStateNotifyyBack=function(e,o){if(Log.log("onStateNotifyyBack",e),this._view.setTimerIssue(e.cur_issue),this.model.gameStateData=common.GUtils.deepClone(e),e.table_id==this.model.tableId){if(this.makelastInit(),this.model.isBackstage)return void(e.state==t.GameStateConst.BETTING&&(this.refreshMoney(),this.clearCoins()));this.doGameState(e,o)}},o.prototype.doGameState=function(e,o){var n={total_time:e.total_time,remaining_time:e.remaining_time,state:e.state};switch(this.model.timerInfo=n,this._view.disabledBtn(),this._view.startTimer(this.model.timerInfo),e.state){case t.GameStateConst.BETTING:this.onBetting(e,o);break;case t.GameStateConst.EXCHANGE:this.onExchange(e)}},o.prototype.onBetting=function(e,o){Log.trace("投注中"),this.model.betTimes=!0,this.model.isBet=!0;var n=this.model.timerInfo;App.SoundManager.stopEff(t.SoundConst.WIN_GAME),this.clearTable(),o||(this.refreshMoney(),this.clearCoins()),this.renderClassicChart(),this.initStartBet(),n.total_time==n.remaining_time&&(this._view.betStartAni(),R.setTimeOnce(function(){App.SoundManager.playEffect(t.SoundConst.START)}.bind(this),this,100))},o.prototype.initStartBet=function(){this.isEnabledBtn(),this._view.startRegion(),this.resetWinMoney(),this.isOpenRepeatBet(),this._view.setUserBet(0),this._view.clearNum(),this._view.hideStar(),this.model.playerPlace.length=0,this.model.playerPlace=[],this.model.winPlayer.length=0,this.model.winPlayer=[],this.model._isFlylist.length=0,this.model._isFlylist=[]},o.prototype.isOpenRepeatBet=function(){this.model.lastBetRecord.length?this._view.enabledRepeatBet():this._view.disabledRepeatBet()},o.prototype.onExchange=function(e){this.model.isBet=!1;var o=this.model.timerInfo,n=this.getAllSelfBet();if(this.model._isFlylist.length=0,this.model._isFlylist=[],n){this.model.lastBetRecord.length=0;for(var i=this.model.betList,s=0;s<i.length;s++){var r=i[s];if(r){var a={place:s,bet_money:r};this.model.lastBetRecord.push(a)}}}o.time==o.allTime&&(this._view.betStopAni(),R.setTimeOnce(function(){App.SoundManager.playEffect(t.SoundConst.STOP)},this,100))},o.prototype.makelastInit=function(){var t=this.getAllSelfBet();if(t){this.model.lastBetRecord.length=0;for(var e=this.model.betList,o=0;o<e.length;o++){var n=e[o];if(n){var i={place:o,bet_money:n};this.model.lastBetRecord.push(i)}}}},o.prototype.getAllSelfBet=function(){for(var t=0,e=0;e<this.model.betList.length;e++)t+=this.model.betList[e];return t},o.prototype.onOnlineNumCallBack=function(t){Log.log("onOnlineNumCallBack",t),t.table_id==this.model.tableId&&this._view.changeOnlineNum(t.online_count)},o.prototype.onExchangeNotifyBack=function(e){if(Log.log("onExchangeNotifyBack",e),e.table_id==this.model.tableId){this.model.ExchangeMoney=0,this.model.playerMoneys[t.PlayerConst.SELF]=e.balance;for(var o=0;o<e.place_exchanges.length;o++){var n=e.place_exchanges[o].prize_money;e.place_exchanges[o].bet_money;this.model.ExchangeMoney+=n;var i=e.place_exchanges[o].place;n>0&&(this._view.createWinChip(i,t.PlayerConst.SELF),-1==this.model.winPlayer.indexOf(4)&&this.model.winPlayer.push(4))}this.model.winMoneys[t.PlayerConst.SELF]=this.model.ExchangeMoney;App.CommonUtils.money2Str(this.model.ExchangeMoney);this._view.playerWinMoney(this.model.ExchangeMoney,4),this.model.ExchangeMoney>0&&(this._view.directFontEnlarge(4),this._view.setUserMoney(App.CommonUtils.money2Str(this.model.playerMoneys[t.PlayerConst.SELF]))),this.model.ExchangeMoney>0&&(this.createWinRecord(),this.renderClassicChart())}},o.prototype.setRecordInit=function(t){var e=this.model.issueId,o=t,n={issue:e,hit_money:o};this.model.recordList.unshift(n),this.model.changerecordList(),console.log("战绩数据统计",this.model.recordList)},o.prototype.createWinRecord=function(){var e=this.model.issueId,o=this.model.winMoneys[t.PlayerConst.SELF];if(o){var n=this.model.recordList;if(n.length){for(var i=[],s=0;s<n.length;s++){var r=n[s];i.push(r.issue)}if(i.indexOf(e)>-1)return;this.addWinRecord(e,o)}else this.addWinRecord(e,o)}},o.prototype.addWinRecord=function(t,e){var o={issue:t,hit_money:App.CommonUtils.money(e)};this.model.recordList.unshift(o),this.model.recordList.length>50&&this.model.recordList.splice(50,this.model.recordList.length-50)},o.prototype.renderWinRecord=function(){this._popupView.renderWinRecord(this.model.recordList)},o.prototype.onBetResponseBack=function(e){if(Log.log("onBetResponseBack",e),e.table_id==this.model.tableId){this.model.hasBet=!0;var o=e.bets,n=!0;if(n=o.length>1?!0:!1,e.code)return this.betCodeTips(e.code,n),void(this.model.isAutoBet||this.isEnabledBtn());for(var i=0;i<o.length;i++){var s=o[i].place,r=o[i].bet_money;this._view.betToPlaceAni(t.PlayerConst.SELF,s,r)}this.resetPerBet(),this.betPoints(),this._view.avatarShake(4),this.model.playerMoneys[t.PlayerConst.SELF]=e.balance,this._view.setUserMoney(App.CommonUtils.money2Str(this.model.playerMoneys[t.PlayerConst.SELF]))}},o.prototype.betCodeTips=function(e,o){var n=e,i=this.model.limits[this.model.betPlace];switch(n){case t.CpnnBetResultCode.BetErrorOutLimitMin:t.CpnnUtil.textReminder(e,App.CommonUtils.money(i.limit_min_money),App.CommonUtils.money(i.limit_max_money));break;case t.CpnnBetResultCode.BetErrorOutLimitMax:if(o)t.CpnnUtil.textReminder(e);else{var s=this.model.betList[this.model.betPlace];s>=i.limit_max_money?t.CpnnUtil.textReminder(e,App.CommonUtils.money(i.limit_min_money),App.CommonUtils.money(i.limit_max_money)):(this.model.limitBetMoney=i.limit_max_money-s,this._popupView.Prompt.showPrompt(1,App.CommonUtils.money(this.model.limitBetMoney),App.CommonUtils.money(i.limit_min_money),App.CommonUtils.money(i.limit_max_money)))}break;case t.CpnnBetResultCode.BetErrorNoEnoughMoney:this._popupView.showPromptBrnn(6);break;default:t.CpnnUtil.textReminder(n)}},o.prototype.onPlayerBetInfoNotifyBack=function(t){if(Log.log("onPlayerBetInfoNotifyBack",t),t.table_id==this.model.tableId){var e=0,o=t.infos;this._view.showSelfBet(o);for(var n=0;n<o.length;n++){var i=o[n],s=i.bet_money;e+=s,this.model.betList[i.place]=i.bet_money}this._view.showSelfBet(this.model.betList),this._view.setUserBet(App.CommonUtils.money2Str(e))}},o.prototype.onGameBetInfoNotify=function(e){if(Log.log("onGameBetInfoNotify",e),e.table_id==this.model.tableId){var o=this.model.timerInfo;if(e.infos.length){for(var n=0;n<e.infos.length;n++){var i=e.infos[n];if(o.state==t.GameStateConst.BETTING){var s=i.total_bet_money-this.model.allBetList[i.place];this._view.betToPlaceAni(t.PlayerConst.ONLINE,i.place,s),this._view.ToolBar.onlineShake(),i.total_bet_money>0&&-1==this.model.playerPlace.indexOf(i.place)&&this.model.playerPlace.push(i.place)}this.model.allBetList[i.place]=i.total_bet_money}Log.trace("this.model.allBetList",this.model.allBetList),this._view.showBetMoney(this.model.allBetList)}}},o.prototype.onChartNotifyBack=function(t){if(Log.log("onChartNotifyBack",t),t.table_id==this.model.tableId){var e=t.charts;this.model.historyRecord=this.getchartList(e)}},o.prototype.getchartList=function(t){for(var e=t,o=[],n=0;n<e.length;n++){var i=e[n],s=-1;i.is_win_redcow?s=0:i.is_win_blackcow?s=1:i.is_win_draw&&(s=2),o[n]=s}return o},o.prototype.onGameResultNotifyBack=function(t,e){if(Log.log("onGameResultNotifyBack",t),t.table_id==this.model.tableId){if(this.model.gameResultData=App.CommonUtils.deepCopyData(t),this.model.isBackstage)return void this.doGameResult(t.place_results);var o=[],n=this.model.timerInfo;if(!t.place_results.length)return;o=o.concat(t.redcow_cards).concat(t.blackcow_cards),console.log("cardlist",o),e||this.doGameResult(t.place_results);var i=n.allTime-n.time;200>=i||this._view.directTableLight(this.model.winPos)}},o.prototype.doGameResult=function(e){var o=e,n=this.model.playerPlace;this.model.winPos.length=0,this.model.winPos=[];for(var i=0;i<o.length;i++){var s=o[i];(0==s.place||1==s.place||2==s.place)&&s.is_win&&(this.model.winner=s.place),s.is_win&&this.model.winPos.push(s.place)}if(this.addToChart(this.model.winner),n.length)for(var r=0;r<n.length;r++){var a=n[r],l=o[a].is_win;l&&this._view.createWinChip(a,t.PlayerConst.ONLINE)}},o.prototype.addToChart=function(t){this.model.betTimes&&(this.model.historyRecord.push(t),this.model.historyRecord.length>60&&this.model.historyRecord.splice(0,60))},o.prototype.onrankinglistresBack=function(t){Log.log("onrankinglistresBack",t),t.table_id==this.model.tableId&&(this._popupView.Ranking.rankData(t.infos),App.EasyLoading.hideLoading())},o.prototype.onStateTimeResBack=function(e){this.model.isBackstage=!1;var o=this.model.gameStateData;if(o){o.remaining_time=e.remaining_time,this.onStateNotifyyBack(o,!0);var n=this.model.gameResultData;o.state==t.GameStateConst.EXCHANGE&&n&&this.onGameResultNotifyBack(n,!0)}},o.prototype.onHitRateResBack=function(t){App.CommonUtils.money2StrTwo(2e4-t.hitrate);this._view.tableOdds()},o.prototype.specialPlayer=function(t){for(var e=0;e<t.length;e++){var o=t[e];this._view.setInformation(o),this.model.playerIds[o.play_role]=o.user_id,this.model.playerMoneys[o.play_role]=o.balance}for(var n=this.model.betList,i=0;i<n.length;i++){var o=n[i];this.model.userId==this.model.playerIds[0]&&!this.model.hasBet&&o>0&&(this._view.showStar(i),-1==this.model._isFlylist.indexOf(i)&&this.model._isFlylist.push(i))}},o.prototype.specialPlayerAction=function(t){Log.log("specialPlayerAction",t);var e=t.bets;this.model.timerInfo;if(t)if(t.play_action){for(var o=0,n=0;n<e.length;n++)e[n].money>0&&(o+=e[n].money);this.model.winMoneys[t.play_role]=o,this._view.playerWinMoney(o,t.play_role),this.model.playerMoneys[t.play_role]=t.balance,this._view.MsgInfo.setPluteName(t.nick_name,t.play_role),this._view.MsgInfo.setPluteImage("ui_headImg_json.ui_headImg_"+t.user_head,t.play_role),o>0&&(this._view.directFontEnlarge(t.play_role),this._view.specialPlayerMoney(App.CommonUtils.money2Str(t.balance),t.play_role))}else{var i=App.CommonUtils.money2Str(t.balance);this.model.playerMoneys[t.play_role]=t.balance,this._view.avatarShake(t.play_role),this._view.specialPlayerMoney(i,t.play_role);for(var n=0;n<e.length;n++){var s=e[n].place;t.play_role||-1!=this.model._isFlylist.indexOf(s)||(this.model._isFlylist.push(s),this._view.starFly(s))}for(var r=0;r<e.length;r++)this._view.betToPlaceAni(t.play_role,e[r].place,e[r].money)}},o.prototype.createGameHallChart=function(t){this._popupView.createTableList(t,this.model.tableId)},o.prototype.changeGamestaus=function(t){this._popupView.insertState(t)},o.prototype.changeGameChart=function(t){this._popupView.insertChart(t)},o.prototype.changeTable=function(t){if(Log.trace("游戏内换桌",t),this.setCurrDeskId(t.table_id_new),this.setCurrDeskType(2),t.table_id_new==this.model.tableId)console.log("进入当前房间"),this._popupView.closeChangeTable();else{var e={table_id_old:t.table_id_old,table_id_new:t.table_id_new};App.EasyLoading.showOnTimeOut(),this._proxy.fknnRequestDesk(e),this._popupView.closeChangeTable()}},o.prototype.lobbySetOff=function(){var t={table_id:this.model.tableId,is_switch_table:!1};console.log("关闭其他房间"),this._proxy.fknnGetGameChart(t)},o.prototype.ChipsRecordNotify=function(){this.model.chipArr.length&&this.initJebutton()},o.prototype.touch=function(t){this.model.selBtnIndex=t,this._view.toggleBtn(this.model.selBtnIndex),this.model.betNum=this.model._mTempChipMoney[this.model.selBtnIndex]},o.prototype.setAutoBet=function(t){this.model.isAutoBet=t,this.autoBetPoints(),t&&this.confirmBet()},o.prototype.resultHisReq=function(t){this._popupView.showLotteryRecord(),this._proxy.fknnHallHistoryReq(t)},o.prototype.resultHisAck=function(t){this._popupView.renderLotteryRecord(t)},o.prototype.ShowsetChip=function(){this._popupView.showChipSet(),this._popupView.setDefaultChip(this.model.chipArr),this.setCounterBtnPoints()},o.prototype.getFiveChip=function(t){if(this.model.chipArr=[].concat(t),this.model.chipArr.length){this._view.setBtnChip(this.model.chipArr),this._view.setchipValue(this.model._mTempMultiple);var e={chips:JSON.stringify(this.model.chipArr),table_id:this.model.tableId};this._proxy.fknnRequestChip(e)}},o.prototype.getChipValue=function(t){this.model._mTempChipMoney=t,this.model.betNum=this.model._mTempChipMoney[this.model.selBtnIndex],this.setCounterPoints()},o.prototype.changeMultiple=function(t){this._view.setchipValue(t),this.model._mTempMultiple=t},o.prototype.showHelp=function(){this._popupView.showHelp(),this.helpPoints()},o.prototype.showRecord=function(){this._popupView.showWinRecord(),this.winningRecordPoints()},o.prototype.showGameSet=function(){this._popupView.initGameSet(),this._popupView.showGameSet(),this.gameSetPoints()},o.prototype.showRank=function(){this._popupView.showRanking();var t={begin_idx:0,req_count:50,table_id:this.model.tableId};this._proxy.fknnRanking(t),this.rankingPoints()},o.prototype.rechargeMoney=function(){App.ViewManager.open(LobbyViewConst.Recharge)},o.prototype.backToLobby=function(){({table_id:this.model.tableId});this._proxy.sendLeaveDesk(this.model.tableId),this.backPoints()},o.prototype.onLeaveDesk=function(){e.prototype.onLeaveDesk.call(this),this.goBack2Desk()},o.prototype.bet=function(e,o){console.log("投注place",e),this.model.betPlace=Number(e);var n=o?o:1e4*this.model.betNum;if(this.isLimit(this.model.betPlace,n))return void(this.model.betPoints.length=0);if(n){var i={place:this.model.betPlace,bet_money:n};this.model.isAutoBet?this.autoBet([i]):this.manualBet(this.model.betPlace,n),this.betPlacePoints(e)}else{var s=this.getAllPreBet();this.model.betMoney=this.model.playerMoneys[t.PlayerConst.SELF]-s,this._popupView.showPrompt(2,App.CommonUtils.money(this.model.betMoney))}this.model.betPoints.push(this.model.betNum)},o.prototype.isLimit=function(e,o,n){void 0===n&&(n=!1);var i=!1,s=this.model.limits;this.model.isRepeat=n;for(var r=0;r<s.length;r++){var a=s[r];if(a.place==e){var l=this.getAllPreBet(),h=o,p=this.model.betList[e],c=this.model.preBetList[e],u=App.CommonUtils.money(a.limit_min_money),d=App.CommonUtils.money(a.limit_max_money);this.model.playerMoneys[t.PlayerConst.SELF]<=0?(this._popupView.showPromptBrnn(6),i=!0):h+l>this.model.playerMoneys[t.PlayerConst.SELF]?(this._popupView.showPromptBrnn(6),i=!0):h&&h<a.limit_min_money?(t.CpnnUtil.textReminder(t.CpnnBetResultCode.BetErrorOutLimitMin,u,d),i=!0):p+c>=a.limit_max_money?(n?t.CpnnUtil.textReminder(t.CpnnBetResultCode.BetErrorOutLimitMax):t.CpnnUtil.textReminder(t.CpnnBetResultCode.BetErrorOutLimitMax,u,d),i=!0):h+p+c>a.limit_max_money&&(n?t.CpnnUtil.textReminder(t.CpnnBetResultCode.BetErrorOutLimitMax):(this.model.betMoney=a.limit_max_money-(p+c),this._popupView.showPrompt(1,App.CommonUtils.money(this.model.betMoney),u,d)),i=!0)}}return i},o.prototype.autoBet=function(t){Log.trace("投注测试",t);var e=t,o={bets:e,table_id:this.model.tableId};this._proxy.betReq(o)},o.prototype.manualBet=function(t,e){this.model.preBetList[t]+=e,this._view.showMyPreBet(this.model.preBetList),this.isEnabledBtn()},o.prototype.confirmShowhand=function(){for(var t=this.model.betMoney,e=this.model.limits,o=0;o<e.length;o++){var n=e[o];n.place==this.model.betPlace&&(0==t?this._popupView.Prompt.showPromptBrnn(6):this.bet(this.model.betPlace,t))}},o.prototype.confirmBet=function(){if(console.log("确认投注"),this.model.isBet){for(var t=[],e=this.model.preBetList,o=0;o<e.length;o++){var n=e[o];if(n){var i={place:o,bet_money:n};t.push(i)}}if(t.length){var s={bets:t,table_id:this.model.tableId};this._proxy.betReq(s)}this._view.disabledConfirmBet(),this._view.disabledConserBet(),this.confirmBetPoints()}},o.prototype.conserBet=function(){this.resetPerBet(),this._view.disabledConfirmBet(),this._view.disabledConserBet(),this.concerBetPoints()},o.prototype.repeatBet=function(){var t=this.model.lastBetRecord;if(this.model.isBet){if(!t.length)return;var e=!0;e=t.length>1?!0:!1;for(var o=0;o<t.length;o++){var n=t[o];if(this.isLimit(n.place,n.bet_money,e))return}if(this.model.isAutoBet)this.autoBet(this.model.lastBetRecord);else{for(var i=0;i<t.length;i++){var s=t[i];this.model.preBetList[s.place]+=s.bet_money}this._view.BetBox.showMyPreBet(this.model.preBetList),this.isEnabledBtn()}this.repeatBetPoints()}},o.prototype.isLimitRepeat=function(){for(var e=!1,o=this.getAllPreBet(),n=0,i=this.model.preBetList,s=this.model.betList,r=this.model.limits,a=this.model.lastBetRecord,l=0;l<a.length;l++){var h=a[l];n+=h.bet_money;for(var p=h.bet_money+s[h.place]+i[h.place],c=0;c<r.length;c++){var u=r[c];h.place==u.place&&(n+o>this.model.playerMoneys[t.PlayerConst.SELF]?(this._popupView.showPromptBrnn(6),e=!0):p>u.limit_max_money&&(App.ScrollTxtTips.showTip(t.CpnnCodeErrorTxt.ERRTXT_LIST[4]),e=!0))}}return e},o.prototype.confirmLimitBet=function(){this.model.betMoney&&this.bet(this.model.betPlace,this.model.betMoney)},o.prototype.createWinChip=function(t,e,o){for(var n=this.model.playerIds,i=0;i<n.length;i++){var s=n[i];e==s&&(this._view.createWinChip(t,i),-1==this.model.winPlayer.indexOf(i)&&this.model.winPlayer.push(i),this.model.winMoneys[i]+=o)}},o.prototype.onRunWinnerCallBack=function(){var e=this;R.setTimeOnce(function(){e.CoinAnimation()},this,1e3);var o=this.model.winner==t.TypeConst.LOONG?void 0:this.model.winner==t.TypeConst.TIGER?void 0:t.SoundConst.HE;void 0!=o&&App.SoundManager.playEffect(o)},o.prototype.CoinAnimation=function(){this.renderClassicChart(),this._view.coinAniClear(this.model.winPos,this.model.winPlayer),this._view.showTableLight(this.model.winPos);var e=this;this.model.winMoneys[t.PlayerConst.SELF]&&(App.SoundManager.playEffect(t.SoundConst.WIN_GAME),R.setTimeOnce(function(){e.refreshPlayerMoney()},this,1e3))},o.prototype.renderClassicChart=function(){this.renderWinRecord()},o.prototype.refreshPlayerMoney=function(){this.refreshMoney()},o.prototype.refreshMoney=function(){this._view.setUserBet(0),this.refreshExchange()},o.prototype.refreshExchange=function(){for(var e=this.model.playerIds,o=0;o<e.length;o++)o==t.PlayerConst.SELF?this._view.setUserMoney(App.CommonUtils.money2Str(this.model.playerMoneys[o])):this._view.specialPlayerMoney(App.CommonUtils.money2Str(this.model.playerMoneys[o]),o)},o.prototype.getEnterTableRes=function(t){t.is_success&&(this.initDesktopData(),this._view.closeConfirmFrame(),this.model.tableId=t.table_id_new)},o.prototype.isEnabledBtn=function(){for(var t=this.model.preBetList,e=0,o=0;o<t.length;o++)e+=t[o];e&&(this._view.enabledConfirmBet(),this._view.enabledConserBet())},o.prototype.getAllPreBet=function(){for(var t=0,e=0;e<this.model.preBetList.length;e++)t+=this.model.preBetList[e];return t},o.prototype.resetWinMoney=function(){for(var t=this.model.winMoneys,e=0;e<t.length;e++)this.model.winMoneys[e]=0},o.prototype.resetPerBet=function(){for(var t=0;t<this.model.preBetList.length;t++)this.model.preBetList[t]=0;this._view.showMyPreBet(this.model.preBetList)},o.prototype.resetBet=function(){for(var t=0;t<this.model.betList.length;t++)this.model.betList[t]=0},o.prototype.resetAllBet=function(){for(var t=0;t<this.model.allBetList.length;t++)this.model.allBetList[t]=0},o.prototype.onChangeTableMenu=function(t){var e={table_id:GameModuleMgr.i.getCurrDeskId(),is_switch_table:!0};App.EasyLoading.showOnTimeOut();var o;t?(this._popupView.ChangeTable.showPopup(),o=t):o=!1,this._proxy.fknnGetGameChart(e)},o.prototype.showRoadMap=function(){var t=this._view.leftTable.horizontalCenter-90;egret.Tween.get(this._view.leftTable).to({horizontalCenter:t},200,egret.Ease.sineInOut)},o.prototype.closeRoadMap=function(){var t=this._view.leftTable.horizontalCenter+90;egret.Tween.get(this._view.leftTable).to({horizontalCenter:t},200,egret.Ease.sineInOut)},o.prototype.confirmShowRecharge=function(){App.ViewManager.open(LobbyViewConst.Recharge)},o.prototype.gameJoin=function(e){Log.log("进入游戏，页面信息显示");var o=this.player;e.user_id==o.getUserId()&&(this._view.setGameScene(e.table_name),this.model.tableId=e.table_id,this.model.isAutoBet=!0,this._view.setAutoConfirm(!0),this.model.userId=e.user_id,this.model.playerMoneys[t.PlayerConst.SELF]=e.balance,this._view.setUserName(e.nick_name),this._view.setUserMoney(App.CommonUtils.money2Str(this.model.playerMoneys[t.PlayerConst.SELF])))},o.prototype.initDesktopData=function(){this.model.clearModelData(),this._view.clearCoin(),this.model.hasBet=!1,App.TimerManager.removeAll(this),this._view.resetBetMoney(),this.model.lastBetRecord.length=0,this.model.lastBetRecord=[],this.model.recordList.length=0,this._view.stopTimer(),this._view.initCoinBox(),this.model._isFlylist.length=0,this.model._isFlylist=[],common.CoinFactory.i.clear(),this.isOpenRepeatBet(),this.betOverCallback(),this._view.setCoordinate(t.CpnnConst.Overweight.yy,t.CpnnConst.Overweight.index,t.CpnnConst.Overweight.isEnd)},o.prototype.setCounterPoints=function(){for(var e=this.model._mTempChipMoney,o=0;o<e.length;o++){var n=e[o];t.PointConst.CLASSIC_POINT["COUNTER_PICK"+n]&&R.sendPlayerAction(t.PointConst.CLASSIC_POINT["COUNTER_PICK"+n])}},o.prototype.betPoints=function(){for(var e=this.model.betPoints,o=0;o<e.length;o++){var n=e[o];t.PointConst.CLASSIC_POINT["COUNTER_BET"+n]&&R.sendPlayerAction(t.PointConst.CLASSIC_POINT["COUNTER_BET"+n])}this.model.betPoints.length=0},o.prototype.concerBetPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.OPERATE_BUTTONCANCEL)},o.prototype.repeatBetPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.OPERATE_BUTTONREPEAT)},o.prototype.confirmBetPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.OPERATE_BUTTONCONFIRM)},o.prototype.autoBetPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.OPERATE_AUTOCONFIRM)},o.prototype.setCounterBtnPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.OPERATE_SETCOUNTER)},o.prototype.addCounterPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.OPERATE_ADDCOUNTER)},o.prototype.betPlacePoints=function(e){R.sendPlayerAction(t.PointConst.CLASSIC_POINT["BETS_"+e])},o.prototype.menuPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.MENU_BUTTON)},o.prototype.helpPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.MENU_HELP_BUTTON)},o.prototype.gameSetPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.MENU_SET_BUTTON)},o.prototype.rankingPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.LEADERBOARD_BUTTON)},o.prototype.winningRecordPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.MENU_RECORD_BUTTON)},o.prototype.backPoints=function(){R.sendPlayerAction(t.PointConst.CLASSIC_POINT.MENU_BACK_BUTTON)},o.prototype.destroy=function(){e.prototype.destroy.call(this),Log.trace("cpnn销毁Controller"),common.StarExpand.cleanFormPool(),common.comBones.cleanFormPool(),App.TimerManager.removeAll(this),R.removeAllTimeOut(this),this._popupView.destroy(),this._proxy.destroy(),this._view.destroy(),this.model.destroy(),common.chipBtn.cleanchipBtnPool(),common.CoinFactory.i.clear(),this._view=void 0,this._proxy=void 0,this._gameSet=void 0,this._popupView=void 0},o}(base.GameController);t.GameController=e,__reflect(e.prototype,"cpnn.GameController")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(t){function e(e){var o=t.call(this,e)||this;return o.initData(),o}return __extends(e,t),e.prototype.initData=function(){this.tableType=0,this.isBet=!1,this.betPlace=-1,this.betNum=0,this.isAutoBet=!1,this.preBetList=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.betList=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.playerMoneys=[0,0,0,0,0,0],this.betMoney=0,this.selBtnIndex=0,this.chipArr=[1,3,5,7,9],this._mTempMultiple=1,this.allBetList=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.lastBetRecord=[],this.playerIds=[-1,-1,-1,-1,-1],this.historyRecord=[],this.winPos=[],this.winPlayer=[],this.winMoneys=[0,0,0,0,0],this.hasBet=!1,this.userMoney=0,this.idBet=!1,this.userId=0,this.isBackstage=!1,this.isFly=!1,this.specialMoney={},this._isFlylist=[],this._specialPlayer=[],this.ExchangeMoney=0,this.recordList=[],this.limitBetMoney=0,this.betPoints=[],this.playerPlace=[],this.isRepeat=!1,this.currIssue=""},e.prototype.changeGameChartList=function(){},e.prototype.changerecordList=function(){},e.prototype.clearModelData=function(){this.initData()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.initData()},e}(base.GameModel);t.GameModel=e,__reflect(e.prototype,"cpnn.GameModel")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(t,o){return e.call(this,t,o)||this}return __extends(o,e),Object.defineProperty(o.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),o.prototype.onFirstEnterGame=function(e){this.applyFunc(t.CpnnCallBackConst.onFirstEnterGameNotify,e)},o.prototype.onIssueNotify=function(e){t.CpnnConst.newIssueId=e.issue,this.applyFunc(t.CpnnCallBackConst.onLastIssueNotifyBack,e)},o.prototype.onLimitNotify=function(e){this.applyFunc(t.CpnnCallBackConst.onLimitNotifyBack,e)},o.prototype.onStateNotify=function(e){this.applyFunc(t.CpnnCallBackConst.onStateNotifyyBack,e)},o.prototype.onExchangeNotify=function(e){this.applyFunc(t.CpnnCallBackConst.onExchangeNotifyBack,e)},o.prototype.onBetResponse=function(e){App.EasyLoading.hideLoading(),this.applyFunc(t.CpnnCallBackConst.onBetResponseBack,e)},o.prototype.onPlayerBetInfoNotify=function(e){this.applyFunc(t.CpnnCallBackConst.onPlayerBetInfoNotifyBack,e)},o.prototype.onGameBetInfoNotify=function(e){this.applyFunc(t.CpnnCallBackConst.onGameBetInfoNotify,e)},o.prototype.onOnLineNum=function(e){this.applyFunc(t.CpnnCallBackConst.onOnlineNumCallBack,e)},o.prototype.onChartNotify=function(e){this.applyFunc(t.CpnnCallBackConst.onChartNotifyBack,e)},o.prototype.onGameResultNotify=function(e){this.applyFunc(t.CpnnCallBackConst.onGameResultNotifyBack,e)},o.prototype.onWinningRecordRes=function(e){this.applyFunc(t.CpnnCallBackConst.onWinningRecordResBack,e)},o.prototype.onrankinglistres=function(e){this.applyFunc(t.CpnnCallBackConst.onrankinglistresBack,e)},o.prototype.onSpecialPlayerResBack=function(e){Log.log("specialPlayer",e),e.table_id==this.model.tableId&&this.applyFunc(t.CpnnCallBackConst.Special_Player,e.special_player)},o.prototype.onSpecialPlayerActionResBack=function(e){Log.log("specialPlayerAction",e),e.table_id==this.model.tableId&&this.applyFunc(t.CpnnCallBackConst.Special_Player_Action,e)},o.prototype.onChipsRecordNotifyBack=function(e){if(Log.log("onChipsRecordNotifyBack",e),e.table_id==this.model.tableId){if(e.chips){var o=JSON.parse(e.chips);t.CpnnChips.i.setChips=o,this.model.chipArr=[].concat(o)}this.applyFunc(t.CpnnCallBackConst.Chips_Record_Notify)}},o.prototype.onIssueHistoryResBack=function(e){Log.log("onIssueHistoryResBack",e),e.table_id==this.model.tableId&&e.infos.length&&this.applyFunc(t.CpnnCallBackConst.onResultHistroy,e.infos),App.EasyLoading.hideLoading()},o.prototype.onGameChartResBack=function(e){Log.log("onGameChartResBack",e),this.applyFunc(t.CpnnCallBackConst.createGameHallChart,e),App.EasyLoading.hideLoading()},o.prototype.onGameStatusNotifyBack=function(e){Log.log("onGameStatusNotifyBack",e),this.applyFunc(t.CpnnCallBackConst.changeGamestaus,e)},o.prototype.onGameChartNotifyBack=function(e){Log.log("onGameChartNotifyBack",e),this.applyFunc(t.CpnnCallBackConst.changeGameChart,e)},o.prototype.onEnterTableResBack=function(e){Log.log("onEnterTableResBack",e),e.is_success&&(this.model.tableId=e.table_id_new,this.applyFunc(t.CpnnCallBackConst.getEnterTableRes,e),App.EasyLoading.hideLoading())},o.prototype.onStateTimeRes=function(e){Log.log("onStateTimeResBack",e),this.applyFunc(t.CpnnCallBackConst.onStateTimeResBack,e)},o.prototype.onAbnormalNotify=function(t){Log.log("onAbnormalNotify",t),!t},o.prototype.onHitRateRes=function(e){Log.log("onHitRateResBack",e),this.applyFunc(t.CpnnCallBackConst.onHitRateResBack,e)},o.prototype.addEvent=function(){e.prototype.addEvent.call(this),this.addListener(t.CpnnProxyConst.NET_MSG.ENTER_GAME_R,this.onFirstEnterGame,this),this.addListener(t.CpnnProxyConst.NET_MSG.ISSUE_NOTIFY,this.onIssueNotify,this),this.addListener(t.CpnnProxyConst.NET_MSG.LIMIT_NOTIFY,this.onLimitNotify,this),this.addListener(t.CpnnProxyConst.NET_MSG.STATENOTIFY,this.onStateNotify,this),this.addListener(t.CpnnProxyConst.NET_MSG.EXCHANGE_NOTIFY,this.onExchangeNotify,this),this.addListener(t.CpnnProxyConst.NET_MSG.BET_RESPONSE,this.onBetResponse,this),this.addListener(t.CpnnProxyConst.NET_MSG.PLAYER_BET_INFONOTIFY,this.onPlayerBetInfoNotify,this),this.addListener(t.CpnnProxyConst.NET_MSG.GAME_BET_INFO_NOTIFY,this.onGameBetInfoNotify,this),this.addListener(t.CpnnProxyConst.NET_MSG.ONLINE_NUM,this.onOnLineNum,this),this.addListener(t.CpnnProxyConst.NET_MSG.CHART_NOTIFY,this.onChartNotify,this),this.addListener(t.CpnnProxyConst.NET_MSG.GAME_RESULT_NOTIFY,this.onGameResultNotify,this),this.addListener(t.CpnnProxyConst.NET_MSG.WIN_RECORD_RES,this.onWinningRecordRes,this),this.addListener(t.CpnnProxyConst.NET_MSG.RANKING_LIST_RES,this.onrankinglistres,this),this.addListener(t.CpnnProxyConst.NET_MSG.SPECIAL_PLAYER_RES,this.onSpecialPlayerResBack,this),this.addListener(t.CpnnProxyConst.NET_MSG.SPECIAL_PLAYER_ACTION_RES,this.onSpecialPlayerActionResBack,this),this.addListener(t.CpnnProxyConst.NET_MSG.CHIPS_RECORD_NOTIFY,this.onChipsRecordNotifyBack,this),this.addListener(t.CpnnProxyConst.NET_MSG.ISSUE_HISTORY_RES,this.onIssueHistoryResBack,this),this.addListener(t.CpnnProxyConst.NET_MSG.HALL_CHART_RES,this.onGameChartResBack,this),this.addListener(t.CpnnProxyConst.NET_MSG.HALL_STATUS_NOTIFY,this.onGameStatusNotifyBack,this),this.addListener(t.CpnnProxyConst.NET_MSG.HALL_CHART_NOTIFY,this.onGameChartNotifyBack,this),this.addListener(t.CpnnProxyConst.NET_MSG.ENTER_TABLE_RES,this.onEnterTableResBack,this),this.addListener(t.CpnnProxyConst.NET_MSG.STATE_TES,this.onStateTimeRes,this),this.addListener(t.CpnnProxyConst.NET_MSG.ABNORMAL_NOTIFY,this.onAbnormalNotify,this),this.addListener(t.CpnnProxyConst.NET_MSG.HIT_RATE_RES,this.onHitRateRes,this)},o.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),e.prototype.removeMsgEventAll.call(this,this)},o.prototype.betReq=function(e){App.EasyLoading.showOnTimeOutDealy(),this.send(t.CpnnProxyConst.NET_MSG.ME_BET,e)},o.prototype.fknnWinRecord=function(e){this.send(t.CpnnProxyConst.NET_MSG.WIN_RECORD_REQ,e)},o.prototype.fknnRanking=function(e){this.send(t.CpnnProxyConst.NET_MSG.RANKING_LIST_REQ,e)},o.prototype.fknnChartlist=function(e){this.send(t.CpnnProxyConst.NET_MSG.CHART_REQ,e)},o.prototype.fknnRequestChip=function(e){this.send(t.CpnnProxyConst.NET_MSG.CHIPS_RECORD_REQ,e)},o.prototype.fknnHallHistoryReq=function(e){this.send(t.CpnnProxyConst.NET_MSG.ISSUE_HISTORY_REQ,e)},o.prototype.fknnGetGameChart=function(e){this.send(t.CpnnProxyConst.NET_MSG.SWITCH_TABLE_REQ,e)},o.prototype.fknnRequestDesk=function(e){this.send(t.CpnnProxyConst.NET_MSG.ENTER_TABLE_REQ,e)},o.prototype.fknnRequestRemainTime=function(){this.send(t.CpnnProxyConst.NET_MSG.STATE_TEQ,{table_id:this.model.tableId})},o.prototype.destroy=function(){e.prototype.destroy.call(this)},o}(base.GameProxy);t.GameProxy=e,__reflect(e.prototype,"cpnn.GameProxy")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(){function e(){}return e.setBrnnHitRate=function(t){e.hitRate=t},e.getBrnnHitRate=function(){return e.hitRate},e.catName=function(t){for(var e=t.toString().split(""),o=[],n=0;n<e.length;n++)o.push(Number(e[n]));return o},e.chipArr=function(t){for(var e=[],o=[],n={},i=0;i<t.length;i++)0!=t[i]&&(n={digit:t[i],bit:i},e.push(n)),o=e.length>=3?e.slice(0,3):e;
return o},e.deepClone=function(t){var e,o=Object.prototype.toString.call(t);if("[object Array]"===o){if(e=[],t.length>0)for(var n=0;n<t.length;n++)e.push(this.deepClone(t[n]))}else if("[object Object]"===o){e={};for(var n in t)e[n]=this.deepClone(t[n])}else e=t;return e},e.getPoints=function(t){for(var e=[],o=0;5>o;o++){var n=t.getChildAt(o),i=Math.floor(o%5),s=0;0!=i&&(s=i>2?-12:0);var r={x:n.x,y:n.y,_y:n.y+s};e.push(r)}return e},e.dealCard=function(t,e,o,n){var i=0;if(1==n)for(var s=0;5>s;s++){var r=t[s];this.pieceDealCard(r,e,o,i),i++}else for(var a=5;10>a;a++){var r=t[a];this.pieceDealCard(r,e,o,i),i++}},e.pieceDealCard=function(e,o,n,i){5>i&&(egret.Tween.removeTweens(e),egret.Tween.get(e).wait(n*i*1.5).to({x:o[e.name].x,y:o[e.name].y,scaleX:1,scaleY:1,alpha:1,rotation:0},n).call(function(){App.SoundManager.playEffect(t.SoundConst.DEAL)}))},e.createSkin=function(t){return 10>t?0:100>t?3:1e3>t?6:1e4>t?8:1e5>t?4:t>=1e5?9:void 0},e.getNumObj=function(t){var e=String(t).split(""),o={sw:0,w:0,q:0,b:0,s:0,g:0};switch(e.length){case 1:o.g=Number(e[0]);break;case 2:o.s=Number(e[0]),o.g=Number(e[1]);break;case 3:o.b=Number(e[0]),o.s=Number(e[1]),o.g=Number(e[2]);break;case 4:o.q=Number(e[0]),o.b=Number(e[1]),o.s=Number(e[2]),o.g=Number(e[3]);break;case 5:o.w=Number(e[0]),o.q=Number(e[1]),o.b=Number(e[2]),o.s=Number(e[3]),o.g=Number(e[4]);break;case 6:o.sw=Number(e[0]),o.w=Number(e[1]),o.q=Number(e[2]),o.b=Number(e[3]),o.s=Number(e[4]),o.g=Number(e[5])}for(var n in o)0==o[n]&&delete o[n];return o},e.textReminder=function(e,o,n){var i=null;switch(e){case t.CpnnBetResultCode.BetErrorPlace:i="下注位置错误";break;case t.CpnnBetResultCode.BetErrorMoney:i="下注金额异常";break;case t.CpnnBetResultCode.BetErrorState:i="非投注阶段，请稍后";break;case t.CpnnBetResultCode.BetErrorOutLimitMin:i="当前投注限红为"+o+"~"+n;break;case t.CpnnBetResultCode.BetErrorOutLimitMax:i=n?"当前投注限红为"+o+"~"+n:"超过限红，投注失败";break;case t.CpnnBetResultCode.BetErrorOutLimitTotal:i="当前投注项已达到总限红,投注失败!";break;case t.CpnnBetResultCode.BetErrorNoEnoughMoney:i="没有足够的余额";break;case t.CpnnBetResultCode.BetErrorNULL:i="下注为空"}App.ScrollTxtTips.showTip(i)},e.Brnn2counterPick=function(t){switch(t){case 1:R.sendPlayerAction("Brnn2counter_pick1");break;case 5:R.sendPlayerAction("Brnn2counter_pick5");break;case 10:R.sendPlayerAction("Brnn2counter_pick10");break;case 20:R.sendPlayerAction("Brnn2counter_pick20");break;case 50:R.sendPlayerAction("Brnn2counter_pick50");break;case 100:R.sendPlayerAction("Brnn2counter_pick100");break;case 200:R.sendPlayerAction("Brnn2counter_pick200");break;case 500:R.sendPlayerAction("Brnn2counter_pick500");break;case 1e3:R.sendPlayerAction("Brnn2counter_pick1000");break;case 0:R.sendPlayerAction("Brnn2counter_pickAllin")}},e.Brnn1counterBet=function(t){switch(t){case 1:R.sendPlayerAction("Brnn1counter_bet1");break;case 5:R.sendPlayerAction("Brnn1counter_bet5");break;case 10:R.sendPlayerAction("Brnn1counter_bet10");break;case 20:R.sendPlayerAction("Brnn1counter_bet20");break;case 50:R.sendPlayerAction("Brnn1counter_bet50");break;case 100:R.sendPlayerAction("Brnn1counter_bet100");break;case 200:R.sendPlayerAction("Brnn1counter_bet200");break;case 500:R.sendPlayerAction("Brnn1counter_bet500");break;case 1e3:R.sendPlayerAction("Brnn1counter_bet1000");break;case 0:R.sendPlayerAction("Brnn1counter_betallin")}},e.Brnn2counterBet=function(t){switch(t){case 1:R.sendPlayerAction("Brnn2counter_bet1");break;case 5:R.sendPlayerAction("Brnn2counter_bet5");break;case 10:R.sendPlayerAction("Brnn2counter_bet10");break;case 20:R.sendPlayerAction("Brnn2counter_bet20");break;case 50:R.sendPlayerAction("Brnn2counter_bet50");break;case 100:R.sendPlayerAction("Brnn2counter_bet100");break;case 200:R.sendPlayerAction("Brnn2counter_bet200");break;case 500:R.sendPlayerAction("Brnn2counter_bet500");break;case 1e3:R.sendPlayerAction("Brnn2counter_bet1000");break;case 0:R.sendPlayerAction("Brnn2counter_betallin")}},e.hitRate=null,e.brnn1betseast=["Brnn1bets_east","Brnn1bets_south","Brnn1bets_west","Brnn1bets_north"],e.brnn2betseast=["Brnn2bets_east","Brnn2bets_south","Brnn2bets_west","Brnn2bets_north"],e.data1=[{charts:[{is_win:[0,1,1,0],place:0},{is_win:[0,1,1,0],place:1},{is_win:[0,1,1,0],place:2},{is_win:[0,1,1,0],place:3}],time:10,state:1,table:0,isLottery:0},{charts:[{is_win:[0,1,1,0,1,1,0],place:0},{is_win:[0,1,0,0,1,1,0],place:1},{is_win:[0,1,1,0,0,1,0],place:2},{is_win:[0,1,1,0,1,1,0],place:3}],time:7,state:2,table:1,isLottery:0},{charts:[{is_win:[0,1,1,0,1,1,0,1,0],place:0},{is_win:[0,1,0,0,1,1,0,1,1],place:1},{is_win:[0,1,1,0,0,1,1,0,1],place:2},{is_win:[0,1,1,0,1,0,1,0,1],place:3}],time:5,state:1,table:2,isLottery:0},{charts:[{is_win:[0,1,1,0,1,1,0,1,0],place:0},{is_win:[0,1,0,0,1,1,0,1,1],place:1},{is_win:[0,1,1,0,0,1,1,0,1],place:2},{is_win:[0,1,1,0,1,0,1,0,1],place:3}],time:6,state:1,table:3,isLottery:0},{charts:[{is_win:[0,1,1,0,1,1,0,1,0],place:0},{is_win:[0,1,0,0,1,1,0,1,1],place:1},{is_win:[0,1,1,0,0,1,1,0,1],place:2},{is_win:[0,1,1,0,1,0,1,0,1],place:3}],time:8,state:1,table:4,isLottery:0},{charts:[{is_win:[0,1,1,0,1,1,0,1,0],place:0},{is_win:[0,1,0,0,1,1,0,1,1],place:1},{is_win:[0,1,1,0,0,1,1,0,1],place:2},{is_win:[0,1,1,0,1,0,1,0,1],place:3}],time:9,state:1,table:5,isLottery:0}],e.data2=[{charts:[{is_win:[0,1,1,0,1,1,0],place:0},{is_win:[0,1,1,0,1,1,0],place:1},{is_win:[0,1,1,0,1,1,0],place:2},{is_win:[0,1,1,0,1,1,0],place:3}],time:10,state:1,table:0,isLottery:1},{charts:[{is_win:[0,1,1,1,0],place:0},{is_win:[0,0,1,1,0],place:1},{is_win:[0,1,0,1,0],place:2},{is_win:[0,1,1,1,0],place:3}],time:8,state:1,table:1,isLottery:1},{charts:[{is_win:[0,1,1,0,1,1,0,1,0],place:0},{is_win:[0,1,0,0,1,1,0,1,1],place:1},{is_win:[0,1,1,0,0,1,1,0,1],place:2},{is_win:[0,1,1,0,1,0,1,0,1],place:3}],time:5,state:1,table:2,isLottery:1},{charts:[{is_win:[0,1,1,0,1,1,0],place:0},{is_win:[0,1,1,0,1,1,0],place:1},{is_win:[0,1,1,0,1,1,0],place:2},{is_win:[0,1,1,0,1,1,0],place:3}],time:10,state:1,table:3,isLottery:1},{charts:[{is_win:[0,1,1,0,1,1,0],place:0},{is_win:[0,1,1,0,1,1,0],place:1},{is_win:[0,1,1,0,1,1,0],place:2},{is_win:[0,1,1,0,1,1,0],place:3}],time:10,state:1,table:4,isLottery:1},{charts:[{is_win:[0,1,1,0,1,1,0],place:0},{is_win:[0,1,1,0,1,1,0],place:1},{is_win:[0,1,1,0,1,1,0],place:2},{is_win:[0,1,1,0,1,1,0],place:3}],time:10,state:1,table:5,isLottery:1}],e.data3=[{charts:[{is_win:[0,1,1,0],place:0},{is_win:[0,1,1,0],place:1},{is_win:[0,1,1,0],place:2},{is_win:[0,1,1,0],place:3}],time:10,state:1}],e}();t.CpnnUtil=e,__reflect(e.prototype,"cpnn.CpnnUtil")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(e){function o(t){var o=e.call(this,t,LayerManager.Game_Main,"cpnn","CpnnGameSkin")||this;return o._approach=null,o.BetBox.initComponent(t),o.JeButton.initComponent(t),o.LoginBtn.initComponent(t),o.ToolBar.initComponent(t),o}return __extends(o,e),o.prototype.open=function(t){e.prototype.open.call(this),this._mMoudel=t;this.Timer.open(),this.LoginBtn.open(),this.MsgInfo.allPlayerDisplay(),this.initInfo(),this.MsgInfo.setPluteLelf(),this.BetBox.hideTableLight(),this.ToolBar.reChargeEffect(),this.ToolBar.setOnlineLelf(),this.initChangeTableBone(),this.BetBox.createHeadPosition(),this.BetBox.setIsBetList(),this.BetBox.setTouchBtnAlpha(),this.disabledRepeatBet(),this.initIssueBall(),this.clearNum(),this.tableOdds(),this.initBroadcast(this,80),this.btnRedPacket=RedPackBone.create(),this.btnRedPacket.init(),this.RadePaper.addChild(this.btnRedPacket),this.btnRedPacket.x=-10,this.btnRedPacket.y=20,this.btnRedPacket.play(RedPackBone.Animation1),this.btnRedPacket.touchEnabled=!0},o.prototype.displayUI=function(){},o.prototype.tableOdds=function(){},o.prototype.initInfo=function(){this.MsgInfo.initInfo()},o.prototype.setGameScene=function(t){this.TableName.text=t},o.prototype.showLotteryBall=function(t){if(Log.trace("上期开奖小球",t),t){var e=JSON.parse("["+t+"]");Log.trace("tempData",e);for(var o=0;4>=o;o++){var n=this.lottery_result.getChildAt(o);n.source="common_ui_cp"+e[o]+"_png"}this.lottery_result.visible=!0}},o.prototype.initIssueBall=function(){for(var t=0;4>=t;t++){var e=this.lottery_result.getChildAt(t);e.source=""}this.setLastIssue("")},o.prototype.setUserInfo=function(t){this.setUserName(t.getNickName()),this.MsgInfo.setUserImage("ui_headImg_"+t.getAvatar()),this.MsgInfo.setUserFrame("ui_headBox_"+t.getAvatarBox()),this.setUserMoney(App.CommonUtils.money2Str(t.getMoney()))},o.prototype.setUserName=function(t){this.MsgInfo.setUserName(t)},o.prototype.setTableOdds=function(t){for(var e=this.oddsGroup.$children.length,o=0;e>o;o++){var n=this.oddsGroup.getChildAt(o);0==o||5==o||10==o?n.text="x"+t[o].odds/100:n.text=""+t[o].odds/100}},o.prototype.setInformation=function(t){var e=t.nick_name,o="ui_headImg_json.ui_headImg_"+(t.user_head?t.user_head:t.user_head+1),n=App.CommonUtils.money(t.balance),i=t.play_role;this.MsgInfo.setPluteImage(o,i),this.MsgInfo.setPluteName(e,i),this.specialPlayerMoney(n,i),this.MsgInfo.playerDisplay(i)},o.prototype.changeOnlineNum=function(t){this.ToolBar.changeOnlineNum(""+t)},o.prototype.setUserBet=function(t){this.MsgInfo.setUserBet(""+t)},o.prototype.playerDisplay=function(t){this.MsgInfo.playerDisplay(t)},o.prototype.setPluteImage=function(t,e){this.MsgInfo.setPluteImage(t,e)},o.prototype.setPluteName=function(t,e){this.MsgInfo.setPluteName(t,e)},o.prototype.specialPlayerMoney=function(t,e){this.MsgInfo.specialPlayerMoney(t,e)},o.prototype.avatarShake=function(t){this.MsgInfo.avatarShake(t)},o.prototype.setAutoConfirm=function(t){this.LoginBtn.setAutoConfirm(t)},o.prototype.starFly=function(t){var e=this.MsgInfo.getPoint(),o=this.BetBox.getParabolicPoint(t),n=this.BetBox.getStarEndPoint(t),i=common.StarExpand.create();if(i){i.init(this);var s=500;i.run(e,o,n,s,function(){this.BetBox.showStar(t)}.bind(this),this)}},o.prototype.showStar=function(t){this.BetBox.showStar(t)},o.prototype.hideStar=function(){this.BetBox.hideStar()},o.prototype.setUserMoney=function(t){this.MsgInfo.setUserMoney(t)},o.prototype.setLastIssue=function(t){this.lastIssue.text="期号 : "+t},o.prototype.setJeButton=function(t){this.JeButton.createChip(t),this.setchipValue(1)},o.prototype.createChip=function(t){this.JeButton.createChip(t)},o.prototype.setchipValue=function(t){this.JeButton.setchipValue(t)},o.prototype.betStartAni=function(){this.BetAnimation.playAni(0)},o.prototype.betStopAni=function(){this.BetAnimation.playAni(1)},o.prototype.startTimer=function(t){this.Timer.startTimer(t)},o.prototype.stopTimer=function(){this.Timer.stopTimer()},o.prototype.toggleBtn=function(t){this.JeButton.toggleBtn(t)},o.prototype.resetBetMoney=function(){this.MsgInfo.resetBetMoney()},o.prototype.setCoordinate=function(t,e,o){this.LoginBtn.setCoordinate(t,e,o)},o.prototype.setBtnChip=function(t){this.JeButton.setBtnChip(t)},o.prototype.stopRegion=function(){this.BetBox.stopRegion()},o.prototype.startRegion=function(){this.BetBox.startRegion()},o.prototype.showBetMoney=function(t){this.BetBox.showBetMoney(t)},o.prototype.showSelfBet=function(t){this.BetBox.showSelfBet(t)},o.prototype.showMyPreBet=function(t){this.BetBox.showMyPreBet(t)},o.prototype.initCoinBox=function(){this.BetBox.initCoinBox()},o.prototype.playerWinMoney=function(t,e){this.MsgInfo.playerWinMoney(App.CommonUtils.money2Str(t),e)},o.prototype.betToPlaceAni=function(t,e,o){this.BetBox.betToPlaceAni(t,e,o)},o.prototype.createWinChip=function(t,e){this.BetBox.createWinChip(t,e)},o.prototype.coinAniClear=function(t,e){var o=e;o.length&&(this.BetBox.coinAniClear(t),R.setTimeOnce(function(){for(var t=0;t<o.length;t++){var e=o[t];this.MsgInfo.getMoneyLight(e)}},this,600))},o.prototype.moneyLight=function(t){var e=t;if(e.length)for(var o=0;o<e.length;o++){var n=e[o];this.MsgInfo.getMoneyLight(n)}},o.prototype.directFontEnlarge=function(t){this.MsgInfo.directFontEnlarge(t)},o.prototype.clearCoin=function(){this.BetBox.clearCoin()},o.prototype.clearNum=function(){this.BetBox.clearNum()},o.prototype.clearPreMoney=function(){this.BetBox.clearPreMoney()},o.prototype.setTimerIssue=function(t){this.Timer.setCurIssue(t)},o.prototype.showTableLight=function(t){console.log("显示桌面亮光1"),this.BetBox.showTableLight(t)},o.prototype.directTableLight=function(t){this.BetBox.directTableLight(t)},o.prototype.hideTableLight=function(){this.BetBox.hideTableLight()},o.prototype.enabledConfirmBet=function(){this.LoginBtn.enabledConfirmBet()},o.prototype.enabledConserBet=function(){this.LoginBtn.enabledConserBet()},o.prototype.enabledRepeatBet=function(){this.LoginBtn.enabledRepeatBet()},o.prototype.disabledConfirmBet=function(){this.LoginBtn.disabledConfirmBet()},o.prototype.disabledRepeatBet=function(){this.LoginBtn.disabledRepeatBet()},o.prototype.disabledConserBet=function(){this.LoginBtn.disabledConserBet()},o.prototype.disabledBtn=function(){this.LoginBtn.disabledRepeatBet(),this.LoginBtn.disabledConfirmBet(),this.LoginBtn.disabledConserBet()},o.prototype.enabledBtn=function(){this.LoginBtn.enabledRepeatBet(),this.LoginBtn.enabledConfirmBet(),this.LoginBtn.enabledConserBet()},o.prototype.closeConfirmFrame=function(){this.LoginBtn.closeConfirmFrame()},o.prototype.cleanChip=function(){this.BetBox.cleanChip()},o.prototype.clearFlyWinChip=function(){this.BetBox.clearFlyWinChip()},o.prototype.initChangeTableBone=function(){this._approach||(this._approach=new common.comBones,this.ChangeTableBox.addChild(this._approach)),this._approach.updateId("table"),this._approach.play(0)},o.prototype.onChangeTableHandler=function(){egret.Tween.get(this._approach).to({y:this._approach.y+20},80).to({y:0},80).call(function(){this.applyFunc(t.CpnnCallBacks.onChangeTableMenu,!0)},this),App.SoundManager.playEffect("click_mp3")},o.prototype.onResultHisReq=function(){var e=this.getBaseController(),o={begin_idx:0,req_count:50,table_id:e.currDeskId};this.applyFunc(t.CpnnCallBackConst.resultHistroy,o)},o.prototype.onOpenRedPac=function(){App.ViewManager.open(LobbyViewConst.RedPacket),this.btnRedPacket.play(RedPackBone.Animation1),App.SoundManager.playEffect("click_mp3")},o.prototype.RedPackNotify=function(){this.btnRedPacket.play(RedPackBone.Animation)},o.prototype.RedEnvelopeBack=function(){this.btnRedPacket.play(RedPackBone.Animation1)},o.prototype.addEvent=function(){e.prototype.addEvent.call(this),this.BetBox.addEvent(),this.ChangeTableBox.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeTableHandler,this),this.resultHistroy.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onResultHisReq,this),this.btnRedPacket.addEventListener(egret.TouchEvent.TOUCH_END,this.onOpenRedPac,this),App.MessageCenter.addListener(RedPacketConst.newRedEnvelopeNotity,this.RedPackNotify,this),App.MessageCenter.addListener(RedPacketConst.grabRedEnvelopeBack,this.RedEnvelopeBack,this),App.MessageCenter.addListener(RedPacketConst.expiredRedEnvelopeNotify,this.RedEnvelopeBack,this)},o.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.BetBox.removeEvent(),this.ChangeTableBox.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeTableHandler,this),this.resultHistroy.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onResultHisReq,this),this.btnRedPacket.removeEventListener(egret.TouchEvent.TOUCH_END,this.onOpenRedPac,this),App.MessageCenter.removeListener(RedPacketConst.newRedEnvelopeNotity,this.RedPackNotify,this),App.MessageCenter.removeListener(RedPacketConst.grabRedEnvelopeBack,this.RedEnvelopeBack,this),App.MessageCenter.removeListener(RedPacketConst.expiredRedEnvelopeNotify,this.RedEnvelopeBack,this)},o.prototype.destroy=function(){this._isDestroy||(e.prototype.destroy.call(this),Log.trace("cpnn销毁GameView"),this.BetBox.destroy(),this.JeButton.destroy(),this.LoginBtn.destroy(),this.ToolBar.destroy(),this.Timer.destroy(),this.MsgInfo.destroy(),this._approach&&(egret.Tween.removeTweens(this._approach),this._approach.destroy()))},o}(base.GameView);t.GameView=e,__reflect(e.prototype,"cpnn.GameView")}(cpnn||(cpnn={}));var cpnn;!function(t){var e=function(t){function e(e){var o=t.call(this,e,LayerManager.UI_Popup,"cpnn","CpnnPopSkin")||this;return o.SetChip.initComponent(e),o.Prompt.initComponent(e),o.ChangeTable.initComponent(e),o}return __extends(e,t),e.prototype.initUI=function(){this.SetChip.getcoordinate(),this.SetChip.createChip(),this.Help.initComponent(),this.LotteryRecord.initUI()},e.prototype.addEvent=function(){t.prototype.addEvent.call(this),this.SetChip.addEvent(),this.ChangeTable.addEvent(),this.LotteryRecord.addEvent()},e.prototype.removeEvent=function(){t.prototype.removeEvent.call(this),this.SetChip.removeEvent(),this.ChangeTable.removeEvent(),this.LotteryRecord.removeEvent()},e.prototype.showChipSet=function(){this.SetChip.showMenu()},e.prototype.setDefaultChip=function(t){this.SetChip.setDefaultChip(t)},e.prototype.initGameSet=function(){this.GameSet.initSet()},e.prototype.showHelp=function(){this.Help.showPopup()},e.prototype.showGameSet=function(){this.GameSet.showPopup()},e.prototype.showWinRecord=function(){this.WinningRecord.showPopup()},e.prototype.renderWinRecord=function(t){this.WinningRecord.rankData(t)},e.prototype.showRanking=function(){this.Ranking.showPopup()},e.prototype.renderRanking=function(t){this.Ranking.rankData(t)},e.prototype.showLotteryRecord=function(){this.LotteryRecord.showPopup()},e.prototype.renderLotteryRecord=function(t){this.LotteryRecord.refreshData(t)},e.prototype.showPrompt=function(t,e,o,n){this.Prompt.showPrompt(t,e,o,n)},e.prototype.showPromptBrnn=function(t,e){this.Prompt.showPromptBrnn(t,e)},e.prototype.showChangeTable=function(){this.ChangeTable.showPopup()},e.prototype.closeChangeTable=function(){this.ChangeTable.closePopup()},e.prototype.createTableList=function(t,e){this.ChangeTable.createList(t,e)},e.prototype.insertState=function(t){this.ChangeTable.onTableStateChange(t)},e.prototype.insertChart=function(t){this.ChangeTable.onTableChartChange(t)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.SetChip.destroy(),this.Prompt.destroy(),this.ChangeTable.destroy(),this.GameSet.destroy(),this.Help.destroy(),this.Ranking.destroy(),this.WinningRecord.destroy()},e}(base.GameView);t.PopView=e,__reflect(e.prototype,"cpnn.PopView")}(cpnn||(cpnn={}));