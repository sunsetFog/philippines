var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);i.prototype=e.prototype,t.prototype=new i},lobby;!function(t){var e=function(e){function i(t,i){var o=e.call(this,t,i)||this;return o.skinName="resource/lobby/skins/ExchangeSkin.exml",o}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.exchangeMoneyInput.restrict="0-9",this.exchangeMoneyInput.maxChars=8,this.tabAlipay.visible=!1,this.tabBankCard.selected=!0,this.tabAlipay.touchEnabled=!this.tabAlipay.selected,this.tabBankCard.touchEnabled=!this.tabBankCard.selected,this.tabAlipay.setImage("exchange_alipay_sel","exchange_alipay_nor",155,30),this.tabBankCard.setImage("exchange_bankcard_sel","exchange_bankcard_nor",155,30);var t=GamePlayerMgr.i.getPlayer();this.currMoney_txt.text=""+App.CommonUtils.money2Str(t.getMoney()),this._timer=new egret.Timer(1e3,1),this.BankCardGroup.visible=!1,this.AddBankCardGroup.visible=!1,this.bankCardListGroup.visible=!1,this._exchangeType=1;for(var i=0;5>i;i++)this["itemGroup"+i].visible=!1},i.prototype.addEvent=function(){Log.trace("添加事件"),e.prototype.addEvent.call(this),this.userName.addEventListener(eui.UIEvent.CHANGE,this.checkInputlength,this),this.cardNumber.addEventListener(eui.UIEvent.CHANGE,this.checkInputlength,this),this.tabAlipay.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.tabBankCard.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.add.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.specialChange,this),this.add.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.specialChangeEnd,this),this.add.addEventListener(egret.TouchEvent.TOUCH_END,this.specialChangeEnd,this),this.add.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeExchangeMoney,this),this.reduce.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.specialChange,this),this.reduce.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.specialChangeEnd,this),this.reduce.addEventListener(egret.TouchEvent.TOUCH_END,this.specialChangeEnd,this),this.reduce.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeExchangeMoney,this),this.exchangeMoneyInput.addEventListener(eui.UIEvent.CHANGE,this.checkInput,this),this.contentInput.addEventListener(eui.UIEvent.CHANGE,this.checkInput,this),this.contentInput.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openBankCardList,this),this.dropListBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openBankCardList,this),App.MessageCenter.addListener("bindBankCardListAck",this.onBindBankCardListBack,this),App.MessageCenter.addListener("bindBankCardAck",this.onBindBankCardBack,this),App.MessageCenter.addListener("unbindBankCardAck",this.onUnBindBankCardBack,this),App.MessageCenter.addListener(GameConsEvent.Game_UserMoneyChange,this.refreshMoney,this),App.CommonUtils.effectButton(this.addAlipay,this.openAlipayManager,this),App.CommonUtils.effectButton(this.addBankCard,this.openBankCardManager,this),App.CommonUtils.effectButton(this.bankCardCloseBtn,this.hideBankCardManager,this),App.CommonUtils.effectButton(this.addBankCardBtn,this.openAddBankCard,this),App.CommonUtils.effectButton(this.addBankCardCloseBtn,this.hideAddBankCard,this),App.CommonUtils.effectButton(this.addAlipayCloseBtn,this.hideAddAlipay,this),App.CommonUtils.effectButton(this.exchangeBtn,this.exchangeReq,this),App.CommonUtils.effectButton(this.closeBtn,this.close,this),App.CommonUtils.effectButton(this.bankCardCloseBtn,this.close,this),App.CommonUtils.effectButton(this.addBankCardConfirm,this.onBlindBankCard,this),App.CommonUtils.effectButton(this.addAlipayConfirm,this.onBlindAlipay,this),App.CommonUtils.effectButton(this.exchangeClearAll,this.clearInput,this),this._timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimerEnd,this);for(var t=0;5>t;t++){var i=this["itemGroup"+t].getChildAt(2);App.CommonUtils.effectButton(i,this.onDeleteBankCard,this,t)}for(var o in this.numBtnGroup2.$children){var n=this.numBtnGroup2.$children[o];App.CommonUtils.effectButton(n,this.numBtnOnClick,this,{name:n.name})}},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.userName.removeEventListener(eui.UIEvent.CHANGE,this.checkInputlength,this),this.cardNumber.removeEventListener(eui.UIEvent.CHANGE,this.checkInputlength,this),this.tabAlipay.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.tabBankCard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.add.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.specialChange,this),this.add.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.specialChangeEnd,this),this.add.removeEventListener(egret.TouchEvent.TOUCH_END,this.specialChangeEnd,this),this.add.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.changeExchangeMoney,this),this.reduce.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.specialChange,this),this.reduce.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.specialChangeEnd,this),this.reduce.removeEventListener(egret.TouchEvent.TOUCH_END,this.specialChangeEnd,this),this.reduce.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.changeExchangeMoney,this),this.exchangeMoneyInput.removeEventListener(eui.UIEvent.CHANGE,this.checkInput,this),this.contentInput.removeEventListener(eui.UIEvent.CHANGE,this.checkInput,this),this.contentInput.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openBankCardList,this),this.dropListBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openBankCardList,this),App.MessageCenter.removeListener("bindBankCardListAck",this.onBindBankCardListBack,this),App.MessageCenter.removeListener("bindBankCardAck",this.onBindBankCardBack,this),App.MessageCenter.removeListener("unbindBankCardAck",this.onUnBindBankCardBack,this),App.MessageCenter.removeListener(GameConsEvent.Game_UserMoneyChange,this.refreshMoney,this),App.CommonUtils.removeButton(this.addAlipay),App.CommonUtils.removeButton(this.addBankCard),App.CommonUtils.removeButton(this.addBankCardBtn),App.CommonUtils.removeButton(this.bankCardCloseBtn),App.CommonUtils.removeButton(this.addBankCardCloseBtn),App.CommonUtils.removeButton(this.addAlipayCloseBtn),App.CommonUtils.removeButton(this.exchangeBtn),App.CommonUtils.removeButton(this.closeBtn),App.CommonUtils.removeButton(this.addBankCardConfirm),App.CommonUtils.removeButton(this.addAlipayConfirm),App.CommonUtils.removeButton(this.exchangeClearAll),this._timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onTimerEnd,this);for(var t=0;5>t;t++){var i=this["itemGroup"+t].getChildAt(2);App.CommonUtils.removeButton(i)}for(var o in this.numBtnGroup2.$children)App.CommonUtils.removeButton(this.numBtnGroup2.$children[o])},i.prototype.switchTab=function(e){e.currentTarget==this.tabAlipay&&this.tabAlipay.touchEnabled?(this.tabBankCard.selected=!1,this.tabAlipay.touchEnabled=!this.tabAlipay.selected,this.tabBankCard.touchEnabled=!this.tabBankCard.selected,this.contentInput.prompt="输入您的支付宝账号",this.exchangeType_text.text="支付宝账号",this.addAlipay.visible=!0,this.addBankCard.visible=!1,this.clearInput(),this._exchangeType=2,R.sendPlayerAction("Lobbyexchange_toAlipay")):e.currentTarget==this.tabBankCard&&this.tabBankCard.touchEnabled&&(this.tabAlipay.selected=!1,this.tabAlipay.touchEnabled=!this.tabAlipay.selected,this.tabBankCard.touchEnabled=!this.tabBankCard.selected,this.contentInput.prompt="输入您的银行卡号",this.exchangeType_text.text="收款银行卡",this.addBankCard.visible=!0,this.addAlipay.visible=!1,this.clearInput(),this._exchangeType=1,R.sendPlayerAction("Lobbyexchange_tobankcard"));var i={type:this._exchangeType};this.applyFunc(t.ExchangeConst.BindBankCardListReq,i)},i.prototype.checkInput=function(t){switch(t.currentTarget){case this.exchangeMoneyInput:Number(this.exchangeMoneyInput.text)>=Math.floor(Number(this.currMoney_txt.text))&&(this.exchangeMoneyInput.text=Math.floor(Number(this.currMoney_txt.text))+"",App.ScrollTxtTips.showTip("已达到最大值"));break;case this.contentInput:this.contentInput.text.length>19&&(App.ScrollTxtTips.showTip("最大输入长度为19位"),this.contentInput.text=this.contentInput.text.slice(0,19))}},i.prototype.clearInput=function(){this.exchangeMoneyInput.text="",this.contentInput.text=""},i.prototype.openAlipayManager=function(){Log.trace("支付宝管理",this.addBankCardBtn.$children),this.managerTitle.source="exchange_bindAlipay_title",App.EffectUtils.showUI(this.BankCardGroup);var e={type:this._exchangeType};this.applyFunc(t.ExchangeConst.BindBankCardListReq,e),this.BankCardGroup.visible=!0;var i=this.addBankCardBtn.getChildAt(2);i.source="exchange_bindAlipay",R.sendPlayerAction("Lobbyexchange_changeAlipay")},i.prototype.openBankCardManager=function(){App.EffectUtils.showUI(this.BankCardGroup),this.managerTitle.source="exchange_managerBankcard_title";var e={type:this._exchangeType};this.applyFunc(t.ExchangeConst.BindBankCardListReq,e),this.BankCardGroup.visible=!0;var i=this.addBankCardBtn.getChildAt(2);i.source="exchange_addBankcard",R.sendPlayerAction("Lobbyexchange_bankcardcontrol")},i.prototype.hideBankCardManager=function(){this.BankCardGroup.visible=!1},i.prototype.openAddBankCard=function(){1==this._exchangeType?(App.EffectUtils.showUI(this.AddBankCardGroup),this.AddBankCardGroup.visible=!0,this.AddAlipayGroup.visible=!1,this.BankCardGroup.visible=!1,R.sendPlayerAction("Lobbyexchange_addbankcard")):(App.EffectUtils.showUI(this.AddBankCardGroup),this.AddAlipayGroup.visible=!0,this.AddBankCardGroup.visible=!1,this.BankCardGroup.visible=!1,R.sendPlayerAction("Lobbyexchange_bindingAlipay"))},i.prototype.hideAddBankCard=function(){this.AddBankCardGroup.visible=!1},i.prototype.hideAddAlipay=function(){this.AddAlipayGroup.visible=!1},i.prototype.changeExchangeMoney=function(t){var e;if(t.currentTarget==this.add){e=Math.floor(App.CommonUtils.money(GamePlayerMgr.i.getPlayer().getMoney())/100);var i=1==this._exchangeType?"Lobbyexchange_bankplusbutton":"Lobbyexchange_alipayplusbutton";R.sendPlayerAction(i)}else if(t.currentTarget==this.reduce){var i=1==this._exchangeType?"Lobbyexchange_bankminusbutton":"Lobbyexchange_alipayminusbutton";R.sendPlayerAction(i),e=-Math.floor(App.CommonUtils.money(GamePlayerMgr.i.getPlayer().getMoney())/100)}if(Number(this.exchangeMoneyInput.text)>=0){if(Number(this.exchangeMoneyInput.text)<0)return;Number(this.exchangeMoneyInput.text)+e>=App.CommonUtils.money(GamePlayerMgr.i.getPlayer().getMoney())?this.exchangeMoneyInput.text=""+Math.floor(App.CommonUtils.money(GamePlayerMgr.i.getPlayer().getMoney())):Number(this.exchangeMoneyInput.text)+e<=0?this.exchangeMoneyInput.text="":this.exchangeMoneyInput.text=""+(Number(this.exchangeMoneyInput.text)+e)}this.removeIncrementChange()},i.prototype.specialChange=function(t){t.currentTarget.tw=egret.Tween.get(t.currentTarget),t.currentTarget.tw.to({scaleX:.9,scaleY:.9},40),this._timer.start(),t.currentTarget==this.add?(Log.trace("长按+"),this._optType=1):t.currentTarget==this.reduce&&(Log.trace("长按-"),this._optType=2)},i.prototype.specialChangeEnd=function(t){t.currentTarget.tw=egret.Tween.get(t.currentTarget),t.currentTarget.tw.to({scaleX:1,scaleY:1},40),this.removeIncrementChange(),this._timer.stop(),this._timer.reset()},i.prototype.onTimerEnd=function(){App.TimerManager.doTimer(100,99,this.incrementChange.bind(this),this)},i.prototype.incrementChange=function(){if(!(Number(this.exchangeMoneyInput.text)>=Math.floor(App.CommonUtils.money(GamePlayerMgr.i.getPlayer().getMoney()))||Number(this.exchangeMoneyInput.text)<=0)){var t;return 1==this._optType&&(t=Math.floor(App.CommonUtils.money(GamePlayerMgr.i.getPlayer().getMoney())/100)),2==this._optType&&(t=-Math.floor(App.CommonUtils.money(GamePlayerMgr.i.getPlayer().getMoney())/100)),Number(this.exchangeMoneyInput.text)+t<=0?void(this.exchangeMoneyInput.text=""):void(this.exchangeMoneyInput.text=""+(Number(this.exchangeMoneyInput.text)+t))}},i.prototype.exchangeReq=function(){if(!this.exchangeMoneyInput.text)return void App.ScrollTxtTips.showTip("请输入兑换金额");if(!this.contentInput.text){if(1==this._exchangeType)return void App.ScrollTxtTips.showTip("请输入收款银行卡卡号");if(2==this._exchangeType)return void App.ScrollTxtTips.showTip("请输入支付宝账号")}Log.trace("发送兑换请求");var e={money:App.CommonUtils.moneyC2S(Number(this.exchangeMoneyInput.text)),bankid:this._curryBankId};this.applyFunc(t.ExchangeConst.ExchangeReq,e),1==this._exchangeType?R.sendPlayerAction("Lobbyexchange_bankexchangebutton"):R.sendPlayerAction("Lobbyexchange_Alipayexchangebutton")},i.prototype.removeIncrementChange=function(){Log.trace("停止增量"),App.TimerManager.removeAll(this)},i.prototype.numBtnOnClick=function(t){this.exchangeMoneyInput.text.length>0&&"0"==this.exchangeMoneyInput.text.substr(0,1)&&(this.exchangeMoneyInput.text=this.exchangeMoneyInput.text.slice(1)),Number(this.exchangeMoneyInput.text+t.name)<=Number(this.currMoney_txt.text)&&this.exchangeMoneyInput.text.length<this.currMoney_txt.text.length?this.exchangeMoneyInput.text=this.exchangeMoneyInput.text+t.name:Number(this.exchangeMoneyInput.text+t.name)>Number(this.currMoney_txt.text)&&(App.ScrollTxtTips.showTip("已达到最大值"),this.exchangeMoneyInput.text=this.currMoney_txt.text)},i.prototype.onBindBankCardListBack=function(t){if(Log.trace("onBindBankCardListBack",t),this.bankCardListGroup.removeChildren(),0==t.list.length||t.list.length>5)for(var e=0;5>e;e++){var i=this["itemGroup"+e];i.visible=!1}else{for(var e=0;5>e;e++){var i=this["itemGroup"+e];i.visible=!1}for(var e=0;e<t.list.length;e++){var i=this["itemGroup"+e];i.visible=!0;var o=i.getChildAt(1);o.text=t.list[e].bank_name+"  "+t.list[e].cardno;var n=i.getChildAt(0);1==this._exchangeType?n.text="卡"+(e+1):n.text="支付宝"+(e+1);var s=new eui.TextInput;s.touchChildren=!1,s.text=t.list[e].cardno,s.name=t.list[e].bank_id,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickBankCardList,this),this.bankCardListGroup.addChild(s)}}},i.prototype.onBindBankCardBack=function(){this.AddBankCardGroup.visible=!1,this.userName.text="",this.cardNumber.text="",this.cardNumBankName.text="";var e={type:this._exchangeType};this.applyFunc(t.ExchangeConst.BindBankCardListReq,e)},i.prototype.onDeleteBankCard=function(e){Log.trace("删除银行卡",e);var i=this.getBaseController().getModel(),o={type:this._exchangeType,bankid:this.bankCardListGroup.getChildAt(e).name};App.PromTipsView.show("是否解除该银行卡/支付宝",function(){this.applyFunc(t.ExchangeConst.UnBindBankCardReq,o),i.saveCurrIndex(e)},function(){},this,!0),R.sendPlayerAction("Lobbyexchange_deletebankcard")},i.prototype.onUnBindBankCardBack=function(t){this["itemGroup"+t].visible=!1},i.prototype.onClickBankCardList=function(t){Log.trace(t.currentTarget);var e=t.currentTarget;this.contentInput.text=e.text,this._curryBankId=e.name,this.bankCardListGroup.visible=!1},i.prototype.openBankCardList=function(){this.bankCardListGroup.visible=!this.bankCardListGroup.visible},i.prototype.onBlindBankCard=function(){if(!this.userName.text)return void App.ScrollTxtTips.showTip("开户人姓名不能为空");if(!this.cardNumber.text)return void App.ScrollTxtTips.showTip("银行卡号不能为空");if(!this.cardNumBankName.text)return void App.ScrollTxtTips.showTip("开户行不能为空");if(!App.StringUtils.isChinese(this.cardNumBankName.text))return void App.ScrollTxtTips.showTip("请输入格式正确的开户行");var e={type:this._exchangeType,cardholder:this.userName.text,bankname:this.cardNumBankName.text,cardno:this.cardNumber.text};this.applyFunc(t.ExchangeConst.BindBankCardReq,e)},i.prototype.onBlindAlipay=function(){if(!this.alipayUserName.text)return void App.ScrollTxtTips.showTip("姓名不能为空");if(!this.alipayNumber.text)return void App.ScrollTxtTips.showTip("支付宝账号不能为空");var e={type:this._exchangeType,cardholder:this.alipayUserName.text,cardno:this.alipayNumber.text};this.applyFunc(t.ExchangeConst.BindBankCardReq,e)},i.prototype.checkInputlength=function(t){switch(t.currentTarget){case this.userName:App.StringUtils.isIllegalString(this.userName.text)&&(App.ScrollTxtTips.showTip("该项请勿输入特殊字符"),this.userName.text=""),this.userName.text.length>10&&(App.ScrollTxtTips.showTip("名字长度限制为10"),this.userName.text=""),App.StringUtils.isIllegalString(this.userName.text)&&(App.ScrollTxtTips.showTip("该项请勿输入特殊字符"),this.userName.text="");break;case this.cardNumber:this.cardNumber.text.length>19&&(App.ScrollTxtTips.showTip("银行卡长度限制为19"),this.cardNumber.text="")}},i.prototype.open=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];e.prototype.open.call(this,i),App.EffectUtils.showUI(this),this.currMoney_txt.text=App.CommonUtils.money2Str(GamePlayerMgr.i.getPlayer().getMoney());var n={type:this._exchangeType};this.applyFunc(t.ExchangeConst.BindBankCardListReq,n)},i.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;App.EffectUtils.hideUI(this,200,0,function(){i.closeView(t)}),this.exchangeMoneyInput.text="",this.contentInput.text=""},i.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];App.ViewManager.closeView(this)},i.prototype.refreshMoney=function(t){Log.trace("兑换界面刷新余额",t),this.currMoney_txt.text=App.CommonUtils.money2StrTwo(t.balance)},i.prototype.destroy=function(){e.prototype.destroy.call(this),this._timer&&(this._timer.stop(),this._timer=null),this._exchangeType=void 0,this._curryBankId=void 0},i}(BaseEuiView);t.ExchangeView=e,__reflect(e.prototype,"lobby.ExchangeView")}(lobby||(lobby={}));var lobby;!function(t){var e;!function(e){var i=function(){function e(){}return e.prototype.getVersion=function(){return"v1.0.2"},e.prototype.enter=function(){Log.info("%c大厅版本："+this.getVersion(),"color:blue;background:yellow;"),this.initMoudle(),App.SoundManager.playBg("lobby_bg_mp3"),App.ViewManager.open(MainViewConst.Lobby,LayerManager.UI_Main)},e.prototype.initMoudle=function(){App.ControllerManager.register(ControllerConst.Lobby,new t.LobbyController),App.ControllerManager.register(LobbyControllerConst.UserInfo,new t.UserInfoController),App.ControllerManager.register(LobbyControllerConst.HeadImgSetting,new t.HeadImgSettingController),App.ControllerManager.register(LobbyControllerConst.Bank,new t.BankController),App.ControllerManager.register(LobbyControllerConst.Message,new t.MessageController),App.ControllerManager.register(LobbyControllerConst.Activity,new t.ActivityController),App.ControllerManager.register(LobbyControllerConst.Share,new t.ShareController),App.ControllerManager.register(LobbyControllerConst.Setting,new t.SettingController),App.ControllerManager.register(LobbyControllerConst.Exchange,new t.ExchangeController),App.ControllerManager.register(LobbyControllerConst.Recharge,new RechargeController),App.ControllerManager.register(LobbyControllerConst.redPacket,new RedPacketController),App.ControllerManager.register(LobbyControllerConst.ag,new t.AgController),App.ControllerManager.register(LobbyControllerConst.Customer,new t.CustomerController)},e.prototype.exit=function(){App.ControllerManager.unregister(ControllerConst.Lobby),App.ControllerManager.unregister(LobbyControllerConst.UserInfo),App.ControllerManager.unregister(LobbyControllerConst.HeadImgSetting),App.ControllerManager.unregister(LobbyControllerConst.Bank),App.ControllerManager.unregister(LobbyControllerConst.Message),App.ControllerManager.unregister(LobbyControllerConst.Activity),App.ControllerManager.unregister(LobbyControllerConst.Share),App.ControllerManager.unregister(LobbyControllerConst.Setting),App.ControllerManager.unregister(LobbyControllerConst.Exchange),App.ControllerManager.unregister(LobbyControllerConst.Recharge),App.ControllerManager.unregister(LobbyControllerConst.redPacket),App.ControllerManager.unregister(LobbyControllerConst.ag),App.ControllerManager.unregister(LobbyControllerConst.Customer)},e}();e.lobby=i,__reflect(i.prototype,"lobby.Entrance.lobby")}(e=t.Entrance||(t.Entrance={}))}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function t(){}return t.Lobby_RegisterAccount="10112",t.Lobby_Lobby_RegisterAccount_Back="10113",t.Lobby_GetCaptcha="10114",t.Lobby_GetCaptcha_Back="10115",t.Lobby_ResetLoginPassword="10116",t.Lobby_ResetLoginPassword_Back="10117",t.Lobby_Exchange="10122",t.Lobby_Exchange_Back="10123",t.Lobby_SaveMoney="10124",t.Lobby_SaveMoney_Back="10125",t.Lobby_TakeMoney="10126",t.Lobby_TakeMoney_Back="10127",t.Lobby_NoticeList="10128",t.Lobby_NoticeList_Back="10129",t.Lobby_SingleNotice="10130",t.Lobby_SingleNotice_Back="10131",t.Lobby_DeleteSingleNotice="10132",t.Lobby_DeleteSingleNotice_Back="10133",t.Lobby_MailList="10134",t.Lobby_MailList_Back="10135",t.Lobby_SingleMail="10136",t.Lobby_SingleMail_Back="10137",t.Lobby_DeleteSingleMail="10138",t.Lobby_DeleteSingleMail_Back="10139",t.Lobby_ActivityList="10140",t.Lobby_ActivityList_Back="10141",t.Lobby_SingleActivity="10142",t.Lobby_SingleActivity_Back="10143",t.Lobby_webLogOut="10144",t.Lobby_webLogOut_Back="10145",t.Lobby_roleSetting="10146",t.Lobby_roleSetting_Back="10147",t.Lobby_ResetMoneyPwd="10153",t.Lobby_ResetMoneyPwd_Back="10154",t.Lobby_BindBankCard="10155",t.Lobby_BindBankCard_Back="10156",t.Lobby_BindBankList="10157",t.Lobby_BindBankList_Back="10158",t.Lobby_UnBindBankCard="10178",t.Lobby_UnBindBankCard_Back="10179",t.Lobby_CustomerSendMsg="10180",t.Lobby_CustomerSendMsg_Back="10181",t.CsWorldAgentBackgroundReqType="10176",t.ScWorldAgentBackgroundResType="10177",t.Lobby_AdListInfo="10183",t.Lobby_AdListInfo_Back="10184",t.Lobby_AgGetBalance="10185",t.Lobby_AgGetBalance_Back="10186",t.Lobby_BalanceToAg="10187",t.Lobby_BalanceToAg_Back="10188",t.Lobby_BalanceToGame="10189",t.Lobby_BalanceToGame_Back="10190",t.Lobby_AgLogin="10191",t.Lobby_AgLogin_Back="10192",t.Lobby_AgUrl="10193",t.Lobby_AgUrl_Back="10194",t}();t.ProxyKeyConst=e,__reflect(e.prototype,"lobby.ProxyKeyConst")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._proxy=null,t.inits(),t.registers(),t.addListeners(),t.refreshView(GamePlayerMgr.i.getPlayer()),t}return __extends(i,e),i.prototype.refreshView=function(t){this.LobbyView.refresh()},i.prototype.onGameFramePause=function(){this.LobbyView.stopFrame(),Log.log("切换后台")},i.prototype.GameFrameResume=function(){this.LobbyView.startFrame()},i.prototype.inits=function(){e.prototype.inits.call(this),this._model=new t.LobbyModel(this),this._proxy=new t.LobbyProxy(this,this.getModel()),this.LobbyView=new t.LobbyView(this,LayerManager.UI_Main),App.ViewManager.register(MainViewConst.Lobby,this.LobbyView)},i.prototype.registers=function(){e.prototype.registers.call(this),this.registerFunc(GameConsEvent.Game_Frame_Pause,this.onGameFramePause,this),this.registerFunc(GameConsEvent.Game_Frame_Resume,this.GameFrameResume,this),this.registerFunc(t.LobbyConst.ChangeHeadImg,this.changeHeadImg,this),this.registerFunc(t.LobbyConst.ChangeNickName,this.changeNickName,this),this.registerFunc("refreshView",this.refreshView,this),this.registerFunc("openProxyWeb",this.openProxyWeb,this),this.registerFunc("adListReq",this.adListReq,this),this.registerFunc("AGLoginReq",this.agLoginReq,this)},i.prototype.openProxyWeb=function(t){this._proxy.sendGetAgentUrl()},i.prototype.adListReq=function(){this._proxy.onAdListReq()},i.prototype.agLoginReq=function(){this._proxy.onAgLoginReq()},i.prototype.addListeners=function(){e.prototype.addListeners.call(this),App.MessageCenter.addListener(GameConsEvent.Game_UserChangeAccount,this.refreshView,this),this._proxy.addEvent()},i.prototype.removeListeners=function(){e.prototype.removeListeners.call(this),App.MessageCenter.removeListener(GameConsEvent.Game_UserChangeAccount,this.refreshView,this),this._proxy.removeEvent()},Object.defineProperty(i.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),i.prototype.changeHeadImg=function(t,e,i){this.LobbyView.changeLobbyHeadImg(t,e,i)},i.prototype.changeNickName=function(t){this.LobbyView.changeNickName(t)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseController);t.LobbyController=e,__reflect(e.prototype,"lobby.LobbyController")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.activityData=[],i}return __extends(e,t),e.prototype.setListData=function(t){this.activityListData=t},e.prototype.getListData=function(){return this.activityListData},e.prototype.setData=function(t,e){this.activityData[t]=e},e.prototype.getData=function(t){return this.activityData[t]},e.prototype.destroy=function(){for(var t in this.activityData)this.activityData[t]=void 0;this.activityListData=void 0,this.activityData=void 0},e}(BaseModel);t.ActivityModel=e,__reflect(e.prototype,"lobby.ActivityModel")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseModel);t.AgModel=e,__reflect(e.prototype,"lobby.AgModel")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseModel);t.BankModel=e,__reflect(e.prototype,"lobby.BankModel")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.payTypeListData={},i}return __extends(e,t),e}(BaseModel);t.CustomerModel=e,__reflect(e.prototype,"lobby.CustomerModel")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.bankCardList=[],i.exchangeType=0,i}return __extends(e,t),e.prototype.saveBankCardList=function(t){this.bankCardList=t},e.prototype.getBankCardList=function(){return this.bankCardList},e.prototype.setExchangeType=function(t){this.exchangeType=t},e.prototype.getExchangeType=function(){return this.exchangeType},e.prototype.saveCurrIndex=function(t){this.currIndex=t},e.prototype.getCurrIndex=function(){return this.currIndex},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.bankCardList=void 0,this.exchangeType=void 0,this.currIndex=void 0},e}(BaseModel);t.ExchangeModel=e,__reflect(e.prototype,"lobby.ExchangeModel")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.adListData=[],i.curryIndex=0,i.lastIndex=0,i}return __extends(e,t),e.prototype.saveAdList=function(t){if(0!=t.length){var e=t;Log.trace("排序前",t),e.sort(function(t,e){return t.sort-e.sort!=0?t.sort-e.sort:void 0}),this.adListData=e,Log.trace("排序后",e),App.MessageCenter.dispatch(GameConsEvent.Game_ADListInfo,e)}},e.prototype.getAdList=function(t){return this.adListData[t]},e.prototype.setCurryIndex=function(t){this.curryIndex=t},e.prototype.getCurryIndex=function(){return this.curryIndex>this.adListData.length-1&&(this.curryIndex=0),this.curryIndex<0&&(this.curryIndex=this.adListData.length-1),this.curryIndex},e.prototype.getCurryAd=function(){var t=this.getCurryIndex();return this.adListData[t]},e.prototype.getAdSignSum=function(){return this.adListData.length},e.prototype.setLastIndex=function(t){1==t&&(0==this.curryIndex?this.lastIndex=this.adListData.length-1:this.lastIndex=this.curryIndex-1),2==t&&(this.curryIndex==this.adListData.length-1?this.lastIndex=0:this.lastIndex=this.curryIndex+1)},e.prototype.getLastIndex=function(){return this.lastIndex},e.prototype.destroy=function(){this.adListData=void 0,this.curryIndex=void 0,this.lastIndex=void 0},e}(BaseModel);t.LobbyModel=e,__reflect(e.prototype,"lobby.LobbyModel")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.annouceData=[],i.mailData=[],i}return __extends(e,t),e.prototype.setListData=function(t,e){1==e&&(this.mailListData=t),2==e&&(this.annouceListData=t)},e.prototype.cleanListData=function(t){1==t?this.mailListData=null:2==t&&(this.annouceListData=null)},e.prototype.getListData=function(t){return 1==t?this.mailListData:2==t?this.annouceListData:void 0},e.prototype.deleteListData=function(t,e){1==e&&this.mailListData.list.splice(t,1),2==e&&this.annouceListData.list.splice(t,1)},e.prototype.setData=function(t,e,i){1==i&&(this.mailData[t]=e),2==i&&(this.annouceData[t]=e)},e.prototype.getData=function(t,e){return 1==e?this.mailData[t]:2==e?this.annouceData[t]:void 0},e.prototype.deleteSingleData=function(t,e){1==e&&(this.mailData[t]=void 0),2==e&&(this.annouceData[t]=void 0)},e.prototype.destroy=function(){for(var t in this.annouceData)this.annouceData[t]=void 0;for(var t in this.mailData)this.mailData[t]=void 0;this.annouceData=void 0,this.annouceListData=void 0,this.mailData=void 0,this.mailListData=void 0},e}(BaseModel);t.MessageModel=e,__reflect(e.prototype,"lobby.MessageModel")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseModel);t.SettingModel=e,__reflect(e.prototype,"lobby.SettingModel")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseModel);t.UserInfoModel=e,__reflect(e.prototype,"lobby.UserInfoModel")}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function t(){}return t.DeleteItem=30031,t.ShowContent=30032,t.ActivityListReq=30033,t.SingleActivityReq=30034,t}();t.ActivityConst=e,__reflect(e.prototype,"lobby.ActivityConst")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return Log.trace("注册活动"),i.inits(),i.initFunc(),i.addListeners(),i.activityView=new t.ActivityView(i,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.Activity,i.activityView),i.activityPromptView=new t.ActivityPromptView(i,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.ActivityPrompt,i.activityPromptView),i}return __extends(i,e),i.prototype.inits=function(){e.prototype.inits.call(this),this.activityModel=new t.ActivityModel(this),this.activityProxy=new t.ActivityProxy(this,this.activityModel),this.setModel(this.activityModel)},i.prototype.initFunc=function(){this.registerFunc(t.ActivityConst.ActivityListReq,this.onActivityListReq,this),this.registerFunc(t.ActivityConst.SingleActivityReq,this.onActivityReq,this),this.registerFunc(t.ActivityConst.ShowContent,this.showContent,this)},i.prototype.onActivityListReq=function(t){this.activityProxy.activityListReq(t)},i.prototype.onActivityReq=function(t){this.activityProxy.singleActivityReq(t)},i.prototype.showContent=function(t){this.activityPromptView.showContent(t)},i.prototype.addListeners=function(){e.prototype.addListeners.call(this),this.activityProxy.addEvent()},i.prototype.removeListeners=function(){this.activityProxy.removeEvent()},i.prototype.destroy=function(){e.prototype.destroy.call(this),this.activityView.destroy(),this.activityProxy.destroy(),this.activityModel.destroy(),this.activityView=void 0,this.activityProxy=void 0,this.activityModel=void 0},i}(BaseController);t.ActivityController=e,__reflect(e.prototype,"lobby.ActivityController")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){var o=e.call(this,t,i)||this;return o.skinName="resource/lobby/skins/component/PromptSkin.exml",o}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.deleteBtn.visible=!1},i.prototype.addEvent=function(){e.prototype.addEvent.call(this),App.CommonUtils.effectButton(this.closeBtn2,this.closeView,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),App.CommonUtils.removeButton(this.closeBtn2)},i.prototype.deleteMessage=function(){var e=this.getBaseController();this.applyFunc(t.MessageConst.DeleteItem,{token:GamePlayerMgr.i.getPlayer().getToken(),id:this.currItemId},e.getMsgType()),App.ViewManager.closeView(this)},i.prototype.showContent=function(t){this.muScroller.viewport.scrollV=0,this.title.text=t.title,this.content.text=t.content,this.currItemId=t.id,this.muScroller.viewport.height=this.content.textHeight+10},i.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];
e.prototype.open.call(this,t),App.EffectUtils.showView(this)},i.prototype.closeView=function(){Log.trace("关闭弹出消息");var t=this;App.EffectUtils.hideView(this,function(){App.ViewManager.closeView(t)})},i.prototype.clearContent=function(){this.title.text="",this.content.text=""},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseEuiView);t.ActivityPromptView=e,__reflect(e.prototype,"lobby.ActivityPromptView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){var o=e.call(this,t,i)||this;return o.skinName="resource/lobby/skins/ActivitySkin.exml",o}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.activityList.itemRenderer=t.ActivityItemRender,this.alCollection=new eui.ArrayCollection;var i=new eui.VerticalLayout;this.activityList.layout=i,this.scrollerActivity.scrollPolicyV=eui.ScrollPolicy.ON,this.scrollerActivity.scrollPolicyH=eui.ScrollPolicy.OFF;var o={token:GamePlayerMgr.i.getPlayer().getToken(),nowpage:1};this.applyFunc(t.ActivityConst.ActivityListReq,o)},i.prototype.addEvent=function(){e.prototype.addEvent.call(this),App.CommonUtils.effectButton(this.closeBtn,this.close,this),App.MessageCenter.addListener("onActivityListAck",this.createList,this),App.MessageCenter.addListener("onSingleActivityAck",this.showSingleAnnou,this),this.activityList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemClick,this),this.scrollerActivity.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.nextPage,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),App.CommonUtils.removeButton(this.closeBtn),App.MessageCenter.removeListener("onActivityListAck",this.createList,this),App.MessageCenter.removeListener("onSingleActivityAck",this.showSingleAnnou,this),this.activityList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListItemClick,this),this.scrollerActivity.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.nextPage,this)},i.prototype.initListData=function(t){for(var e=[],i=0;i<t.list.length;i++)e[i]={title:t.list[i].title,date:App.DateUtils.getFormatBySecond(1e3*Number(t.list[i].created_at),2),id:t.list[i].id,icon:"activity_favorble"};return e},i.prototype.createList=function(t){Log.trace("创建列表");var t=this.initListData(t);this.alCollection.replaceAll(t),this.activityList.dataProvider=this.alCollection,this.scrollerActivity.viewport=this.activityList,this.alCollection.refresh()},i.prototype.onListItemClick=function(e){var i=this.activityList.selectedIndex,o=this.activityList.getElementAt(i),n=this.getBaseController().getModel();n.getData(o.itemId)?this.showSingleAnnou(n.getData(o.itemId)):this.applyFunc(t.ActivityConst.SingleActivityReq,{token:GamePlayerMgr.i.getPlayer().getToken(),id:o.itemId})},i.prototype.showSingleAnnou=function(e){this.applyFunc(t.ActivityConst.ShowContent,e),R.sendPlayerAction("Lobbyactivity_clicklist"),App.ViewManager.open(LobbyViewConst.ActivityPrompt,LayerManager.UI_Tips)},i.prototype.nextPage=function(){if(!(this.scrollerActivity.viewport.scrollV+this.scrollerActivity.height<this.scrollerActivity.viewport.contentHeight&&this.scrollerActivity.viewport.scrollV>0)&&this.nowPage<this.totalPage){this.nowPage=this.nowPage+1;var e={token:GamePlayerMgr.i.getPlayer().getToken(),nowpage:this.nowPage};this.applyFunc(t.ActivityConst.ActivityListReq,e)}},i.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.prototype.open.call(this,t),App.EffectUtils.showUI(this)},i.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;App.EffectUtils.hideUI(this,200,0,function(){i.closeView(t)})},i.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];App.ViewManager.closeView(this)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseEuiView);t.ActivityView=e,__reflect(e.prototype,"lobby.ActivityView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function t(){}return t.Open_View="Ag_Open_View",t.AG_GetBlance="AG_GetBlance",t.AG_GetBlance_Back="AG_GetBlance_Back",t.AG_MoneyTrans="AG_MoneyTrans",t.AG_MoneyTrans_Back="AG_MoneyTrans_Back",t.AG_Url="AG_Url",t}();t.AgConst=e,__reflect(e.prototype,"lobby.AgConst")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.inits(),t.registers(),t.addListeners(),t}return __extends(i,e),i.prototype.inits=function(){e.prototype.inits.call(this),this.agModel=new t.AgModel(this),this.agProxy=new t.AgProxy(this,this.agModel),this.agView=new t.AgView(this,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.Ag,this.agView),this.setModel(this.agModel)},i.prototype.registers=function(){e.prototype.registers.call(this),this.registerFunc(t.AgConst.AG_GetBlance,this.onAgGetBalanceReq,this),this.registerFunc(t.AgConst.AG_MoneyTrans,this.onMoneyTransReq,this),this.registerFunc(t.AgConst.AG_Url,this.onAgUrlReq,this)},i.prototype.onAgGetBalanceReq=function(){this.agProxy.agBalanceReq()},i.prototype.onMoneyTransReq=function(t){this.agProxy.moneyTransformReq(t)},i.prototype.onAgUrlReq=function(){this.agProxy.agUrlReq()},i.prototype.addListeners=function(){e.prototype.addListeners.call(this),this.agProxy.addEvent()},i.prototype.removeListeners=function(){e.prototype.removeListeners.call(this),this.agProxy.removeEvent()},Object.defineProperty(i.prototype,"model",{get:function(){return this.agModel},enumerable:!0,configurable:!0}),i.prototype.destroy=function(){e.prototype.destroy.call(this),this.agProxy.destroy(),this.agModel.destroy(),this.agView=void 0,this.agProxy=void 0,this.agModel=void 0},i}(BaseController);t.AgController=e,__reflect(e.prototype,"lobby.AgController")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){var o=e.call(this,t,i)||this;return o.skinName="AgViewSkin",o}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.pwdInput.visible=!1,this.moneyInput.visible=!1,this._mRoleAnim=new t.RoleRabbitgirl,this._mRoleAnim.setScale(.5),this._mRoleAnim.play(),this.girlAnim.addChild(this._mRoleAnim),this._mButtonAnim=new t.AgButtonBone,this._mButtonAnim.play(),this.agBtnAnim.addChild(this._mButtonAnim)},i.prototype.addEvent=function(){e.prototype.addEvent.call(this);var i;for(var o in this.numBtnGroup1.$children)i=this.numBtnGroup1.$children[o],App.CommonUtils.effectButton(i,this.numBtnOnClick,this,{name:i.name});for(var o in this.numBtnGroup2.$children)i=this.numBtnGroup2.$children[o],App.CommonUtils.effectButton(i,this.pwdBtnOnClick,this,{name:i.name});App.CommonUtils.effectButton(this.closeBtn,this.closeView,this),App.CommonUtils.effectButton(this.pwdCloseBtn,this.pwdHide,this),App.CommonUtils.effectButton(this.moneyClear,this.clearMoneyInput,this),App.CommonUtils.effectButton(this.switchBtn,this.switchWallet,this),App.CommonUtils.effectButton(this.passwordClear,this.pwdBackOne,this),App.CommonUtils.effectButton(this.passwordClearAll,this.clearPwdInput,this),App.CommonUtils.effectButton(this.passwordConfirm,this.pwdConfirm,this),App.CommonUtils.effectButton(this.confirmBtn,this.confirmOpt,this),App.CommonUtils.effectButton(this.agBtnAnim,this.goToAg,this),this.moneyPwd.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pwdShow,this),this.optMoney.addEventListener(egret.TouchEvent.TOUCH_TAP,this.moneyInputShow,this),this.moneyInput.addEventListener(egret.TouchEvent.TOUCH_TAP,this.moneyInputHide,this),this.agBgGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.moneyInputHide,this),App.MessageCenter.addListener(t.AgConst.AG_GetBlance_Back,this.onAgBalanceAck,this),App.MessageCenter.addListener(t.AgConst.AG_MoneyTrans_Back,this.onMoneyTransSuccess,this),App.MessageCenter.addListener(GameConsEvent.Game_UserMoneyChange,this.refreshMoney,this),App.MessageCenter.addListener("AGLoginSuccess",this.onAGLoginSuccess,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this);for(var i in this.numBtnGroup1.$children)App.CommonUtils.removeButton(this.numBtnGroup1.$children[i]);for(var i in this.numBtnGroup2.$children)App.CommonUtils.removeButton(this.numBtnGroup2.$children[i]);App.CommonUtils.removeButton(this.closeBtn),App.CommonUtils.removeButton(this.pwdCloseBtn),App.CommonUtils.removeButton(this.moneyClear),App.CommonUtils.removeButton(this.switchBtn),App.CommonUtils.removeButton(this.passwordClear),App.CommonUtils.removeButton(this.passwordClearAll),App.CommonUtils.removeButton(this.passwordConfirm),App.CommonUtils.removeButton(this.confirmBtn),App.CommonUtils.removeButton(this.agBtnAnim),this.moneyPwd.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.pwdShow,this),this.optMoney.removeEventListener(egret.FocusEvent.FOCUS_IN,this.moneyInputShow,this),this.moneyInput.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.moneyInputHide,this),this.agBgGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.moneyInputHide,this),App.MessageCenter.removeListener("AGLoginSuccess",this.onAGLoginSuccess,this),App.MessageCenter.removeListener(t.AgConst.AG_MoneyTrans_Back,this.onMoneyTransSuccess,this),App.MessageCenter.removeListener(t.AgConst.AG_GetBlance_Back,this.onAgBalanceAck,this)},i.prototype.onAGLoginSuccess=function(){this.applyFunc(t.AgConst.AG_GetBlance)},i.prototype.onMoneyTransSuccess=function(){this.applyFunc(t.AgConst.AG_GetBlance),App.ScrollTxtTips.showTip("操作转款成功")},i.prototype.onAgBalanceAck=function(t){1==this.optType?(this.inWallet.text=App.CommonUtils.money2Str(t.ag_balance),this.agTips2.text="3.转出最小限额100元-无上额"):2==this.optType&&(this.outWallet.text=App.CommonUtils.money2Str(t.ag_balance),this.agTips2.text="3.转出最小限额1元,无上限"),GamePlayerMgr.i.getPlayer().setMoney(t.balance)},i.prototype.goToAg=function(){Log.trace("跳转AG"),this.applyFunc(t.AgConst.AG_Url)},i.prototype.pwdBackOne=function(){Log.trace("密码退格"),this.passwordInput.text=this.passwordInput.text.slice(0,this.passwordInput.text.length-1)},i.prototype.clearPwdInput=function(){this.passwordInput.text=""},i.prototype.pwdConfirm=function(){return this.passwordInput.text.length<6?void App.ScrollTxtTips.showTip("请输入6位数字的资金密码"):(this.pwdInput.visible=!1,this.moneyPwd.text=this.passwordInput.text,void(this.passwordInput.text=""))},i.prototype.clearMoneyInput=function(){this.optMoney.text=""},i.prototype.numBtnOnClick=function(t){this.optMoney.text.length>0&&"0"==this.optMoney.text.substr(0,1)&&(this.optMoney.text=this.optMoney.text.slice(1));var e=Math.floor(Number(this.outWallet.text));return Log.trace("tempLimitMoney",e,this.outWallet.text),Number(this.optMoney.text+t.name)>=e?(App.ScrollTxtTips.showTip("已到达最大值"),void(this.optMoney.text=e+"")):void(t&&this.optMoney.text.length<9&&(this.optMoney.text=this.optMoney.text+t.name))},i.prototype.pwdShow=function(){return GamePlayerMgr.i.getPlayer().getIsPwdSeted()?void(this.pwdInput.visible=!0):void App.PromTipsView.show("请先前往保险箱设置资金密码")},i.prototype.pwdHide=function(){this.pwdInput.visible=!1},i.prototype.moneyInputShow=function(){this.moneyInput.visible=!0,this.agTips.visible=!1},i.prototype.moneyInputHide=function(t){var e,i;e=this.globalToLocal(t.stageX,t.stageY),i=this.localToGlobal(this.moneyInput.x,this.moneyInput.y);var o=i.x+this.moneyInput.width+200,n=i.y+this.moneyInput.height;(e.x>o||e.y>n||e.x<i.x+100||e.y<i.y-60)&&this.moneyInput.visible&&t.currentTarget==this.agBgGroup&&(this.moneyInput.visible=!1,this.agTips.visible=!0)},i.prototype.pwdBtnOnClick=function(t){t&&this.passwordInput.text.length<6&&(this.passwordInput.text=this.passwordInput.text+t.name)},i.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.prototype.open.call(this,t);var o=GamePlayerMgr.i.getPlayer();this._mButtonAnim&&!this._mButtonAnim.parent&&(this.agBtnAnim.addChild(this._mButtonAnim),this._mButtonAnim.play()),this._mRoleAnim&&!this._mRoleAnim.parent&&(this.girlAnim.addChild(this._mRoleAnim),this._mRoleAnim.play()),App.EffectUtils.showUI(this),this.outWallet.text=""+App.CommonUtils.money2Str(o.getMoney()),this.inWallet.text="",this.outName.text="平台余额",this.inName.text="AG钱包",this.optType=1,Log.trace("this.optType",this.optType)},i.prototype.confirmOpt=function(){if(this.moneyPwd.text.length<6)return void App.ScrollTxtTips.showTip("请输入6位数字的资金密码");var e=Number(this.optMoney.text);if(1==this.optType&&100>e)return void App.ScrollTxtTips.showTip("小于最低限额100");var i=this.inName.text,o={type:this.optType,balance:e,password:this.moneyPwd.text};App.PromTipsView.show("是否确认转入金额"+e+"到"+i,function(){this.applyFunc(t.AgConst.AG_MoneyTrans,o)},function(){},this,!0),this.optMoney.text="",this.moneyPwd.text=""},i.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.passwordInput.text="",this.moneyPwd.text="",this.optMoney.text="",this.optType=1,Log.trace("this.optType",this.optType),this.removeBoneAnim(),App.EffectUtils.hideUI(this,200,0,function(){App.ViewManager.closeView(this)},this)},i.prototype.closePwdView=function(){this.pwdInput.visible=!1},i.prototype.refreshMoney=function(t){Log.trace("AgView 刷新金币",t),1==this.optType?this.outWallet.text=App.CommonUtils.money2Str(t.balance):2==this.optType&&(this.inWallet.text=App.CommonUtils.money2Str(t.balance))},i.prototype.removeBoneAnim=function(){this._mRoleAnim&&this._mRoleAnim.parent&&(this._mRoleAnim.stop(),this._mRoleAnim.parent.removeChild(this._mRoleAnim)),this._mButtonAnim&&this._mButtonAnim.parent&&(this._mButtonAnim.stop(),this._mButtonAnim.parent.removeChild(this._mButtonAnim))},i.prototype.switchWallet=function(){var t;t=this.outWallet.text;var e;e=this.outName.text,this.outWallet.text=this.inWallet.text,this.inWallet.text=t,this.outName.text=this.inName.text,this.inName.text=e,this.optMoney.text="",1==this.optType?(this.optType=2,this.agTips2.text="3.转出最小限额1元,无上限"):2==this.optType&&(this.optType=1,this.agTips2.text="3.转出最小限额100元-无上额"),Log.trace("this.optType",this.optType,this.outWallet.text)},i.prototype.destroy=function(){e.prototype.destroy.call(this),Log.trace("销魂Ag界面"),this._mRoleAnim&&(this._mRoleAnim.destroy(),this._mRoleAnim=void 0),this._mButtonAnim&&(this._mButtonAnim.destroy(),this._mButtonAnim=void 0),this.optType=void 0,App.MessageCenter.removeListener("UserMoneyChange",this.refreshMoney,this)},i}(BaseEuiView);t.AgView=e,__reflect(e.prototype,"lobby.AgView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.inits(),i.addListeners(),i.initFunc(),i.bankView=new t.BankView(i,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.Bank,i.bankView),Log.trace("注册银行"),i}return __extends(i,e),i.prototype.inits=function(){e.prototype.inits.call(this),this.bankModel=new t.BankModel(this),this.bankProxy=new t.BankProxy(this,this.bankModel)},i.prototype.initFunc=function(){this.registerFunc("saveMoney",this.onSaveMonye,this),this.registerFunc("takeMoney",this.onTakeMonye,this),this.registerFunc("setMoneyPwd",this.onSetMoneyPwd,this)},i.prototype.onSaveMonye=function(t){this.bankProxy.saveMoney(t)},i.prototype.onTakeMonye=function(t){this.bankProxy.takeMoney(t)},i.prototype.onSetMoneyPwd=function(t){this.bankProxy.setMoneyPwd(t)},i.prototype.addListeners=function(){e.prototype.addListeners.call(this),this.bankProxy.addEvent()},i.prototype.removeListeners=function(){this.bankProxy.removeEvent()},Object.defineProperty(i.prototype,"model",{get:function(){return this.bankModel},enumerable:!0,configurable:!0}),i.prototype.destroy=function(){e.prototype.destroy.call(this),this.bankView.destroy(),this.bankModel.destroy(),this.bankProxy.destroy(),this.bankView=void 0,this.bankModel=void 0,this.bankProxy=void 0},i}(BaseController);t.BankController=e,__reflect(e.prototype,"lobby.BankController")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.skinName="resource/lobby/skins/BankSkin.exml",o}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.pwdInput.visible=!1;var e=GamePlayerMgr.i.getPlayer();this.currMoneyTxt.text=""+App.CommonUtils.money2Str(e.getMoney()),this.savedMoneyTxt.text=""+App.CommonUtils.money2Str(e.getSafeMoney()),this.tabSaveBtn.setImage("bankTab_save_sel","bankTab_save_nor"),this.tabTakeBtn.setImage("bankTab_take_sel","bankTab_take_nor"),this.tabSaveBtn.selected=!0,this.tabSaveBtn.touchEnabled=!this.tabSaveBtn.selected,this.tabTakeBtn.touchEnabled=!this.tabTakeBtn.selected,this.optType=2,GamePlayerMgr.i.getPlayer().getIsPwdSeted()||(this.tipTxt.text="请设置资金密码",this.pwdInput.visible=!0),this.moneySlider.track.mask=this.moneySlider.trackHighlight},e.prototype.addEvent=function(){t.prototype.addEvent.call(this);var e;for(var i in this.numBtnGroup1.$children)e=this.numBtnGroup1.$children[i],App.CommonUtils.effectButton(e,this.numBtnOnClick,this,{name:e.name});for(var i in this.numBtnGroup2.$children)e=this.numBtnGroup2.$children[i],App.CommonUtils.effectButton(e,this.pwdBtnOnClick,this,{name:e.name});App.CommonUtils.effectButton(this.closeBtn,this.close,this),App.CommonUtils.effectButton(this.clear,this.backOne,this),App.CommonUtils.effectButton(this.clearAll,this.clearInput,this),App.CommonUtils.effectButton(this.saveIn,this.onOptClick,this),App.CommonUtils.effectButton(this.takeOut,this.onOptClick,this),App.CommonUtils.effectButton(this.pwdCloseBtn,this.closePwdView,this),App.CommonUtils.effectButton(this.passwordClear,this.pwdBackOne,this),App.CommonUtils.effectButton(this.passwordClearAll,this.clearPwdInput,this),App.CommonUtils.effectButton(this.passwordConfirm,this.confirmOpt,this),App.CommonUtils.effectButton(this.maxBtn,this.onClickMax,this),this.tabTakeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.tabSaveBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.moneySlider.addEventListener(eui.UIEvent.CHANGE,this.onChangeMoney,this),App.MessageCenter.addListener("UserMoneyChange",this.refreshMoney,this),App.MessageCenter.addListener("onSetMoneyPwdBack",this.closePwdView,this)},e.prototype.removeEvent=function(){t.prototype.removeEvent.call(this);for(var e in this.numBtnGroup1.$children)App.CommonUtils.removeButton(this.numBtnGroup1.$children[e]);for(var e in this.numBtnGroup2.$children)App.CommonUtils.removeButton(this.numBtnGroup2.$children[e]);App.CommonUtils.removeButton(this.clear),App.CommonUtils.removeButton(this.clearAll),App.CommonUtils.removeButton(this.saveIn),App.CommonUtils.removeButton(this.takeOut),App.CommonUtils.removeButton(this.closeBtn),App.CommonUtils.removeButton(this.pwdCloseBtn),App.CommonUtils.removeButton(this.passwordClear),App.CommonUtils.removeButton(this.passwordClearAll),App.CommonUtils.removeButton(this.passwordConfirm),App.CommonUtils.removeButton(this.maxBtn),this.tabTakeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.tabSaveBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.moneySlider.removeEventListener(eui.UIEvent.CHANGE,this.onChangeMoney,this)},e.prototype.backOne=function(){Log.trace("退格"),this.saveMoneyInput.text=this.saveMoneyInput.text.slice(0,this.saveMoneyInput.text.length-1);var t=2==this.optType?Math.floor(Number(this.currMoneyTxt.text)):Math.floor(Number(this.savedMoneyTxt.text));this.moneySlider.value=Math.floor(Number(this.saveMoneyInput.text)/t*100),this.moneySlider.value<1&&(this.moneySlider.value=1),""==this.saveMoneyInput.text&&(this.moneySlider.value=0),this.percentage.text="("+this.moneySlider.value+"%)",R.sendPlayerAction("Lobbysafe_smallclear")},e.prototype.pwdBackOne=function(){Log.trace("密码退格"),this.passwordInput.text=this.passwordInput.text.slice(0,this.passwordInput.text.length-1)},e.prototype.clearInput=function(){this.resetData(),R.sendPlayerAction("Lobbysafe_bigclear")},e.prototype.clearPwdInput=function(){this.passwordInput.text=""},e.prototype.onOptClick=function(){return this.saveMoneyInput.text&&"0"!=this.saveMoneyInput.text?(this.pwdInput.visible=!0,this.tipTxt.text="请输入资金密码",void(1==this.optType?R.sendPlayerAction("Lobbysafe_buttontakeout"):R.sendPlayerAction("Lobbysafe_buttonstore"))):void App.ScrollTxtTips.showTip("请输入金额")},e.prototype.takeOnClick=function(t){Log.trace("点击取出"+Number(this.saveMoneyInput.text)),this.pwdInput.visible=!0,this.tipTxt.text="请输入资金密码"},e.prototype.switchTab=function(t){t.currentTarget==this.tabTakeBtn&&!this.takeOut.visible&&this.tabTakeBtn.touchEnabled?(this.tabSaveBtn.selected=!1,this.takeOut.visible=!0,this.saveIn.visible=!1,this.tabTakeBtn.touchEnabled=!this.tabTakeBtn.selected,this.tabSaveBtn.touchEnabled=!this.tabSaveBtn.selected,this.curryMoneyTypeTxt.text="输入取款",this.clearInput(),this.optType=1,R.sendPlayerAction("Lobbysafe_clicktakeout")):t.currentTarget==this.tabSaveBtn&&!this.saveIn.visible&&this.tabSaveBtn.touchEnabled&&(this.tabTakeBtn.selected=!1,this.takeOut.visible=!1,this.saveIn.visible=!0,this.tabTakeBtn.touchEnabled=!this.tabTakeBtn.selected,this.tabSaveBtn.touchEnabled=!this.tabSaveBtn.selected,this.curryMoneyTypeTxt.text="输入存款",this.clearInput(),this.optType=2,R.sendPlayerAction("Lobbysafe_clickstore"))},e.prototype.numBtnOnClick=function(t){this.saveMoneyInput.text.length>0&&"0"==this.saveMoneyInput.text.substr(0,1)&&(this.saveMoneyInput.text=this.saveMoneyInput.text.slice(1));var e=2==this.optType?Math.floor(Number(this.currMoneyTxt.text)):Math.floor(Number(this.savedMoneyTxt.text));return Number(this.saveMoneyInput.text+t.name)>=e?(App.ScrollTxtTips.showTip("已到达最大值"),this.saveMoneyInput.text=e+"",this.percentage.text="(100%)",void(this.moneySlider.value=100)):void(t&&this.saveMoneyInput.text.length<9&&(this.saveMoneyInput.text=this.saveMoneyInput.text+t.name,this.moneySlider.value=Math.floor(Number(this.saveMoneyInput.text)/e*100),this.moneySlider.value<1&&"0"!=this.saveMoneyInput.text&&(this.moneySlider.value=1),this.percentage.text="("+this.moneySlider.value+"%)"))},e.prototype.pwdBtnOnClick=function(t){t&&this.passwordInput.text.length<6&&(this.passwordInput.text=this.passwordInput.text+t.name)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),App.EffectUtils.showUI(this);var o=GamePlayerMgr.i.getPlayer();this.savedMoneyTxt.text=""+App.CommonUtils.money2Str(o.getSafeMoney()),this.currMoneyTxt.text=""+App.CommonUtils.money2Str(o.getMoney())},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;App.EffectUtils.hideUI(this,200,0,function(){i.closeView(t)})},e.prototype.confirmOpt=function(){if(6!=this.passwordInput.text.length)return Log.trace("this.passwordInput.text.length",this.passwordInput.text.length),void App.ScrollTxtTips.showTip("请输入6位数字的资金密码");if(!GamePlayerMgr.i.getPlayer().getIsPwdSeted()){var t={token:GamePlayerMgr.i.getPlayer().getToken(),password:this.passwordInput.text};return void this.applyFunc("setMoneyPwd",t)}if(1==this.optType){var t={token:GamePlayerMgr.i.getPlayer().getToken(),money:App.CommonUtils.moneyC2S(Number(this.saveMoneyInput.text)),password:this.passwordInput.text};this.applyFunc("takeMoney",t)}else if(2==this.optType){var t={token:GamePlayerMgr.i.getPlayer().getToken(),money:App.CommonUtils.moneyC2S(Number(this.saveMoneyInput.text)),password:this.passwordInput.text};this.applyFunc("saveMoney",t)}this.passwordInput.text=""},e.prototype.refreshMoney=function(t){Log.trace("BankView 刷新金币",t),this.resetData(),this.currMoneyTxt.text=App.CommonUtils.money2Str(t.balance),(t.deposit||0==t.deposit)&&(this.savedMoneyTxt.text=App.CommonUtils.money2Str(t.deposit)),this.pwdInput.visible=!1},e.prototype.onClickMax=function(){var t=2==this.optType?Math.floor(Number(this.currMoneyTxt.text)):Math.floor(Number(this.savedMoneyTxt.text));this.saveMoneyInput.text=t+"",this.moneySlider.value=100,this.percentage.text="(100%)"},e.prototype.onChangeMoney=function(t){var e=2==this.optType?Math.floor(Number(this.currMoneyTxt.text)):Math.floor(Number(this.savedMoneyTxt.text));t.currentTarget==this.saveMoneyInput&&(Log.trace("数值改变",Number(this.saveMoneyInput.text)),Number(this.saveMoneyInput.text)>=e&&(this.saveMoneyInput.text=e+"")),this.percentage.text="("+this.moneySlider.value+"%)",this.saveMoneyInput.text=e*this.moneySlider.value/100+""},e.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.clearInput(),this.passwordInput.text="",App.ViewManager.closeView(this)},e.prototype.closePwdView=function(){return this.resetData(),GamePlayerMgr.i.getPlayer().getIsPwdSeted()?void(this.pwdInput.visible=!1):void this.close()},e.prototype.resetData=function(){this.saveMoneyInput.text="",this.passwordInput.text="",this.moneySlider.value=0,this.percentage.text="(0%)"},e.prototype.destroy=function(){t.prototype.destroy.call(this),App.MessageCenter.removeListener("UserMoneyChange",this.refreshMoney,this),App.MessageCenter.removeListener("onSetMoneyPwdBack",this.closePwdView,this)},e}(BaseEuiView);t.BankView=e,__reflect(e.prototype,"lobby.BankView")}(lobby||(lobby={}));var BasePanelView=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.skinName="resource/lobby/skins/PanelSkin.exml",o}return __extends(e,t),e.prototype.setGroup=function(t,e){this.testGroup.width=t,this.testGroup.height=e},Object.defineProperty(e.prototype,"title",{get:function(){return this._text},set:function(t){this._text=t,this.titleText.text=this._text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(t){this._icon=t,this.iconDisplay&&(this.iconDisplay.source=this._icon)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"btn",{get:function(){return this._btn},set:function(t){this._btn=t,this.button&&(this.button.visible=!0,this.button.source=this._btn)},enumerable:!0,configurable:!0}),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.closeBtnOnClick,this)},e.prototype.initData=function(){t.prototype.initData.call(this)},e.prototype.closeBtnOnClick=function(t){App.ViewManager.closeView(this)},e}(BaseEuiView);__reflect(BasePanelView.prototype,"BasePanelView");var lobby;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.onLoadedData,e),e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&(this.icon.source=this.data.icon,this.title.text=this.data.title,this.dateLabel.text=this.data.date)},e.prototype.onLoadedData=function(){Log.trace("初始化完成"+this.data),this.content.visible=!1,this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onLoadedData,this)},Object.defineProperty(e.prototype,"itemId",{get:function(){return this.data.id},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){},e}(eui.ItemRenderer);t.ActivityItemRender=e,__reflect(e.prototype,"lobby.ActivityItemRender")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(e){var i=t.call(this,"CarouselSkin")||this;return i._curIndex=1,i.adImgUrls=[],i.adImgArr=[],i.adSignArr=[],i.imgIndex=0,i.isMove=!0,i.isInit=!1,i.isCanTouch=!0,i.adUrls=[],i}return __extends(e,t),e.prototype.initUI=function(){this.adSpace.visible=!1},e.prototype.stopFrame=function(){this.ImgGroup.x=0,R.removeAllTimeOut(this),App.TimerManager.removeAll(this),egret.Tween.removeTweens(this)},e.prototype.startFrame=function(){this.ImgGroup.x=0,R.removeAllTimeOut(this),App.TimerManager.removeAll(this),egret.Tween.removeTweens(this),R.setTimeOnce(function(){this.bannerMove()}.bind(this),this,3e3)},e.prototype.onCreateAdSign=function(t){for(var e=0;t>e;e++){var i=new eui.Image;i.source="hall_ui_mark2",this.adSignArr.push(i),this.adSignGroup.addChild(i)}},e.prototype.onAdListBack=function(t){if(Log.trace("广告列表数据",t),t){var e=App.IsAppTest?"http://10.1.101.120:500/upload":GameBase.AssetsServerIp;t.forEach(function(t){var i=""+e+t.imgages_path;this.adImgUrls.push(i),this.adUrls.push(t.ad_url)}.bind(this)),this.renderOne(0,function(){this.adSpace.visible=!0,this.isInit=!0,this.setSignSource(),this.bannerMove()}.bind(this),this),App.TimerManager.doFrame(10,4,this.frameRender,this)}},e.prototype.onPrCodeAdress=function(t){if(this.prCodeAdress=t,""!=this.prCodeAdress){var e=this.ImgGroup.getChildByName("QRGroup");this.createQrCode(e)}},e.prototype.createQrCode=function(t){var e=qr.QRCode.create(this.prCodeAdress,107,107,16777215,3);e.x=155,e.y=13.5,t.addChild(e)},e.prototype.setSignSource=function(){this.adSignArr.length&&(this.adSignArr.forEach(function(t){t.source="hall_ui_mark2"}),this.adSignArr[this.imgIndex].source="hall_ui_mark1")},e.prototype.frameRender=function(){this._curIndex<this.adImgUrls.length?(this.renderOne(this._curIndex),this._curIndex++):App.TimerManager.remove(this.frameRender,this)},e.prototype.renderOne=function(t,e,i){var o=new ImageURL;if(o.x=277*t,o.y=0,o.width=277,o.height=156,o.fillMode=egret.BitmapFillMode.SCALE,o.load(this.adImgUrls[t],e,i),0==t){var n=new eui.Group;n.name="QRGroup",n.x=0,n.y=0,n.width=277,n.height=156,n.addChild(o),this.adImgArr.push(n),this.ImgGroup.addChild(n)}else this.adImgArr.push(o),this.ImgGroup.addChild(o)},e.prototype.bannerMove=function(){this.adImgArr.length>1&&App.TimerManager.doTimer(3e3,0,this.frameMove,this)},e.prototype.frameMove=function(){this.isCanTouch=!1,this.imgIndex<this.adSignArr.length-1?this.imgIndex++:this.imgIndex=0,this.setSignSource(),egret.Tween.get(this.ImgGroup).to({x:-277},500).call(function(){var t=this.adImgArr.shift();this.adImgArr.push(t),this.updateImgPos(),this.ImgGroup.x=0,this.isCanTouch=!0}.bind(this))},e.prototype.updateImgPos=function(){this.adImgArr.forEach(function(t,e){t.x=277*e,t.y=0}.bind(this))},e.prototype.handMove=function(t){if(this.isCanTouch)switch(this.isCanTouch=!1,t){case"adLeftArrow":this.moveSignLeft();var e=this.adImgArr.pop();this.adImgArr.unshift(e),this.updateImgPos(),this.ImgGroup.x=-277,egret.Tween.get(this.ImgGroup).to({x:0},500).call(function(){this.isCanTouch=!0,R.setTimeOnce(function(){this.bannerMove()}.bind(this),this,3e3)}.bind(this));break;case"adRightArrow":this.moveSignRight(),egret.Tween.get(this.ImgGroup).to({x:-277},500).call(function(){this.isCanTouch=!0;var t=this.adImgArr.shift();this.adImgArr.push(t),this.updateImgPos(),this.ImgGroup.x=0,R.setTimeOnce(function(){this.bannerMove()}.bind(this),this,3e3)}.bind(this))}},e.prototype.onAdArrowClick=function(t){this.isInit&&(R.removeAllTimeOut(this),App.TimerManager.remove(this.frameMove,this),this.adLeftArrow.alpha=1,this.adRightArrow.alpha=1,this.handMove(t.name))},e.prototype.clearImg=function(){for(;this.adImgArr.length;){var t=this.adImgArr.pop();t.destroy()}},e.prototype.moveSignLeft=function(){this.imgIndex>0?this.imgIndex--:this.imgIndex=this.adSignArr.length-1,this.setSignSource()},e.prototype.moveSignRight=function(){this.imgIndex<this.adSignArr.length-1?this.imgIndex++:this.imgIndex=0,this.setSignSource()},e.prototype.onTouchBegin=function(t){if(Log.log(t.localX),this.isCanTouch){this.startX=t.localX,this.beginX=t.localX,R.removeAllTimeOut(this),App.TimerManager.remove(this.frameMove,this);var e=this.adImgArr.pop();this.adImgArr.unshift(e),this.updateImgPos(),this.ImgGroup.x=-277}},e.prototype.onTouchMove=function(t){if(this.startX&&this.isCanTouch){var e=t.localX-this.beginX;this.beginX=t.localX,this.ImgGroup.x+=e}},e.prototype.onTouchEnd=function(t){if(this.startX&&this.isCanTouch){this.isCanTouch=!1;var e=t.localX-this.startX;if(e>2)this.moveSignLeft(),egret.Tween.get(this.ImgGroup).to({x:0},500).call(function(){this.isCanTouch=!0,this.startX=void 0}.bind(this));else if(-2>e)this.moveSignRight(),egret.Tween.get(this.ImgGroup).to({x:-554},500).call(function(){var t=this.adImgArr.shift();this.adImgArr.push(t);var e=this.adImgArr.shift();this.adImgArr.push(e),this.updateImgPos(),this.ImgGroup.x=0,this.isCanTouch=!0,this.startX=void 0}.bind(this));else{var i=this.adImgArr.shift();this.adImgArr.push(i),this.updateImgPos(),this.ImgGroup.x=0;var o=this.adUrls[this.imgIndex];this.isCanTouch=!0,this.startX=void 0,R.openUrlOutside(o),Log.log("open url:",o)
}R.setTimeOnce(function(){this.bannerMove()}.bind(this),this,3e3)}},e.prototype.onOutSide=function(t){this.startX&&this.isCanTouch&&(this.isCanTouch=!1,t.localX>this.startX?(this.imgIndex>0?this.imgIndex--:this.imgIndex=this.adSignArr.length-1,this.setSignSource(),egret.Tween.get(this.ImgGroup).to({x:0},500).call(function(){this.isCanTouch=!0,this.startX=void 0}.bind(this))):(this.moveSignRight(),egret.Tween.get(this.ImgGroup).to({x:-554},500).call(function(){var t=this.adImgArr.shift();this.adImgArr.push(t);var e=this.adImgArr.shift();this.adImgArr.push(e),this.updateImgPos(),this.ImgGroup.x=0,this.isCanTouch=!0,this.startX=void 0}.bind(this))),R.setTimeOnce(function(){this.bannerMove()}.bind(this),this,3e3))},e.prototype.addEvent=function(){App.MessageCenter.addListener(GameConsEvent.Game_ADListInfo,this.onAdListBack,this),App.MessageCenter.addListener(GameConsEvent.Game_prCodeAdress,this.onPrCodeAdress,this),App.MessageCenter.addListener("createAdSign",this.onCreateAdSign,this),App.CommonUtils.effectButton(this.adLeftArrow,this.onAdArrowClick,this,{name:"adLeftArrow"}),App.CommonUtils.effectButton(this.adRightArrow,this.onAdArrowClick,this,{name:"adRightArrow"}),this.adTrigger.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.adTrigger.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.adTrigger.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.adTrigger.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onOutSide,this)},e.prototype.removeEvent=function(){App.MessageCenter.removeAll(this),App.CommonUtils.removeButton(this.adLeftArrow),App.CommonUtils.removeButton(this.adRightArrow),this.adTrigger.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.adTrigger.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.adTrigger.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.adTrigger.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onOutSide,this)},e.prototype.destroy=function(){this.clearImg(),R.removeAllTimeOut(this),App.TimerManager.removeAll(this)},e}(BaseEuiComponent);t.Carousel=e,__reflect(e.prototype,"lobby.Carousel")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.icon&&(this.headImg.touchEnabled=!0,1==this.data.type&&(this.headImg.source=this.data.icon,this.headImg.visible=!0,this.headImgBox.touchEnabled=!1),2==this.data.type&&(this.headImgBox.source=this.data.icon,this.headImg.visible=!1,this.headImgBox.touchEnabled=!0),this.refreshSign())},e.prototype.refreshSign=function(){this.sign.visible=this.data.isSelected},e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i),this.data&&i==this.headImg&&(this.headImg.source=this.data.icon)},e}(eui.ItemRenderer);t.HeadImgItemRenderer=e,__reflect(e.prototype,"lobby.HeadImgItemRenderer")}(lobby||(lobby={}));var IconView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(eui.Button);__reflect(IconView.prototype,"IconView");var lobby;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.onLoadedData,e),e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&(this.dateLabel.text=this.data.date,this.title.text=this.data.title,this.label.selected=this.data.is_readed,this.icon.selected=this.data.is_readed)},e.prototype.refeshSign=function(t){this.label.selected=t,this.icon.selected=t},e.prototype.onLoadedData=function(){this.item_bg&&(this.item_bg.touchEnabled=!0),this.label&&(this.label.touchEnabled=!1,this.label.setUnSelected("message_check",113,41),this.label.setInSelected("message_checked",79,80)),this.icon&&(this.icon.touchEnabled=!1,this.icon.setImage("message_mail_iconClose","message_mail_iconOpen"),this.icon.setInSelected("",72,68),this.icon.setUnSelected("",72,68)),this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.onLoadedData,this)},e.prototype.showMessage=function(t){App.ViewManager.open(LobbyViewConst.MessagePrompt,LayerManager.UI_Tips)},Object.defineProperty(e.prototype,"itemId",{get:function(){return this.data.id},enumerable:!0,configurable:!0}),e}(eui.ItemRenderer);t.MessageItemRender=e,__reflect(e.prototype,"lobby.MessageItemRender")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/lobby/skins/component/OtherButtonSkin.exml",e.name="share",e}return __extends(e,t),e.prototype.setBtnBg=function(t,e,i){this.btnBg.source=t,e&&(this.btnBg.width=e),i&&(this.btnBg.height=i)},e.prototype.setIcon=function(t,e,i){this.iconDisplay.source=t,e&&(this.btnBg.width=e),i&&(this.btnBg.height=i)},e.prototype.setClick=function(t){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClickEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onClickCancelEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onClickConfirmEvent,this),this.onClick=t},e.prototype.onClickEvent=function(t){var e=(t.currentTarget.width-.8*t.currentTarget.width)/2,i=(t.currentTarget.height-.8*t.currentTarget.height)/2;t.currentTarget.tw=egret.Tween.get(t.currentTarget),t.currentTarget.tw.to({scaleX:.8,scaleY:.8,x:e,y:i},40)},e.prototype.onClickCancelEvent=function(t){(t.currentTarget.width-.8*t.currentTarget.width)/2,(t.currentTarget.height-.8*t.currentTarget.height)/2;t.currentTarget.tw=egret.Tween.get(t.currentTarget),t.currentTarget.tw.to({scaleX:1,scaleY:1,x:1,y:1},40)},e.prototype.onClickConfirmEvent=function(t){(t.currentTarget.width-.8*t.currentTarget.width)/2,(t.currentTarget.height-.8*t.currentTarget.height)/2;t.currentTarget.tw=egret.Tween.get(t.currentTarget),t.currentTarget.tw.to({scaleX:1,scaleY:1,x:1,y:1},40).call(this.onClickHandler,this,[t.currentTarget])},e.prototype.onClickHandler=function(t){this.onClick(t)},e.prototype.setArg=function(t){this.tempArg=t},e}(eui.Component);t.OtherButton=e,__reflect(e.prototype,"lobby.OtherButton")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="BankButtonSkin",e.unSelectedCText.visible=!1,e.SelectedCText.visible=!1,e}return __extends(e,t),e.prototype.setImageBg=function(t,e){this.inSelected.width=t,this.unSelected.width=t-14,this.inSelected.height=null!=e?e:70,this.unSelected.height=null!=e?e:70},e.prototype.setImage=function(t,e,i,o,n,s){t&&(this.txt_inSelected.source=t),e&&(this.txt_unSelected.source=e),i&&(this.txt_inSelected.width=i,this.txt_unSelected.width=i),o&&(this.txt_inSelected.height=o,this.txt_unSelected.height=o),n&&(this.txt_inSelected.x=n,this.txt_unSelected.x=n),s&&(this.txt_inSelected.y=s,this.txt_unSelected.y=s)},e.prototype.setUnSelected=function(t,e,i){this.unSelected.source=t,this.unSelected.width=e,this.unSelected.height=i},e.prototype.setInSelected=function(t,e,i){this.inSelected.source=t,this.inSelected.width=e,this.inSelected.height=i},e.prototype.setContentText=function(t){this.unSelectedCText.visible=!0,this.SelectedCText.visible=!0,this.unSelectedCText.text=t,this.SelectedCText.text=t},e.prototype.setName=function(t){this.name=t},e}(eui.ToggleButton);t.OtherToggle=e,__reflect(e.prototype,"lobby.OtherToggle")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){var e=t.call(this,null)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.updateRes("AgButton")},e.prototype.updateRes=function(t){this.initDBRes(t),this.armature=this.createArmature("Armature",t,e._mActionList)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.play=function(){this.armature.play(e.Animation,999999999)},e.prototype.stop=function(){this.armature.stop()},e.prototype.clean=function(){t.prototype.clean.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.armature=void 0},e.Animation="play",e._mActionList=[e.Animation],e}(base.BaseGameObject);t.AgButtonBone=e,__reflect(e.prototype,"lobby.AgButtonBone")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){var e=t.call(this,null)||this;return e.init(),e.touchEnabled=!0,e.touchChildren=!1,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.updateRes("jiantou")},e.prototype.updateRes=function(t){this.initDBRes(t),this.armature=this.createArmature("Armature",t,e._mActionList)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.play=function(){this.armature.play(e.Animation,999999999)},e.prototype.stop=function(){this.armature.stop()},e.prototype.clean=function(){t.prototype.clean.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.armature=void 0},e.Animation="newAnimation",e._mActionList=[e.Animation],e}(base.BaseGameObject);t.EntryArrowBone=e,__reflect(e.prototype,"lobby.EntryArrowBone")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){var e=t.call(this,null)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.updateRes("RechargeAnim")},e.prototype.updateRes=function(t){this.initDBRes(t),this.armature=this.createArmature("Armature",t,e._mActionList)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.play=function(){this.armature.play(e.Animation,999999999)},e.prototype.clean=function(){t.prototype.clean.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.armature=void 0},e.Animation="RechargeAnim",e._mActionList=[e.Animation],e}(base.BaseGameObject);t.RechargeBtnBone=e,__reflect(e.prototype,"lobby.RechargeBtnBone")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){var e=t.call(this,null)||this;return e.init(),e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.updateRes("rabbitgirl")},e.prototype.updateRes=function(t){this.initDBRes(t),this.armature=this.createArmature("Armature",t,e._mActionList),this.armature.scaleX=this.armature.scaleY=.58},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.setScale=function(t){this.armature.scaleX=this.armature.scaleY=t},e.prototype.play=function(){this.armature.play(e.Animation,999999999)},e.prototype.stop=function(){this.armature.stop()},e.prototype.clean=function(){t.prototype.clean.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.armature=void 0},e.Animation="newAnimation",e._mActionList=[e.Animation],e}(base.BaseGameObject);t.RoleRabbitgirl=e,__reflect(e.prototype,"lobby.RoleRabbitgirl")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){var e=t.call(this,null)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.updateRes("UpToMemberAnim")},e.prototype.updateRes=function(t){this.initDBRes(t),this.armature=this.createArmature("Armature",t,e._mActionList)},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.play=function(){this.armature.play(e.Animation,999999999)},e.prototype.clean=function(){t.prototype.clean.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.armature=void 0},e.Animation="UpToMemberAnim",e._mActionList=[e.Animation],e}(base.BaseGameObject);t.UpToMemberBtnBone=e,__reflect(e.prototype,"lobby.UpToMemberBtnBone")}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function t(){}return t.CustomerSendMsg=2009e3,t}();t.CustomerConst=e,__reflect(e.prototype,"lobby.CustomerConst")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.inits(),t.registers(),t.addListeners(),t}return __extends(i,e),i.prototype.inits=function(){e.prototype.inits.call(this),this.customerModel=new t.CustomerModel(this),this.customerProxy=new t.CustomerProxy(this,this.customerModel),this.customerView=new t.CustomerView(this,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.Customer,this.customerView),this.setModel(this.customerModel)},i.prototype.registers=function(){e.prototype.registers.call(this),this.registerFunc(t.CustomerConst.CustomerSendMsg,this.onSendMsg,this)},i.prototype.addListeners=function(){e.prototype.addListeners.call(this),this.customerProxy.addEvent()},i.prototype.removeListeners=function(){e.prototype.removeListeners.call(this),this.customerProxy.removeEvent()},Object.defineProperty(i.prototype,"model",{get:function(){return this.customerModel},enumerable:!0,configurable:!0}),i.prototype.onSendMsg=function(t){this.customerProxy.customerSendMsgReq(t)},i.prototype.destroy=function(){e.prototype.destroy.call(this),this.customerView.destroy(),this.customerProxy.destroy(),this.customerModel.destroy(),this.customerView=void 0,this.customerProxy=void 0,this.customerModel=void 0},i}(BaseController);t.CustomerController=e,__reflect(e.prototype,"lobby.CustomerController")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){var o=e.call(this,t,i)||this;return o.skinName="resource/lobby/skins/CustomerSkin.exml",o}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.onlineCustomer.selected=!0,this.onlineCustomer.touchEnabled=!1,this.strBase64=""},i.prototype.addEvent=function(){e.prototype.addEvent.call(this),App.CommonUtils.effectButton(this.sendMsg,this.onSendMsgToCustomer,this),App.CommonUtils.effectButton(this.closeBtn,this.close,this),App.CommonUtils.effectButton(this.addImg,this.checkImgToCustomer,this),this.onlineCustomer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toggleChangeHandler,this),this.question.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toggleChangeHandler,this),this.msgInput.addEventListener(eui.UIEvent.CHANGE,this.checkMsgInput,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),App.CommonUtils.removeButton(this.sendMsg),App.CommonUtils.removeButton(this.closeBtn),App.CommonUtils.removeButton(this.addImg),this.onlineCustomer.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.toggleChangeHandler,this),this.question.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.toggleChangeHandler,this),this.msgInput.removeEventListener(eui.UIEvent.CHANGE,this.checkMsgInput,this)},i.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.prototype.open.call(this,t),App.EffectUtils.showUI(this)},i.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;App.EffectUtils.hideUI(this,200,0,function(){i.closeView(t)})},i.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];App.ViewManager.closeView(this)},i.prototype.toggleChangeHandler=function(t){switch(t.currentTarget){case this.onlineCustomer:this.onlineCustomer.touchEnabled=!1,this.onlineCustomer.selected=!0,this.question.selected=!1,this.question.touchEnabled=!0;break;case this.question:this.onlineCustomer.touchEnabled=!0,this.onlineCustomer.selected=!1,this.question.selected=!0,this.question.touchEnabled=!1}},i.prototype.checkImgToCustomer=function(){App.ScrollTxtTips.showTip("敬请期待！")},i.prototype.checkMsgInput=function(){this.msgInput.text.length>52&&App.ScrollTxtTips.showTip("输入的问题描述内容最大长度为50")},i.prototype.onSendMsgToCustomer=function(){if(this.msgInput.text.length<5)return void App.ScrollTxtTips.showTip("您输入的问题描述内容过短，请重新输入");var e={text:this.msgInput.text,attachment:this.strBase64,attach_fmt:1};this.applyFunc(t.CustomerConst.CustomerSendMsg,e)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseEuiView);t.CustomerView=e,__reflect(e.prototype,"lobby.CustomerView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function t(){}return t.ExchangeReq=2007e3,t.BindBankCardListReq=2007001,t.BindBankCardReq=2007002,t.UnBindBankCardReq=2007003,t}();t.ExchangeConst=e,__reflect(e.prototype,"lobby.ExchangeConst")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.inits(),t.registers(),t.addListeners(),t}return __extends(i,e),i.prototype.inits=function(){e.prototype.inits.call(this),this.exchangeModel=new t.ExchangeModel(this),this.exchangeProxy=new t.ExchangeProxy(this,this.exchangeModel),this.exchangeView=new t.ExchangeView(this,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.Exchange,this.exchangeView),this.setModel(this.exchangeModel)},i.prototype.registers=function(){e.prototype.registers.call(this),this.registerFunc(t.ExchangeConst.ExchangeReq,this.onExchangeReq,this),this.registerFunc(t.ExchangeConst.BindBankCardListReq,this.onBindBankCardListReq,this),this.registerFunc(t.ExchangeConst.BindBankCardReq,this.onBindBankCardReq,this),this.registerFunc(t.ExchangeConst.UnBindBankCardReq,this.onUnBindBankCardReq,this)},i.prototype.onExchangeReq=function(t){this.exchangeProxy.exchangeReq(t)},i.prototype.onBindBankCardListReq=function(t){this.exchangeProxy.bindBankCardListReq(t)},i.prototype.onBindBankCardReq=function(t){this.exchangeProxy.bindBankCardReq(t)},i.prototype.onUnBindBankCardReq=function(t){this.exchangeProxy.unBindBankCardReq(t)},i.prototype.addListeners=function(){e.prototype.addListeners.call(this),this.exchangeProxy.addEvent()},i.prototype.removeListeners=function(){e.prototype.removeListeners.call(this),this.exchangeProxy.removeEvent()},Object.defineProperty(i.prototype,"model",{get:function(){return this.exchangeModel},enumerable:!0,configurable:!0}),i.prototype.destroy=function(){e.prototype.destroy.call(this),this.exchangeView.destroy(),this.exchangeProxy.destroy(),this.exchangeModel.destroy(),this.exchangeView=void 0,this.exchangeProxy=void 0,this.exchangeModel=void 0},i}(BaseController);t.ExchangeController=e,__reflect(e.prototype,"lobby.ExchangeController")}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function t(){}return t}();t.LobbyEvent=e,__reflect(e.prototype,"lobby.LobbyEvent")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(){var i=t.call(this,"EntryOGameSkin")||this;return i._mCurrIconX=e.IconSpaceX/2+20,i._mCurrIconY=0,i.mIconListObj={},i._mAmuInited=!1,i}return __extends(e,t),e.prototype.initComponent=function(e,i){t.prototype.initComponent.call(this,e,i),this.initEntrys()},e.prototype.initEntrys=function(){var t=GameModuleMgr.i.gameCfgList;this._mCurrIconY=t[0].isResBig?.5*this.height:.25*this.height;for(var e=0;e<t.length;e++)this.createIcon(t[e],t[e+1]);R.setTimeOutOnly(function(){this._mAmuInited=!0}.bind(this),this,2e3)},e.prototype.createIcon=function(t,o){var n=new i(t);n.init(),n.setPosition(this._mCurrIconX+t.fixX,this._mCurrIconY+t.fixY),this.addChild(n),n.play(),this.mIconListObj[t.key]=n,o&&(t.isResBig||this._mCurrIconY>=.75*this.height||o.isResBig?(this._mCurrIconX+=e.IconSpaceX,this._mCurrIconX+e.IconSpaceX/2+20,this._mCurrIconY=o.isResBig?.5*this.height:.25*this.height):t.isResBig||(this._mCurrIconY=.75*this.height));var s=n.x+e.IconSpaceX/2+20;this.width<s&&(this.width=s)},e.prototype.refresh=function(){if(this._mAmuInited){var t=this.mIconListObj,i=this.parent,o=i.parent.$x,n=i.parent.viewport.width,s=egret.Point.create(0,0),r=!1,a=!1;for(var h in t){var p=t[h];i.localToGlobal(p.x,p.y,s),r=s.x-o+e.IconSpaceX/2<0,a=s.x-o-e.IconSpaceX/2>n,r||a?p.parent&&(this.removeChild(p),p.stop()):p.parent||(this.addChild(p),p.play())}egret.Point.release(s)}},e.prototype.addEvent=function(){t.prototype.addEvent.call(this),App.MessageCenter.addListener(GameUpdateEvent.Update_Game_Module_Progress,this.updateProgress,this),App.MessageCenter.addListener(GameUpdateEvent.Update_Game_Module_Complete,this.updateOver,this)},e.prototype.removeEvent=function(){t.prototype.removeEvent.call(this),App.MessageCenter.removeListener(GameUpdateEvent.Update_Game_Module_Progress,this.updateProgress,this),App.MessageCenter.removeListener(GameUpdateEvent.Update_Game_Module_Complete,this.updateOver,this)},e.prototype.updateOver=function(t){Log.log(t,"更新完成! updateOver");var e=this.mIconListObj[t];e.updateOver()},e.prototype.updateProgress=function(t){var e=this.mIconListObj[t.gameName];e&&e.updateProgress(t.progress,t.total)},e.prototype.destroy=function(){t.prototype.destroy.call(this);var e=this.mIconListObj;for(var i in e)e[i].destroy(),e[i]=void 0,delete e[i];this.mIconListObj=void 0},e.IconSpaceX=280,e}(BaseEuiComponent);t.EntryOGamesView=e,__reflect(e.prototype,"lobby.EntryOGamesView");var i=function(e){function i(t){var i=e.call(this,null)||this;return i._mIsPlayed=!1,i._mIconCfg=t,i}return __extends(i,e),i.prototype.init=function(){e.prototype.init.call(this),this.touchEnabled=!0,this.touchChildren=!1,this.updateRes(this._mIconCfg.gameIconAnim),this.addEvent(),HotUpdateMgr.getInstance().checkGameUpdate(this._mIconCfg.key)&&this.showTips()},i.prototype.updateRes=function(t){this.initDBRes(t),this.armature=this.createArmature("Armature",t,i._mActionList);var e=(this._mIconCfg.isResBig,.6);this.armature.scaleX=e+this._mIconCfg.fixSX,this.armature.scaleY=e+this._mIconCfg.fixSY,this._mIconCfg.isOpen||(this._mIsOpenTips=new eui.Image,this.addChild(this._mIsOpenTips),this._mIsOpenTips.visible=!0,this._mIsOpenTips.source="lobby_lock_png",this._mIconCfg.isResBig?(this._mIsOpenTips.width=270,this._mIsOpenTips.height=465,this._mIsOpenTips.x=this._mIsOpenTips.x-130,this._mIsOpenTips.y=this._mIsOpenTips.y-230-this._mIconCfg.fixY):(this._mIsOpenTips.width=220,this._mIsOpenTips.height=210,this._mIsOpenTips.x=this._mIsOpenTips.x-105,this._mIsOpenTips.y=this._mIsOpenTips.y-105-this._mIconCfg.fixY))},i.prototype.showTips=function(){this._mUpdateTips||(this._mUpdateTips=new eui.Image,this.addChild(this._mUpdateTips)),this._mUpdateTips.visible=!0,this._mUpdateTips.x=(this._mIconCfg.isResBig?35:18)+3,this._mUpdateTips.y=(this._mIconCfg.isResBig?-232:-116)-2,this._mUpdateTips.source="hall_dianjigengx_png"},i.prototype.showBar=function(){this._mProgressBar||(this._mProgressBar=new eui.Component,this._mProgressBar.skinName="EntryOProgressSkin",this.addChild(this._mProgressBar)),this._mUpdateTips.visible=!1,this._mProgressBar.x=-this._mProgressBar.width/2,this._mProgressBar.y=(this._mIconCfg.isResBig?228:116)-55,this._mProgressBar.progressGg.visible=!1},i.prototype.updateProgress=function(t,e){this._mProgressBar||this.showBar();var o=this._mProgressBar.progressBar,n=this._mProgressBar.progressGg;this._mProgressBar.visible=!0,i.mMaxPro<0&&(i.mMaxPro=o.width);var s=t/e,r=t/e*i.mMaxPro;i.mRectMask.width=r,o.mask=i.mRectMask,n.visible=s>.06&&.939>s,n.visible&&(n.x=3+r)},i.prototype.updateOver=function(){StatisticsAction.i.downloadGameOver(this._mIconCfg.key),this._mUpdateTips&&(this._mUpdateTips.visible=!1),this._mProgressBar&&(this._mProgressBar.visible=!1),GameBase.saveLocalData("GameLoaded_"+this._mIconCfg.key,"1")},i.prototype.setPosition=function(t,e){this.x=t,this.y=e},i.prototype.play=function(){this._mIsPlayed||(this._mIsPlayed=!0,this.armature.play(i.Animation,999999999))},i.prototype.stop=function(){this._mIsPlayed&&(this._mIsPlayed=!1,this.armature.stop())},i.prototype.onIconBegin=function(){var t=this._mIconCfg.isResBig?.98:.95;egret.Tween.get(this).to({scaleX:t,scaleY:t},80).to({scaleX:1,scaleY:1},80)},i.prototype.enterGame=function(){return Log.log("clickIcon:",this._mIconCfg.gameType,this._mIconCfg.key),this._mIconCfg.isOpen?void("hongbao"==this._mIconCfg.key?App.MessageCenter.dispatch(RedPacketConst.Open_View):"ag"==this._mIconCfg.key?App.MessageCenter.dispatch(t.AgConst.Open_View):this.gameIn()):void R.setTimeOutOnly(function(){App.ScrollTxtTips.showTip("敬请期待！")},this,150)},i.prototype.gameIn=function(){if(!this._mProgressBar||!this._mProgressBar.visible){var t=this._mIconCfg.key;HotUpdateMgr.getInstance().checkGameUpdate(t)?(this.showBar(),HotUpdateMgr.getInstance().loadGameUpdate(t),R.sendPlayerAction(i._tempEventName2[this._mIconCfg.gameType]),StatisticsAction.i.downloadGame(t)):GameModuleMgr.i.startGame(t),Log.log("maidian",i._tempEventName[this._mIconCfg.gameType]),R.sendPlayerAction(i._tempEventName[this._mIconCfg.gameType])}},i.prototype.clean=function(){e.prototype.clean.call(this)},i.prototype.addEvent=function(){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onIconBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.enterGame,this)},i.prototype.removeEvent=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onIconBegin,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.enterGame,this)},i.prototype.destroy=function(){e.prototype.destroy.call(this),this.removeEvent(),this.removeChildren(),this._mUpdateTips&&(this._mUpdateTips.source=void 0,this._mUpdateTips.$bitmapData=void 0,this._mUpdateTips=void 0),this._mProgressBar&&(this._mProgressBar.progressBar=void 0,this._mProgressBar.progressGg=void 0),this.armature=void 0,this._mIconCfg=void 0,this._mProgressBar=void 0},i.mRectMask=new egret.Rectangle(0,0,0,30),i.mMaxPro=-1,i.Animation="newAnimation",i._mActionList=[i.Animation],i._tempEventName={101:"Lobbyclick_Brnn",201:"Lobbyclick_Baccarat",301:"Lobbyclick_Hhdz",401:"Lobbyclick_DDZ",402:"Lobbyclick_DDZ",403:"Lobbyclick_DDZ",501:"Lobbyclick_Fish",502:"Lobbyclick_Fish",503:"Lobbyclick_Fish",601:"Lobbyclick_SHZ",701:"Lobbyclick_Fruit",801:"Lobbyclick_LHD",901:"Lobbyclick_FN",1001:"Lobbyloading_CN",1101:"Lobbyloading_QZNN",1102:"Lobbyloading_QZNN",1103:"Lobbyloading_QZNN",1104:"Lobbyloading_QZNN",1105:"Lobbyloading_QZNN"},i._tempEventName2={101:"Lobbyloading_Brnn",201:"Lobbyloading_Baccarat",301:"Lobbyloading_Hhdz",401:"Lobbyloading_DDZ",402:"Lobbyloading_DDZ",403:"Lobbyloading_DDZ",501:"Lobbyloading_Fish",502:"Lobbyloading_Fish",503:"Lobbyloading_Fish",601:"Lobbyloading_SHZ",701:"Lobbyloading_Fruit",801:"Lobbyloading_LHD",901:"Lobbyclick_FN",1001:"Lobbyloading_CN",1101:"Lobbyloading_QZNN",1102:"Lobbyloading_QZNN",1103:"Lobbyloading_QZNN",1104:"Lobbyloading_QZNN",1105:"Lobbyloading_QZNN"},i}(base.BaseGameObject);__reflect(i.prototype,"GameEntryIcon")}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function t(){}return t.ChangeHeadImg=40001,t.ChangeNickName=40002,t}();t.LobbyConst=e,__reflect(e.prototype,"lobby.LobbyConst")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){var o=e.call(this,t,i)||this;return o.adImgUrls=[],o.adImgArr=[],o._mIsOnThrow=!1,o._mThrowV=0,o.skinName="resource/lobby/skins/LobbySkin.exml",App.MessageCenter.addListener("UserMoneyChange",o.refreshMoney,o),o}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.Carousel.visible=!1,this.refreshSign(),this._mParticleLobbyBG=new BaseParticleObj,this._mParticleLobbyBG.init("lobby_bg"),this._mParticleLobbyBG.play(),this.addChild(this._mParticleLobbyBG),this._mRoleAnim=new t.RoleRabbitgirl,this._mRoleAnim.play(),this.hotGameAnim.addChild(this._mRoleAnim),this._mRechargeAnim=new t.RechargeBtnBone,this._mRechargeAnim.play(),this.rechargeAnim.addChild(this._mRechargeAnim),this._mUp2MemberAnimm=new t.UpToMemberBtnBone,this._mUp2MemberAnimm.play(),this.up2MemberAnim.addChild(this._mUp2MemberAnimm),this.uProclaim.init(this.getBaseController(),null,SceneConsts.Lobby),this.up2MemberAnim.visible=GamePlayerMgr.i.isVisiter,this.btnProxyEntrace.visible=GamePlayerMgr.i.getPlayer().mIsAgent,this.btnRedPacket2=RedPackBone.create(),this.btnRedPacket2.init(),this.addChild(this.btnRedPacket2),this.btnRedPacket2.x=45,this.up2MemberAnim.visible&&(this.btnRedPacket2.x=225),this.btnRedPacket2.y=140,this.btnRedPacket2.play(RedPackBone.Animation1),this.btnRedPacket2.touchEnabled=!0,this.gamesEntry.initComponent(this.getBaseController()),this.scrollerItem.viewport.scrollH=BridgeStatic.EntryIconViewScrollH,this.showArrowLeft(!1),this.showArrowRight(!1);var i=this;App.TimerManager.doTimer(200,5,function(){i.onScrollerChange()},this),App.OffsetLeft(this.leftBtnGroup),App.OffsetLeft(this.btnRedPacket2),this.checkIOS(),this.applyFunc("adListReq")},i.prototype.checkIOS=function(){this.uBtnVerdl.visible=!1},i.prototype.onDownloadVer=function(t){},i.prototype.showArrowLeft=function(e){void 0===e&&(e=!0),this._mArrowLeftAnim||(this._mArrowLeftAnim=new t.EntryArrowBone,this._mArrowLeftAnim.scaleX=-1,this.arrowLeft.addChild(this._mArrowLeftAnim)),e?this._mArrowLeftAnim.play():this._mArrowLeftAnim.stop(),this._mArrowLeftAnim.visible=e},i.prototype.showArrowRight=function(e){void 0===e&&(e=!0),this._mArrowRightAnim||(this._mArrowRightAnim=new t.EntryArrowBone,this.arrowRight.addChild(this._mArrowRightAnim)),e?this._mArrowRightAnim.play():this._mArrowRightAnim.stop(),this._mArrowRightAnim.visible=e},i.prototype.onScrollerChange=function(){var t=this.scrollerItem.viewport.scrollH;this.showArrowLeft(t>20),this.showArrowRight(t+this.scrollerItem.viewport.width<=this.gamesEntry.width-20),BridgeStatic.EntryIconViewScrollH=this.scrollerItem.viewport.scrollH,this.gamesEntry.refresh()},i.prototype.onArrowTap=function(t){t.currentTarget==this._mArrowLeftAnim?this.throwScroller(0):this.throwScroller(this.gamesEntry.width-this.scrollerItem.width)},i.prototype.throwScroller=function(t){this._mIsOnThrow=!0,this._mThrowV=t,App.TimerManager.doFrame(1,999999,this.updateThrowScroller,this)},i.prototype.updateThrowScroller=function(t){if(this._mIsOnThrow){var e=this.scrollerItem.viewport.scrollH,i=this._mThrowV-e,o=i>0?Math.min(500,i):Math.max(-500,i),n=.1*o*t/16;Math.abs(this._mThrowV-e)<5&&(this.stopThrowScroller(),this.onScrollerChange()),this.scrollerItem.viewport.scrollH+=n,this.gamesEntry.refresh()}},i.prototype.stopThrowScroller=function(){this._mIsOnThrow&&(App.TimerManager.remove(this.updateThrowScroller,this),this._mIsOnThrow=!1)},i.prototype.onScrollerBegin=function(){this.stopThrowScroller()},i.prototype.onMouseWheel=function(t){var e=this.scrollerItem.viewport,i=e.scrollH-t.data;0>i?e.scrollH=0:i>this.gamesEntry.width-e.width?e.scrollH=this.gamesEntry.width-e.width:e.scrollH-=t.data},i.prototype.onCloseViewAtMessage=function(){App.MouseUtils.addMouseWheel(this.onMouseWheel,this)},i.prototype.addEvent=function(){e.prototype.addEvent.call(this),this.uProclaim.addEvent(),this.gamesEntry.addEvent(),this.lobby_headImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openUserInfo,this);for(var i in this.btnGroup.$children){var o=this.btnGroup.$children[i];App.CommonUtils.effectButton(o,this.btnOnClick,this,{name:o.name})}App.CommonUtils.effectButton(this.customerService,this.btnOnClick,this,{name:this.customerService.name}),App.CommonUtils.effectButton(this.up2MemberAnim,this.onUp2Member,this),App.CommonUtils.effectButton(this.btnProxyEntrace,this.onProxyEntrace,this),App.EffectUtils.addEffectBtn(this.uBtnVerdl,this.onDownloadVer,this,{targetName:this.uBtnVerdl.name}),this.btnRedPacket2.addEventListener(egret.TouchEvent.TOUCH_END,this.onOpenRedPac,this),App.MessageCenter.addListener(RedPacketConst.Open_View,this.onOpenRedPac,this),App.MessageCenter.addListener(t.AgConst.Open_View,this.onOpenAgView,this),App.MessageCenter.addListener(RedPacketConst.newRedEnvelopeNotity,this.RedPackNotify,this),App.MessageCenter.addListener(RedPacketConst.grabRedEnvelopeBack,this.grabRedPackBack,this),App.MessageCenter.addListener(RedPacketConst.expiredRedEnvelopeNotify,this.expirePack,this),App.MessageCenter.addListener(GameConsEvent.Game_UserUnReadMsg,this.refreshSign,this),App.MessageCenter.addListener(GameConsEvent.Game_UserUnReadEmail,this.refreshSign,this),this.scrollerItem.addEventListener(egret.Event.CHANGE,this.onScrollerChange,this),this.scrollerItem.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onScrollerBegin,this),this._mArrowLeftAnim.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onArrowTap,this),this._mArrowRightAnim.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onArrowTap,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.uProclaim.removeEvent(),this.gamesEntry.removeEvent(),this.lobby_headImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openUserInfo,this),this.btnRedPacket2.removeEventListener(egret.TouchEvent.TOUCH_END,this.onOpenRedPac,this);
for(var t in this.btnGroup.$children)App.CommonUtils.removeButton(this.btnGroup.$children[t]);App.CommonUtils.removeButton(this.customerService),App.CommonUtils.removeButton(this.up2MemberAnim),App.CommonUtils.removeButton(this.btnProxyEntrace),App.EffectUtils.removeEffectBtn(this.uBtnVerdl),this.scrollerItem.removeEventListener(egret.Event.CHANGE,this.onScrollerChange,this),this.scrollerItem.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onScrollerBegin,this),this._mArrowLeftAnim.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onArrowTap,this),this._mArrowRightAnim.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onArrowTap,this),App.MessageCenter.removeAll(this)},i.prototype.initAddImgPos=function(){this.adImgArr.forEach(function(t,e){t.x=277*e,t.y=0}.bind(this))},i.prototype.btnOnClick=function(t){if(t)switch(t.name){case"recharge":Log.trace("打开充值"),App.ViewManager.open(LobbyViewConst.Recharge,LayerManager.UI_Popup),R.sendPlayerAction("Lobbycharge_clickcharge");break;case"bank":App.ViewManager.open(LobbyViewConst.Bank,LayerManager.UI_Popup),R.sendPlayerAction("Lobbysafe_clicksafe");break;case"message":Log.trace("打开公告"),App.ViewManager.open(LobbyViewConst.Message,LayerManager.UI_Popup),App.MouseUtils.removeMouseWheel(),R.sendPlayerAction("Lobbysafe_clickmessage");break;case"activity":Log.trace("打开活动"),App.ScrollTxtTips.showTip("敬请期待！");break;case"share":Log.trace("打开分享"),App.ViewManager.open(LobbyViewConst.Share,LayerManager.UI_Popup),R.sendPlayerAction("Lobbyshare_clickshare");break;case"setting":Log.trace("打开设置"),App.ViewManager.open(LobbyViewConst.Setting,LayerManager.UI_Popup),R.sendPlayerAction("Lobbyset_clickset");break;case"exchange":Log.trace("打开兑换"),App.ViewManager.open(LobbyViewConst.Exchange,LayerManager.UI_Popup);break;case"customerService":Log.trace("打开客服"),R.sendPlayerAction("Lobbyservice_onlineservice");var e=CSModel.getUrlFromLive800();R.openUrlOutside(e),Log.log(e);break;case"mail":App.ViewManager.open(LobbyViewConst.Message,1);break;case"notice":App.ViewManager.open(LobbyViewConst.Message,2)}},i.prototype.onUp2Member=function(){App.ViewManager.open(LobbyViewConst.Register,LayerManager.UI_Popup)},i.prototype.onProxyEntrace=function(){this.applyFunc("openProxyWeb")},i.prototype.onOpenRedPac=function(){Log.log("打开红包界面"),App.ViewManager.open(LobbyViewConst.RedPacket,LayerManager.UI_Popup),this.btnRedPacket2.play(RedPackBone.Animation1)},i.prototype.onOpenAgView=function(){Log.log("打开Ag界面"),this.applyFunc("AGLoginReq"),App.ViewManager.open(LobbyViewConst.Ag,LayerManager.UI_Popup)},i.prototype.RedPackNotify=function(){Log.log("有新红包大厅播放红包摇晃动画"),this.btnRedPacket2.play(RedPackBone.Animation)},i.prototype.grabRedPackBack=function(){this.btnRedPacket2.play(RedPackBone.Animation1)},i.prototype.expirePack=function(){Log.log("有红包过期，停止动画"),this.btnRedPacket2.play(RedPackBone.Animation1)},i.prototype.openUserInfo=function(){Log.trace("打开个人中心"),R.sendPlayerAction("Lobbyself_clickphoto"),App.SoundManager.playEffect("click_mp3"),App.ViewManager.open(LobbyViewConst.UserInfo)},i.prototype.changeLobbyHeadImg=function(t,e,i){this.refresh()},i.prototype.changeNickName=function(t){this.lobby_userName.text=t,GamePlayerMgr.i.getPlayer().setNickName(t)},i.prototype.refresh=function(){var t=GamePlayerMgr.i.getPlayer();Log.trace("大厅刷新后昵称",t.getNickName()),this.lobby_headBox.source="ui_headBox_"+t.getAvatarBox(),this.lobby_headImg.source="ui_headImg_"+t.getAvatar(),this.lobby_userName.text=t.getNickName(),this.lobby_userMoney.text=""+App.CommonUtils.money2Str(t.getMoney()),this.refreshSign()},i.prototype.refreshMoney=function(t){this.lobby_userMoney.text=App.CommonUtils.money2Str(t.balance)},i.prototype.refreshSign=function(){Log.trace("刷新消息红点"),this.mailNotfiySign.visible=GamePlayerMgr.i.mUnreadMailCount>0,this.noticeNotfiySign.visible=GamePlayerMgr.i.mUnreadNoticeCount>0},i.prototype.stopFrame=function(){},i.prototype.startFrame=function(){},i.prototype.destroy=function(){e.prototype.destroy.call(this),App.TimerManager.removeAll(this),this.gamesEntry.destroy(),this._mParticleLobbyBG.destroy(),this._mParticleLobbyBG=void 0,this._mRoleAnim.destroy(),this._mRoleAnim=void 0,this._mRechargeAnim.destroy(),this._mRechargeAnim=void 0,this._mUp2MemberAnimm.destroy(),this._mUp2MemberAnimm=void 0,this.uProclaim.destroy(),this.uImgBg.filters=null,App.TimerManager.removeAll(this),this.lobby_headBox.source="ui_headBox_1",this.lobby_headImg.source="ui_headImg_1",this.lobby_userName.text="",this.lobby_userMoney.text="",this.hotGameInfo=void 0,App.MessageCenter.removeListener("UserMoneyChange",this.refreshMoney,this),App.MessageCenter.removeListener(RedPacketConst.newRedEnvelopeNotity,this.RedPackNotify,this),App.MessageCenter.removeListener(RedPacketConst.expiredRedEnvelopeNotify,this.expirePack,this),this.btnRedPacket2&&(this.btnRedPacket2.parent&&this.btnRedPacket2.parent.removeChild(this.btnRedPacket2),this.btnRedPacket2=void 0),this._mArrowLeftAnim&&(this._mArrowLeftAnim.destroy(),this._mArrowLeftAnim=void 0),this._mArrowRightAnim&&(this._mArrowRightAnim.destroy(),this._mArrowRightAnim=void 0)},i.prototype.waterEffect=function(t){var e="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",i=["precision lowp float;\nvarying vec2 vTextureCoord;","varying vec4 vColor;\n","uniform sampler2D uSampler;","uniform vec2 center;","uniform vec3 params;","uniform float time;","void main()","{","vec2 uv = vTextureCoord.xy;","vec2 texCoord = uv;","float dist = distance(uv, center);","if ( (dist <= (time + params.z)) && (dist >= (time - params.z)) )","{","float diff = (dist - time);","float powDiff = 1.0 - pow(abs(diff*params.x), params.y);","float diffTime = diff  * powDiff;","vec2 diffUV = normalize(uv - center);","texCoord = uv + (diffUV * diffTime);","}","gl_FragColor = texture2D(uSampler, texCoord);","}"].join("\n"),o=new egret.CustomFilter(e,i,{center:{x:.5,y:.5},params:{x:10,y:.8,z:.1},time:0});t.filters=[o],App.TimerManager.doFrame(1,0,function(){o.uniforms.time+=.005,o.uniforms.time>1&&(o.uniforms.time=0)},this)},i}(BaseEuiView);t.LobbyView=e,__reflect(e.prototype,"lobby.LobbyView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function t(){}return t.DeleteItem=30021,t.ShowContent=30022,t.MessageListReq=30023,t.SingleMessageReq=30024,t}();t.MessageConst=e,__reflect(e.prototype,"lobby.MessageConst")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.inits(),i.initFunc(),i.addListeners(),t.MessageMgr.i,i}return __extends(i,e),i.prototype.inits=function(){e.prototype.inits.call(this),this.messageModel=new t.MessageModel(this),this.messageProxy=new t.MessageProxy(this,this.messageModel),this.setModel(this.messageModel),this.messageView=new t.MessageView(this,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.Message,this.messageView),this.messagePromtView=new t.MessagePromptView(this,LayerManager.UI_Message),App.ViewManager.register(LobbyViewConst.MessagePrompt,this.messagePromtView),Log.trace("注册公告")},i.prototype.initFunc=function(){this.registerFunc(t.MessageConst.DeleteItem,this.deletMessageItemReq,this),this.registerFunc(t.MessageConst.ShowContent,this.showContent,this),this.registerFunc(t.MessageConst.MessageListReq,this.onMessageListReq,this),this.registerFunc(t.MessageConst.SingleMessageReq,this.onSingleMessageReq,this)},i.prototype.onMessageListReq=function(t,e){this.messageProxy.messageListReq(t,e)},i.prototype.onSingleMessageReq=function(t,e){this.messageProxy.singleMessageReq(t,e)},i.prototype.deletMessageItemReq=function(t,e){this.messageProxy.onDeleteMessageReq(t,e)},i.prototype.showContent=function(t){this.messagePromtView.showContent(t)},i.prototype.getMsgType=function(){return this.messageView.msgType},i.prototype.addListeners=function(){e.prototype.addListeners.call(this),this.messageProxy.addEvent()},i.prototype.removeListeners=function(){this.messageProxy.removeEvent()},Object.defineProperty(i.prototype,"model",{get:function(){return this.messageModel},enumerable:!0,configurable:!0}),i.prototype.destroy=function(){e.prototype.destroy.call(this),this.messageView.destroy(),this.messagePromtView.destroy(),this.messageProxy.destroy(),this.messageModel.destroy(),this.messageView=void 0,this.messagePromtView=void 0,this.messageProxy=void 0,this.messageModel=void 0},i}(BaseController);t.MessageController=e,__reflect(e.prototype,"lobby.MessageController")}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function e(){this.addEvent()}return Object.defineProperty(e,"i",{get:function(){return null==e._i&&(e._i=new e),e._i},enumerable:!0,configurable:!0}),e.prototype.addEvent=function(){App.MessageCenter.addListener(BaseProxy.Socket_Type(t.ProxyKeyConst.Lobby_SingleNotice_Back),this.onSingleNoticeAck,this),App.MessageCenter.addListener(BaseProxy.Socket_Type(t.ProxyKeyConst.Lobby_SingleMail_Back),this.onLobbySingleMailBack,this)},e.prototype.onSingleNoticeAck=function(t){GamePlayerMgr.i.mUnreadNoticeCount=t.unread_msg_count,App.MessageCenter.dispatch(GameConsEvent.Game_UserUnReadMsg)},e.prototype.onLobbySingleMailBack=function(t){GamePlayerMgr.i.mUnreadMailCount=t.unread_msg_count,App.MessageCenter.dispatch(GameConsEvent.Game_UserUnReadEmail)},e.prototype.initPoolNotice=function(t){},e.prototype.initPoolMail=function(t){},e.prototype.pushSingleNotice=function(t){},e.prototype.delSingleNotice=function(t){},e.prototype.delSingleMail=function(t){},e.prototype.pushSingleMail=function(t){},e.prototype.getSingleNoticeById=function(t){},e.prototype.getSingleMailById=function(t){},e._i=null,e}();t.MessageMgr=e,__reflect(e.prototype,"lobby.MessageMgr")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){var o=e.call(this,t,i)||this;return o.skinName="resource/lobby/skins/component/PromptSkin.exml",o.richTx=new egret.TextField,o}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.richTx.width=544,this.richTx.x=20,this.richTx.y=10,this.richTx.lineSpacing=5,this.richTx.textColor=16777215,this.richTx.fontFamily="微软雅黑",this.richTx.textAlign=egret.HorizontalAlign.LEFT,this.richTxGroup.addChild(this.richTx)},i.prototype.addEvent=function(){e.prototype.addEvent.call(this),App.CommonUtils.effectButton(this.deleteBtn,this.deleteMessage,this),App.CommonUtils.effectButton(this.closeBtn2,this.close,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),App.CommonUtils.removeButton(this.deleteBtn),App.CommonUtils.removeButton(this.closeBtn2)},i.prototype.deleteMessage=function(){var e=this.getBaseController();this.applyFunc(t.MessageConst.DeleteItem,{token:GamePlayerMgr.i.getPlayer().getToken(),id:this.currItemId},e.getMsgType()),1==e.getMsgType()?R.sendPlayerAction("Lobbysafe_deletemail"):R.sendPlayerAction("Lobbysafe_deletenotice"),App.ViewManager.closeView(this)},i.prototype.showContent=function(t){this.title.text=t.title,this.currItemId=t.id;var e=t.content.indexOf("<")+1,i=t.content.indexOf(">");if(-1==e||-1==i)return void(this.richTx.textFlow=[{text:t.content,style:{size:20,textColor:16777215}}]);var o=t.content.slice(e,i),n=t.content.slice(0,e-1),s=t.content.slice(i+1);this.richTx.textFlow=[{text:n,style:{size:20,textColor:16777215}},{text:o,style:{size:20,textColor:16774954}},{text:s,style:{size:20,textColor:16777215}}]},i.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.prototype.open.call(this,t),App.EffectUtils.showUI(this)},i.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;App.EffectUtils.hideUI(this,200,0,function(){i.closeView(t)})},i.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Log.trace("关闭弹出消息"),App.ViewManager.closeView(this)},i.prototype.clearContent=function(){this.title.text="",this.content.text=""},i.prototype.destroy=function(){e.prototype.destroy.call(this),this.richTx=void 0},i}(BaseEuiView);t.MessagePromptView=e,__reflect(e.prototype,"lobby.MessagePromptView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){var o=e.call(this,t,i)||this;return o.skinName="resource/lobby/skins/MessageViewSkin.exml",o}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.tabMailBtn.visible=!1,this.tabAnnouBtn.selected=!0,this.tabAnnouBtn.touchEnabled=!this.tabAnnouBtn.selected,this.tempCollection=new eui.ArrayCollection,this.tempList.itemRenderer=t.MessageItemRender;var i=new eui.VerticalLayout;this.tempList.layout=i,this.scrollerMessage.viewport=this.tempList,this.scrollerMessage.scrollPolicyV=eui.ScrollPolicy.ON,this.scrollerMessage.scrollPolicyH=eui.ScrollPolicy.OFF},i.prototype.onMouseWheel=function(t){common.GUtils.touchMouseWheel(this.scrollerMessage,this.tempList,t.data)},i.prototype.addEvent=function(){e.prototype.addEvent.call(this),this.tabMailBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.tabAnnouBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),App.CommonUtils.effectButton(this.closeBtn,this.closeView,this),App.MessageCenter.addListener("OnNoticeListReqBack",this.createList,this),App.MessageCenter.addListener("onMailListAck",this.createList,this),App.MessageCenter.addListener("onSingleNoticeReqBack",this.showSingleAnnou,this),App.MessageCenter.addListener("onSingleMailAck",this.showSingleAnnou,this),App.MessageCenter.addListener("onDeleteNoticeAck",this.deleteMessageItem,this),App.MessageCenter.addListener("onDeleteMailAck",this.deleteMessageItem,this),this.tempList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onAnnouList,this),this.scrollerMessage.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.nextPage,this),App.MouseUtils.addMouseWheel(this.onMouseWheel,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.tabMailBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.tabAnnouBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),App.CommonUtils.removeButton(this.closeBtn),this.tempList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onAnnouList,this),this.scrollerMessage.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.nextPage,this),App.MessageCenter.removeAll(this),App.MouseUtils.removeMouseWheel()},i.prototype.switchTab=function(t){t.currentTarget==this.tabMailBtn&&this.tabMailBtn.touchEnabled?(this.tabAnnouBtn.selected=!1,this.tabAnnouBtn.touchEnabled=!this.tabAnnouBtn.selected,this.tabMailBtn.touchEnabled=!this.tabMailBtn.selected,this.optType=1,R.sendPlayerAction("Lobbysafe_clickmail")):t.currentTarget==this.tabAnnouBtn&&this.tabAnnouBtn.touchEnabled&&(this.tabMailBtn.selected=!1,this.tabMailBtn.touchEnabled=!this.tabMailBtn.selected,this.tabAnnouBtn.touchEnabled=!this.tabAnnouBtn.selected,this.optType=2,R.sendPlayerAction("Lobbysafe_clicknotice")),this.confirmOpt()},i.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.prototype.open.call(this,t),Log.trace("param",t),this.optType=t[0],Log.trace("操作类型",this.optType),1==this.optType?(this.tabAnnouBtn.setImage("messageTab_mail_sel","messageTab_mail_nor"),this.message_title.source="mail_title"):(this.tabAnnouBtn.setImage("messageTab_annouce_sel","messageTab_annouce_nor"),this.message_title.source="notice_title"),App.EffectUtils.showUI(this),this.confirmOpt()},i.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Log.log("关闭消息"),App.EasyLoading.hideLoading();var i=this;App.EffectUtils.hideView(this,function(){App.ViewManager.closeView(i)})},i.prototype.createList=function(t){this.tempCollection.refresh();var e=t;Log.log("创建列表",e),1==this.optType&&(this.nowMailPage=e.nowpage,this.totalMailPage=e.totalpages),2==this.optType&&(this.nowAnnoucePage=e.nowpage,this.totalAnnoucePage=e.totalpages);var i=this.getBaseController().getModel(),o=this.initListData(e);i.setListData(e,this.optType),this.tempCollection.replaceAll(o),this.tempList.dataProvider=this.tempCollection,this.tempCollection.refresh()},i.prototype.deleteMessageItem=function(t){var e=this.getBaseController().getModel();this.tempCollection.getItemAt(this.tempList.selectedIndex)&&(e.deleteSingleData(t.deleted_id,this.optType),e.deleteListData(this.tempList.selectedIndex,this.optType),this.tempCollection.removeItemAt(this.tempList.selectedIndex))},i.prototype.initListData=function(t){for(var e=[],i=0;i<t.list.length;i++)e[i]={title:t.list[i].title,date:App.DateUtils.getFormatBySecond(1e3*Number(t.list[i].created_at),2),id:t.list[i].id,is_readed:t.list[i].is_readed};return e},i.prototype.confirmOpt=function(){this.tempCollection.removeAll();var e=this.getBaseController().getModel(),i={token:GamePlayerMgr.i.getPlayer().getToken(),nowpage:1};e.cleanListData(this.optType),this.applyFunc(t.MessageConst.MessageListReq,i,this.optType)},i.prototype.onAnnouList=function(e){var i=this.tempList.selectedIndex,o=this.tempList.getElementAt(i);o.data.is_readed=!0,o.refeshSign(!0);var n=this.getBaseController().getModel();n.getListData(this.optType).list[i].is_readed=!0,this.applyFunc(t.MessageConst.SingleMessageReq,{token:GamePlayerMgr.i.getPlayer().getToken(),id:o.itemId},this.optType)},i.prototype.showSingleAnnou=function(e){this.applyFunc(t.MessageConst.ShowContent,e),App.ViewManager.open(LobbyViewConst.MessagePrompt,LayerManager.UI_Tips),1==this.optType?R.sendPlayerAction("Lobbysafe_maillist"):R.sendPlayerAction("Lobbysafe_noticelist")},i.prototype.nextPage=function(){if(!(this.scrollerMessage.viewport.scrollV+this.scrollerMessage.height<this.scrollerMessage.viewport.contentHeight&&this.scrollerMessage.viewport.scrollV>0)){if(1==this.optType&&this.nowMailPage<5){this.nowMailPage=this.nowMailPage+1;var e={token:GamePlayerMgr.i.getPlayer().getToken(),nowpage:1};this.applyFunc(t.MessageConst.MessageListReq,e,this.optType)}if(2==this.optType&&this.nowAnnoucePage<5){this.nowAnnoucePage=this.nowAnnoucePage+1;var e={token:GamePlayerMgr.i.getPlayer().getToken(),nowpage:1};this.applyFunc(t.MessageConst.MessageListReq,e,this.optType)}}},Object.defineProperty(i.prototype,"msgType",{get:function(){return this.optType},enumerable:!0,configurable:!0}),i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseEuiView);t.MessageView=e,__reflect(e.prototype,"lobby.MessageView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){var o=e.call(this,t,i)||this;return o.skinName="resource/lobby/skins/ResetMPSkin.exml",o}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.oldPassword_input.inputType=egret.TextFieldInputType.PASSWORD,this.newPassword_input.inputType=egret.TextFieldInputType.PASSWORD},i.prototype.addEvent=function(){e.prototype.addEvent.call(this),App.CommonUtils.effectButton(this.getverify_phone,this.getVerify,this),App.CommonUtils.effectButton(this.confirmBtn,this.confirm,this),App.CommonUtils.effectButton(this.closeBtn,this.close,this),this.newPassword_input.addEventListener(eui.UIEvent.CHANGE,this.checkInput,this),this.oldPassword_input.addEventListener(eui.UIEvent.CHANGE,this.checkInput,this),this.phoneVerify_input.addEventListener(eui.UIEvent.CHANGE,this.checkInput,this),App.MessageCenter.addListener("onResetMoneyPwdAck",this.onGetVerifyAck,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),App.CommonUtils.removeButton(this.getverify_phone),App.CommonUtils.removeButton(this.confirmBtn),App.CommonUtils.removeButton(this.closeBtn),this.newPassword_input.removeEventListener(eui.UIEvent.CHANGE,this.checkInput,this),this.oldPassword_input.removeEventListener(eui.UIEvent.CHANGE,this.checkInput,this),this.phoneVerify_input.removeEventListener(eui.UIEvent.CHANGE,this.checkInput,this),App.MessageCenter.removeListener("onResetMoneyPwdAck",this.onGetVerifyAck,this)},i.prototype.checkInput=function(){App.StringUtils.isChinese(this.newPassword_input.text)&&(App.ScrollTxtTips.showTip("该项不能输入汉字,请重新输入"),this.newPassword_input.text=""),App.StringUtils.isChinese(this.oldPassword_input.text)&&(App.ScrollTxtTips.showTip("该项不能输入汉字,请重新输入"),this.oldPassword_input.text=""),App.StringUtils.isChinese(this.phoneVerify_input.text)&&(App.ScrollTxtTips.showTip("该项不能输入汉字,请重新输入"),this.phoneVerify_input.text=""),this.newPassword_input.text.length>6&&(App.ScrollTxtTips.showTip("请输入六位数字的新密码"),this.newPassword_input.text=""),this.oldPassword_input.text.length>6&&(App.ScrollTxtTips.showTip("请输入六位数字的旧密码"),this.oldPassword_input.text="")},i.prototype.getVerify=function(){this.applyFunc(t.SettingConst.GetCaptcha)},i.prototype.onGetVerifyAck=function(){this.oldPassword_input.text="",this.newPassword_input.text=""},i.prototype.confirm=function(){if(!this.phoneVerify_input.text&&GamePlayerMgr.i.getPlayer().getIsRegistBytel())return void App.ScrollTxtTips.showTip("请输入验证码");if(!this.newPassword_input.text)return void App.ScrollTxtTips.showTip("请输入新密码");if(this.newPassword_input.text.length<6)return void App.ScrollTxtTips.showTip("请输入六位数字的新密码");if(!this.oldPassword_input.text&&!GamePlayerMgr.i.getPlayer().getIsRegistBytel())return void App.ScrollTxtTips.showTip("请输入旧密码");var e={token:GamePlayerMgr.i.getPlayer().getToken(),new_pwd:this.newPassword_input.text,old_pwd:this.oldPassword_input.text,captcha:this.phoneVerify_input.text};this.applyFunc(t.SettingConst.ResetMoneyPassword,e)},i.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.prototype.open.call(this,t);var o=GamePlayerMgr.i.getPlayer().getIsRegistBytel();this.tempName.text=1==o?"验证码":"旧资金密码",this.oldPassword_input.visible=!o,this.getverify_phone.visible=o,this.phoneVerify_input.visible=o,this.tempTips.visible=o,App.EffectUtils.showUI(this)},i.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;App.EffectUtils.hideUI(this,200,0,function(){i.closeView(t)})},i.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Log.trace("关闭重置资金密码"),App.ViewManager.closeView(this)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseEuiView);t.ResetMoneyPasswordView=e,__reflect(e.prototype,"lobby.ResetMoneyPasswordView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function t(){}return t.CloseRegister=80001,t.ResetPassword=80002,t.ResetMoneyPassword=80003,t.GetCaptcha=80004,t}();t.SettingConst=e,__reflect(e.prototype,"lobby.SettingConst")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return Log.trace("注册设置"),t.inits(),t.registers(),t.addListeners(),t.initFunc(),t}return __extends(i,e),i.prototype.inits=function(){e.prototype.inits.call(this),this.settingModel=new t.SettingModel(this),this.settingProxy=new t.SettingProxy(this,this.settingModel)},i.prototype.registers=function(){e.prototype.registers.call(this),this.settingView=new t.SettingView(this,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.Setting,this.settingView),this.resetMPView=new t.ResetMoneyPasswordView(this,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.ResetMoneyPassword,this.resetMPView),this.resetLPView=new ResetLoginPasswordView(this,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.ResetLoginPassword,this.resetLPView),this.registerView=new RegisterView(this,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.Register,this.registerView)},i.prototype.initFunc=function(){this.registerFunc(t.SettingConst.CloseRegister,this.onCloseRegister,this),this.registerFunc("RegisterAccount",this.onRegister,this),this.registerFunc(t.SettingConst.ResetPassword,this.onResetLoginPassword,this),this.registerFunc(t.SettingConst.ResetMoneyPassword,this.onResetMoneyPassword,this),this.registerFunc(t.SettingConst.GetCaptcha,this.onGetCaptcha,this),this.registerFunc("WebLogOut",this.onLogOut,this)},i.prototype.onCloseRegister=function(){this.settingView.closeRegister()},i.prototype.onRegister=function(t){this.settingProxy.onRegister(t)},i.prototype.onResetLoginPassword=function(t){this.settingProxy.onResetLoginPassword(t)},i.prototype.onResetMoneyPassword=function(t){this.settingProxy.onResetMoneyPwd(t)},i.prototype.onLogOut=function(t){Log.trace("请求登出"),this.settingProxy.onWebLogOut(t)},i.prototype.onGetCaptcha=function(t){this.settingProxy.onGetCaptcha(t)},i.prototype.addListeners=function(){e.prototype.addListeners.call(this),this.settingProxy.addEvent(),App.MessageCenter.addListener(ResgiterConstEvent.Register_Account_Req,this.onRegister,this),App.MessageCenter.addListener(ResgiterConstEvent.Resgiter_Get_Captcha,this.onGetCaptcha,this),App.MessageCenter.addListener(ResgiterConstEvent.Register_View_Close,this.onCloseRegister,this),App.MessageCenter.addListener(ResgiterConstEvent.Register_Reset_Password,this.onResetLoginPassword,this)},i.prototype.removeListeners=function(){this.settingProxy.removeEvent(),App.MessageCenter.removeAll(this)},Object.defineProperty(i.prototype,"model",{get:function(){return this.settingModel},enumerable:!0,configurable:!0}),i.prototype.destroy=function(){e.prototype.destroy.call(this),this.settingView.destroy(),this.resetMPView.destroy(),this.resetLPView.destroy(),this.registerView.destroy(),this.settingProxy.destroy(),this.settingModel.destroy(),this.settingView=void 0,this.resetMPView=void 0,this.resetLPView=void 0,this.registerView=void 0,this.settingProxy=void 0,this.settingModel=void 0},i}(BaseController);t.SettingController=e,__reflect(e.prototype,"lobby.SettingController")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.currview=[],o.skinName="resource/lobby/skins/SettingSkin.exml",o}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.musicSetting.setImage("settingTab_music_sel","settingTab_music_nor",140,37),this.registerAccount.setImage("settingTab_register_sel","settingTab_register_nor",140,37),this.switchAccount.setImage("settingTab_switchAccoun_sel","settingTab_switchAccoun_nor",140,37),this.passwordManager.setImage("settingTab_password_sel","settingTab_password_nor",140,37),this.exit.setImage("settingTab_exit_sel","settingTab_exit_nor",140,37),this.specialEffect.selected=GamePlayerMgr.i.isOpenEffect,this.musicSetting.selected=!0,this.musicSetting.touchEnabled=!1,this.lastTarget=this.musicSetting,this.hSliderMusic.minimum=0,this.hSliderMusic.maximum=100,this.hSliderMusic.track.mask=this.hSliderMusic.trackHighlight,this.hSliderMusic.value=100*App.SoundManager.getBgVolume(),this.hSliderEffect.minimum=0,this.hSliderEffect.maximum=100,this.hSliderEffect.track.mask=this.hSliderEffect.trackHighlight,this.hSliderEffect.value=100*App.SoundManager.getEffectVolume(),this.lastView=this.content_sound,this.txtVer.text="版本号: "+GameBase.getMainVersion(),GamePlayerMgr.i.isVisiter&&(this.btn_main.removeChildAt(2),this.btn_main.removeChildAt(2)),GamePlayerMgr.i.isVisiter||this.btn_main.removeChildAt(1)},e.prototype.addEvent=function(){t.prototype.addEvent.call(this);for(var e in this.btn_main.$children)this.btn_main.$children[e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.mainBtnOnClick,this);App.CommonUtils.effectButton(this.resetLoginPassword,this.resetLP,this),App.CommonUtils.effectButton(this.resetMoneyPassword,this.resetMP,this),App.CommonUtils.effectButton(this.closeBtn,this.closeView,this),App.CommonUtils.effectButton(this.account1,this.switchLogin,this,1),App.CommonUtils.effectButton(this.account2,this.switchLogin,this,2),this.registerBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.openRegister,this),this.hSliderMusic.addEventListener(egret.Event.CHANGE,this.onChangeValue,this),this.hSliderEffect.addEventListener(egret.Event.CHANGE,this.onChangeValue,this),this.voice_off.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.soundBtnHandler,this),this.voice_on.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.soundBtnHandler,this),this.music_off.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.soundBtnHandler,this),this.music_on.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.soundBtnHandler,this),this.specialEffect.addEventListener(egret.Event.CHANGE,this.onEffectChange,this),App.MessageCenter.addListener("onWebLogOutAck",this.loginOut,this),App.MessageCenter.addListener(GameConsEvent.Game_UserChangeAccount,this.refreshAC,this)},e.prototype.removeEvent=function(){t.prototype.removeEvent.call(this);for(var e in this.btn_main.$children)this.btn_main.$children[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.mainBtnOnClick,this);App.CommonUtils.removeButton(this.resetLoginPassword),App.CommonUtils.removeButton(this.resetMoneyPassword),App.CommonUtils.removeButton(this.closeBtn),App.CommonUtils.removeButton(this.account1),App.CommonUtils.removeButton(this.account2),this.registerBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.openRegister,this),this.hSliderMusic.removeEventListener(egret.Event.CHANGE,this.onChangeValue,this),this.hSliderEffect.removeEventListener(egret.Event.CHANGE,this.onChangeValue,this),this.voice_off.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.soundBtnHandler,this),this.voice_on.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.soundBtnHandler,this),this.music_off.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.soundBtnHandler,this),this.music_on.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.soundBtnHandler,this),this.specialEffect.removeEventListener(egret.Event.CHANGE,this.onEffectChange,this),App.MessageCenter.removeListener("onWebLogOutAck",this.loginOut,this),App.MessageCenter.removeListener(GameConsEvent.Game_UserChangeAccount,this.refreshAC,this)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),App.EffectUtils.showUI(this)},e.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Log.trace("关闭设置");App.EffectUtils.hideUI(this,200,0,function(){App.ViewManager.closeView(this)},this)},e.prototype.mainBtnOnClick=function(t){if(Log.trace(t.$currentTarget.name),t.currentTarget){switch(t.currentTarget){case this.musicSetting:Log.trace("打开音乐设置"),this.switchMainBtn(this.content_sound);break;case this.registerAccount:Log.trace("打开注册设置"),this.switchMainBtn(this.content_register),App.ViewManager.open(LobbyViewConst.Register,LayerManager.UI_Message);break;case this.switchAccount:Log.trace("切换账号"),R.sendPlayerAction("Lobbyset_changeaccount"),this.refreshAC(),this.switchMainBtn(this.content_account);break;case this.passwordManager:Log.trace("密码管理"),R.sendPlayerAction("Lobbyset_passwordcontrol"),this.switchMainBtn(this.content_password);break;case this.exit:Log.trace("退出登录"),R.sendPlayerAction("Lobbyset_logoff"),this.switchMainBtn(this.content_exit),this.lastTarget.touchEnabled=!0,this.lastTarget.selected=!1,PromTipsView.getInstance().show("是否退出登录",function(){GamePlayerMgr.i.exitCurrAccount(this.loginOut,this)},function(){this.closeRegister()},this,!0)}t.currentTarget.touchEnabled=!1,this.lastTarget=t.currentTarget}},e.prototype.soundBtnHandler=function(t){switch(t.currentTarget){case this.voice_off:this.hSliderMusic.value=0,App.SoundManager.setBgOn(!1);break;case this.voice_on:this.hSliderMusic.value=100,App.SoundManager.setBgOn(!0);break;case this.music_off:this.hSliderEffect.value=0,App.SoundManager.setEffectOn(!1);break;case this.music_on:this.hSliderEffect.value=100,App.SoundManager.setEffectOn(!0)}},e.prototype.switchMainBtn=function(t){t.visible=!0,this.lastView.visible=!1,this.lastView=t,this.lastTarget.touchEnabled=!0,this.lastTarget.selected=!1},e.prototype.onChangeValue=function(t){var e;if(t.currentTarget)switch(t.currentTarget){case this.hSliderMusic:Log.trace("改变音量"),e=this.hSliderMusic.value/100,App.SoundManager.setBgVolume(e);
break;case this.hSliderEffect:e=this.hSliderEffect.value/100,App.SoundManager.setEffectVolume(e)}},e.prototype.onEffectChange=function(){GamePlayerMgr.i.setIsOpenEffect(this.specialEffect.selected)},e.prototype.resetLP=function(){R.sendPlayerAction("Lobbyset_resetsigninpsw"),App.ViewManager.open(LobbyViewConst.ResetLoginPassword,LayerManager.UI_Popup)},e.prototype.resetMP=function(){return R.sendPlayerAction("Lobbyset_resetsafepsw"),GamePlayerMgr.i.getPlayer().getIsPwdSeted()?void App.ViewManager.open(LobbyViewConst.ResetMoneyPassword,LayerManager.UI_Popup):void App.ScrollTxtTips.showTip("请前往保险箱设置密码")},e.prototype.openRegister=function(){App.ViewManager.open(LobbyViewConst.Register,LayerManager.UI_Popup)},e.prototype.refreshAC=function(){function t(t,e,i){e&&e.length>0&&(t.getChildAt(i).texture=RES.getRes(e))}var e=GamePlayerMgr.i,i=e.getAccount1(),o=e.getAccount2(),n=o&&o.length>0;this.ugAccount1.horizontalCenter=n?-131:0,this.ugAccount2.horizontalCenter=131,this.ugAccount2.visible=n,this.txtAc1.text=""+(i?i:e.getPlayer().getNickName()),this.txtAc2.text=""+o,this.accountStatus2.visible=!1,Log.trace("刷新账号切换",e.getAcIcon1(),e.getAcIconRound1()),t(this.account1,e.getAcIcon1(),0),t(this.account1,e.getAcIconRound1(),1),t(this.account2,e.getAcIcon2(),0),t(this.account2,e.getAcIconRound2(),1),this.account2._mAccount=2,""==e.mCurrAccount&&i&&(t(this.account2,e.getAcIcon1(),0),t(this.account2,e.getAcIconRound1(),1),this.ugAccount1.visible=!1,this.ugAccount2.visible=!0,this.ugAccount2.horizontalCenter=0,this.txtAc2.text=""+i,this.account2._mAccount=1)},e.prototype.switchLogin=function(t,e){Log.trace("switchLogin",t),2==t?GamePlayerMgr.i.changeLogin(this.account2._mAccount):ErrorManager.i.showError("账号当前正在使用！")},e.prototype.closeRegister=function(){Log.trace("关闭注册2",this.lastView),this.musicSetting.selected=!0,this.musicSetting.touchEnabled=!1,this.content_sound.visible=!0,this.lastTarget!=this.musicSetting&&this.lastView&&(this.lastView.visible=!1,this.lastTarget.touchEnabled=!0,this.lastTarget.selected=!1,this.lastTarget=this.musicSetting,this.lastView=this.content_sound)},e.prototype.loginOut=function(){GamePlayerMgr.i.isSwitchAccount||App.SceneManager.runScene(SceneConsts.Login)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.account1.getChildAt(0).texture=void 0,this.account1.getChildAt(1).texture=void 0,this.account2.getChildAt(0).texture=void 0,this.account2.getChildAt(1).texture=void 0},e}(BaseEuiView);t.SettingView=e,__reflect(e.prototype,"lobby.SettingView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return Log.trace("注册分享"),i.shareview=new t.ShareView(i,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.Share,i.shareview),i}return __extends(i,e),i.prototype.destroy=function(){e.prototype.destroy.call(this),this.shareview.destroy(),this.shareview=void 0},i}(BaseController);t.ShareController=e,__reflect(e.prototype,"lobby.ShareController")}(lobby||(lobby={}));var lobby;!function(t){var e=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.skinName="resource/lobby/skins/ShareSkin.exml",o}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.addEvent=function(){t.prototype.addEvent.call(this),App.CommonUtils.effectButton(this.closeBtn,this.close,this),App.CommonUtils.effectButton(this.share_copy,this.copyID,this)},e.prototype.removeEvent=function(){t.prototype.removeEvent.call(this),App.CommonUtils.removeButton(this.closeBtn),App.CommonUtils.removeButton(this.share_copy)},e.prototype.copyID=function(){R.sendPlayerAction("Lobbyshare_clickcopybutton");try{var t=document.createElement("input");t.readOnly=!0,t.value=this.wwwLocation.text,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("Copy"),document.body.removeChild(t)}catch(e){Log.trace(e)}},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),App.EffectUtils.showUI(this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;App.EffectUtils.hideUI(this,200,0,function(){i.closeView(t)})},e.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];App.ViewManager.closeView(this)},e}(BaseEuiView);t.ShareView=e,__reflect(e.prototype,"lobby.ShareView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function t(){}return t.ChangeHeadImg=30001,t}();t.UserInfoConst=e,__reflect(e.prototype,"lobby.UserInfoConst")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.inits(),i.initFunc(),i.addListeners(),i.userInfoView=new t.UserInfoView(i,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.UserInfo,i.userInfoView),i.headImgSettingView=new t.HeadImgSettingView(i,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.HeadImgSetting,i.headImgSettingView),i}return __extends(i,e),i.prototype.changeHeadImg=function(t,e,i){this.userInfoView.changeUserHeadImg(t,e,i)},i.prototype.inits=function(){e.prototype.inits.call(this),this.userInfoModel=new t.UserInfoModel(this),this.userInfoProxy=new t.UserInfoProxy(this,this.userInfoModel)},i.prototype.initFunc=function(){this.registerFunc("RoleSetting",this.onRoleSetting,this),this.registerFunc(t.UserInfoConst.ChangeHeadImg,this.changeHeadImg,this)},i.prototype.onRoleSetting=function(t){this.userInfoProxy.roleSetting(t)},i.prototype.addListeners=function(){e.prototype.addListeners.call(this),this.userInfoProxy.addEvent()},i.prototype.removeListeners=function(){this.userInfoProxy.removeEvent()},Object.defineProperty(i.prototype,"model",{get:function(){return this.userInfoModel},enumerable:!0,configurable:!0}),i.prototype.destroy=function(){e.prototype.destroy.call(this),this.userInfoView.destroy(),this.headImgSettingView.destroy(),this.userInfoModel.destroy(),this.userInfoProxy.destroy(),this.userInfoView=void 0,this.headImgSettingView=void 0,this.userInfoModel=void 0,this.userInfoProxy=void 0},i}(BaseController);t.UserInfoController=e,__reflect(e.prototype,"lobby.UserInfoController")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){var o=e.call(this,t,i)||this;return o.skinName="resource/lobby/skins/UserInfoSkin.exml",App.MessageCenter.addListener("UserMoneyChange",o.refreshMoney,o),o}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.sexList.visible=!1,this.vipLevel_s.visible=!1,this.vipLevel_b.visible=!1;var t=GamePlayerMgr.i.getPlayer().getSex();this.currSex.label=1==t?"man":"woman",this.currSex.skinName=1==t?"SexItemSkinM":"SexItemSkinW","man"==this.currSex.label&&(this.sex_switchBtn.skinName="SexItemSkinW",this.sex_switchBtn.label="woman"),"woman"==this.currSex.label&&(this.sex_switchBtn.skinName="SexItemSkinM",this.sex_switchBtn.label="man")},i.prototype.addEvent=function(){e.prototype.addEvent.call(this),this.sex_switchBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchSex,this),this.switchSexBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openSex,this),this.nameInput.addEventListener(eui.UIEvent.CHANGE,this.checkInput,this),App.CommonUtils.effectButton(this.changeHeadBtn,this.openHeadImgSettingView,this),App.CommonUtils.effectButton(this.saveNickNameBtn,this.saveNickName,this),App.CommonUtils.effectButton(this.copyIDBtn,this.copyID,this),App.CommonUtils.effectButton(this.closeBtn,this.close,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),this.sex_switchBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchSex,this),this.switchSexBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openSex,this),this.nameInput.removeEventListener(eui.UIEvent.CHANGE,this.checkInput,this),App.CommonUtils.removeButton(this.changeHeadBtn),App.CommonUtils.removeButton(this.saveNickNameBtn),App.CommonUtils.removeButton(this.copyIDBtn),App.CommonUtils.removeButton(this.closeBtn)},i.prototype.openSex=function(){this.sexList.visible=!this.sexList.visible,"man"==this.currSex.label&&(this.sex_switchBtn.skinName="SexItemSkinW",this.sex_switchBtn.label="woman"),"woman"==this.currSex.label&&(this.sex_switchBtn.skinName="SexItemSkinM",this.sex_switchBtn.label="man")},i.prototype.switchSex=function(){Log.trace("changeSex"),this.currSex.label=this.sex_switchBtn.label,this.currSex.skinName=this.sex_switchBtn.skinName,this.sexList.visible=!1;var t={sex:"man"==this.currSex.label?1:2};"man"==this.currSex.label?R.sendPlayerAction("Lobbyself_sexmale"):R.sendPlayerAction("Lobbyself_sexfemale"),this.applyFunc("RoleSetting",t)},i.prototype.openHeadImgSettingView=function(){R.sendPlayerAction("Lobbyself_setphoto"),App.ViewManager.open(LobbyViewConst.HeadImgSetting)},i.prototype.checkInput=function(){var t=this.nameInput.text;App.StringUtils.isIllegalString(t)&&(App.ScrollTxtTips.showTip("请输入没有包含特殊字符的昵称"),this.nameInput.text=""),this.nameInput.text=App.StringUtils.rejectValue(t)},i.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.prototype.open.call(this,t),App.EffectUtils.showUI(this),this.refresh(),this.refreshTxt()},i.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;App.EffectUtils.hideUI(this,200,0,function(){i.closeView(t)})},i.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Log.trace("关闭个人中心"),App.ViewManager.closeView(this)},i.prototype.changeUserHeadImg=function(t,e,i){this.refresh()},i.prototype.refresh=function(){var t=GamePlayerMgr.i.getPlayer();this.userInfo_headBox.source="ui_headBox_"+t.getAvatarBox(),this.userInfo_headImg.source="ui_headImg_"+t.getAvatar()},i.prototype.refreshTxt=function(){var t=GamePlayerMgr.i.getPlayer();this.userMoney_label.text=""+App.CommonUtils.money2Str(t.getMoney()),this.IDInput.text=""+GamePlayerMgr.i.getPlayer().mShowUid},i.prototype.saveNickName=function(){Log.trace("保存昵称");var e=this.nameInput.text.trim();if(e.length<=0)return void App.ScrollTxtTips.showTip("输入不能为空！");var i=e.split("");if(i.length>6)return void App.ScrollTxtTips.showTip("最大输入长度为6位");R.sendPlayerAction("Lobbyself_changename");var o={nickname:e};this.applyFunc("RoleSetting",o),App.ControllerManager.applyFunc(ControllerConst.Lobby,t.LobbyConst.ChangeNickName,this.nameInput.text)},i.prototype.refreshMoney=function(t){this.refreshTxt()},i.prototype.copyID=function(){if(App.IsNative)R.setClipboardInfo(this.IDInput.text);else try{var t=document.createElement("input");t.readOnly=!0,t.value=this.IDInput.text,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("Copy"),document.body.removeChild(t)}catch(e){Log.trace(e)}R.sendPlayerAction("Lobbyself_copyid"),App.ScrollTxtTips.showTip("已成功复制到粘贴板")},i.prototype.destroy=function(){e.prototype.destroy.call(this),App.MessageCenter.removeListener("UserMoneyChange",this.refreshMoney,this)},i}(BaseEuiView);t.UserInfoView=e,__reflect(e.prototype,"lobby.UserInfoView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(){function t(){}return t.ChangeHeadImg=20001,t.ChangeHeadImgBox=20002,t.ShowSign=20003,t}();t.HeadImgConst=e,__reflect(e.prototype,"lobby.HeadImgConst")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.headImgSettingView=new t.HeadImgSettingView(i,LayerManager.UI_Popup),App.ViewManager.register(LobbyViewConst.HeadImgSetting,i.headImgSettingView),i}return __extends(i,e),i.prototype.destroy=function(){e.prototype.destroy.call(this),this.headImgSettingView.destroy(),this.headImgSettingView=void 0},i}(BaseController);t.HeadImgSettingController=e,__reflect(e.prototype,"lobby.HeadImgSettingController")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){var o=e.call(this,t,i)||this;return o.skinName="resource/lobby/skins/HeadImgSettingSkin.exml",o}return __extends(i,e),i.prototype.initUI=function(){e.prototype.initUI.call(this),this.changeHeadImgBtn.selected=!0,this.changeHeadImgBtn.touchEnabled=!this.changeHeadImgBtn.selected,this.changeHeadImgBoxBtn.touchEnabled=!this.changeHeadImgBoxBtn.selected,this.changeHeadImgBtn.setImage("userInfo_changeHeadImgTab_sel","userInfo_changeHeadImgTab_nor",102,29),this.changeHeadImgBtn.setImageBg(150,44),this.changeHeadImgBoxBtn.setImage("userInfo_changeHeadBoxTab_sel","userInfo_changeHeadBoxTab_nor",125,29),this.changeHeadImgBoxBtn.setImageBg(150,44)},i.prototype.addEvent=function(){e.prototype.addEvent.call(this),App.CommonUtils.effectButton(this.saveBtn,this.saveHeadImg,this),App.CommonUtils.effectButton(this.closeBtn,this.close,this),this.changeHeadImgBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.changeHeadImgBoxBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),App.MessageCenter.addListener("roleSettingAck",this.saveHeadImgAck,this),this.headImgList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.changeIcon,this)},i.prototype.removeEvent=function(){e.prototype.removeEvent.call(this),App.CommonUtils.removeButton(this.saveBtn),App.CommonUtils.removeButton(this.closeBtn),this.changeHeadImgBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.changeHeadImgBoxBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),App.MessageCenter.removeListener("roleSettingAck",this.saveHeadImgAck,this),this.headImgList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.changeIcon,this)},i.prototype.initData=function(){e.prototype.initData.call(this),this.imgData=new eui.ArrayCollection;for(var i=GamePlayerMgr.i.getPlayer().getAvatar(),o=1;13>o;o++)this.imgData.addItem({icon:"ui_headImg_"+o,type:1,isSelected:i==o});this.imgBoxData=new eui.ArrayCollection;for(var n=GamePlayerMgr.i.getPlayer().getAvatarBox(),o=1;13>o;o++)this.imgBoxData.addItem({icon:"ui_headBox_"+o,type:2,isSelected:n==o});this.headImgList.itemRenderer=t.HeadImgItemRenderer,this.headImgList.dataProvider=this.imgData},i.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.prototype.open.call(this,t),App.EffectUtils.showUI(this),this.refresh()},i.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;this.type=void 0,this.currIcon=void 0,this.currBoxIcon=void 0,App.EffectUtils.hideUI(this,200,0,function(){i.closeView(t)})},i.prototype.refresh=function(){var t=GamePlayerMgr.i.getPlayer();this.myHeadImgBox.source="ui_headBox_"+t.getAvatarBox(),this.myHeadImg.source="ui_headImg_"+t.getAvatar()},i.prototype.closeView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Log.trace("关闭头像设置"),App.ViewManager.closeView(this)},i.prototype.changeHeadImg=function(t,e){t||(t="ui_headImg_1"),1==e?(this.myHeadImg.source=t,this.currIcon=t,this.type=e):2==e&&(this.myHeadImgBox.source=t,this.currBoxIcon=t,this.type=e)},i.prototype.closeSign=function(t){for(var e=t.dataProvider,i=0;i<e.length;i++){e.getItemAt(i).isSelected=!1;var o=t.getElementAt(i);o.refreshSign()}},i.prototype.changeIcon=function(t){this.changeData(this.headImgList)},i.prototype.changeData=function(t){var e=t.selectedItem,i=t.selectedIndex,o=t.getElementAt(i);this.closeSign(t),e.isSelected=!0,o.refreshSign(),this.changeHeadImg(e.icon,e.type)},i.prototype.saveHeadImg=function(){var t={};this.currIcon&&this.currBoxIcon&&(t={avatar:Number(this.currIcon.split("_")[2]),avatar_frame:Number(this.currBoxIcon.split("_")[2])}),this.currIcon&&!this.currBoxIcon&&(t={avatar:Number(this.currIcon.split("_")[2])}),this.currBoxIcon&&!this.currIcon&&(t={avatar_frame:Number(this.currBoxIcon.split("_")[2])}),this.currIcon||this.currBoxIcon||(t={avatar:GamePlayerMgr.i.getPlayer().getAvatar(),avatar_frame:GamePlayerMgr.i.getPlayer().getAvatarBox()}),this.applyFunc("RoleSetting",t)},i.prototype.saveHeadImgAck=function(){if(this.currIcon){var e=this.currIcon.split("_")[2];GamePlayerMgr.i.getPlayer().setAvatar(parseInt(e)),GamePlayerMgr.i.saveIcon(this.currIcon)}if(this.currBoxIcon){var i=this.currBoxIcon.split("_")[2];GamePlayerMgr.i.getPlayer().setAvatarBox(parseInt(i)),GamePlayerMgr.i.saveIconRound(this.currBoxIcon)}App.ControllerManager.applyFunc(ControllerConst.Lobby,t.LobbyConst.ChangeHeadImg,this.currIcon,this.currBoxIcon,this.type),App.ControllerManager.applyFunc(LobbyControllerConst.UserInfo,t.UserInfoConst.ChangeHeadImg,this.currIcon,this.currBoxIcon,this.type)},i.prototype.switchTab=function(t){t.currentTarget==this.changeHeadImgBtn&&this.changeHeadImgBtn.touchEnabled?(this.changeHeadImgBoxBtn.selected=!1,this.changeHeadImgBtn.touchEnabled=!this.changeHeadImgBtn.selected,this.changeHeadImgBoxBtn.touchEnabled=!this.changeHeadImgBoxBtn.selected,this.headImgList.dataProvider=this.imgData,R.sendPlayerAction("Lobbyself_changephoto")):t.currentTarget==this.changeHeadImgBoxBtn&&this.changeHeadImgBoxBtn.touchEnabled&&(this.changeHeadImgBtn.selected=!1,this.changeHeadImgBtn.touchEnabled=!this.changeHeadImgBtn.selected,this.changeHeadImgBoxBtn.touchEnabled=!this.changeHeadImgBoxBtn.selected,this.headImgList.dataProvider=this.imgBoxData,R.sendPlayerAction("Lobbyself_changeframe"))},i.prototype.destroy=function(){this._isDestroy||(e.prototype.destroy.call(this),this.imgData&&this.imgData.removeAll(),this.imgBoxData&&this.imgBoxData.removeAll(),this.headImgList.removeChildren(),this.imgData=void 0,this.imgBoxData=void 0)},i}(BaseEuiView);t.HeadImgSettingView=e,__reflect(e.prototype,"lobby.HeadImgSettingView")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){return e.call(this,t,i)||this}return __extends(i,e),i.prototype.activityListReq=function(e){Log.trace("活动列表请求",e);var i={token:e.token,nowpage:e.nowpage};this.send(t.ProxyKeyConst.Lobby_ActivityList,i),App.EasyLoading.showOnTimeOut()},i.prototype.onActivityListAck=function(t){var e=t;this.model.getListData()&&(e.list=t.list.concat(this.model.getListData().list)),App.MessageCenter.dispatch("onActivityListAck",e),App.EasyLoading.hideLoading()},i.prototype.singleActivityReq=function(e){Log.trace("单条活动请求",e);var i={token:e.token,id:e.id};this.send(t.ProxyKeyConst.Lobby_SingleActivity,i),App.EasyLoading.showOnTimeOut()},i.prototype.onSingleActivityAck=function(t){this.model.setData(t.id,t),App.MessageCenter.dispatch("onSingleActivityAck",t),App.EasyLoading.hideLoading()},i.prototype.addEvent=function(){this.addListener(t.ProxyKeyConst.Lobby_ActivityList_Back,this.onActivityListAck,this),this.addListener(t.ProxyKeyConst.Lobby_SingleActivity_Back,this.onSingleActivityAck,this)},i.prototype.removeEvent=function(){this.removeListener(t.ProxyKeyConst.Lobby_ActivityList_Back,this.onActivityListAck,this),this.removeListener(t.ProxyKeyConst.Lobby_SingleActivity_Back,this.onSingleActivityAck,this)},Object.defineProperty(i.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseProxy);t.ActivityProxy=e,__reflect(e.prototype,"lobby.ActivityProxy")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){return e.call(this,t,i)||this}return __extends(i,e),i.prototype.agBalanceReq=function(){var e=GamePlayerMgr.i.getPlayer(),i={token:e.getToken(),uid:e.getUserId()};this.send(t.ProxyKeyConst.Lobby_AgGetBalance,i),App.EasyLoading.showOnTimeOut()},i.prototype.agBalanceAck=function(e){App.MessageCenter.dispatch(t.AgConst.AG_GetBlance_Back,e),App.EasyLoading.hideLoading()},i.prototype.moneyTransformReq=function(e){var i=GamePlayerMgr.i.getPlayer(),o={token:i.getToken(),balance:e.balance,uid:i.getUserId(),password:e.password};1==e.type?this.send(t.ProxyKeyConst.Lobby_BalanceToAg,o):2==e.type&&this.send(t.ProxyKeyConst.Lobby_BalanceToGame,o),App.EasyLoading.showOnTimeOut()},i.prototype.moneyTransformAck=function(){App.isWebDecorate||(App.MessageCenter.dispatch(t.AgConst.AG_MoneyTrans_Back),App.EasyLoading.hideLoading(),Log.trace("moneyTransformAck"))},i.prototype.agUrlReq=function(){var e=GamePlayerMgr.i.getPlayer(),i={token:e.getToken(),uid:e.getUserId()};this.send(t.ProxyKeyConst.Lobby_AgUrl,i),App.EasyLoading.showOnTimeOut()},i.prototype.agUrlAck=function(t){App.isWebDecorate||(App.EasyLoading.hideLoading(),R.openUrlOutside(t.url))},Object.defineProperty(i.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),i.prototype.addEvent=function(){this.addListener(t.ProxyKeyConst.Lobby_AgGetBalance_Back,this.agBalanceAck,this),this.addListener(t.ProxyKeyConst.Lobby_BalanceToAg_Back,this.moneyTransformAck,this),this.addListener(t.ProxyKeyConst.Lobby_BalanceToGame_Back,this.moneyTransformAck,this),this.addListener(t.ProxyKeyConst.Lobby_AgUrl_Back,this.agUrlAck,this)},i.prototype.removeEvent=function(){this.removeListener(t.ProxyKeyConst.Lobby_AgGetBalance_Back,this.agBalanceAck,this),this.removeListener(t.ProxyKeyConst.Lobby_BalanceToAg_Back,this.moneyTransformAck,this),this.removeListener(t.ProxyKeyConst.Lobby_BalanceToGame_Back,this.moneyTransformAck,this),this.removeListener(t.ProxyKeyConst.Lobby_AgUrl_Back,this.agUrlAck,this)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseProxy);t.AgProxy=e,__reflect(e.prototype,"lobby.AgProxy")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){return e.call(this,t,i)||this}return __extends(i,e),i.prototype.saveMoney=function(e){Log.trace("请求存入");var i={token:e.token,money:e.money,password:e.password};this.send(t.ProxyKeyConst.Lobby_SaveMoney,i),App.EasyLoading.showOnTimeOut()},i.prototype.onSaveMoneyBack=function(t){Log.trace("onSaveMoneyBack:",t),App.EasyLoading.hideLoading(),PromTipsView.getInstance().show("存入成功");var e=GamePlayerMgr.i.getPlayer();e.setMoney(t.balance),e.setSafeMoney(t.deposit),App.MessageCenter.dispatch("UserMoneyChange",t)},i.prototype.takeMoney=function(e){Log.trace("请求取出");var i={token:e.token,money:e.money,password:e.password};this.send(t.ProxyKeyConst.Lobby_TakeMoney,i),App.EasyLoading.showOnTimeOut()},i.prototype.onTakeMoneyBack=function(t){Log.trace("onTakeMoneyBack:",t),App.EasyLoading.hideLoading(),PromTipsView.getInstance().show("取出成功");var e=GamePlayerMgr.i.getPlayer();e.setMoney(t.balance),e.setSafeMoney(t.deposit),App.MessageCenter.dispatch("UserMoneyChange",t)},i.prototype.setMoneyPwd=function(e){Log.trace("请求设置资金密码");var i={token:e.token,type:1,new_pwd:e.password};this.send(t.ProxyKeyConst.Lobby_ResetMoneyPwd,i),App.EasyLoading.showOnTimeOut()},i.prototype.onSetMoneyPwdBack=function(){Log.trace("设置密码返回"),App.EasyLoading.hideLoading(),PromTipsView.getInstance().show("设置资金密码成功"),GamePlayerMgr.i.getPlayer().setIsPwdSeted(!0),App.MessageCenter.dispatch("onSetMoneyPwdBack")},Object.defineProperty(i.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),i.prototype.addEvent=function(){Log.trace("注册回包监听"),this.addListener(t.ProxyKeyConst.Lobby_SaveMoney_Back,this.onSaveMoneyBack,this),this.addListener(t.ProxyKeyConst.Lobby_TakeMoney_Back,this.onTakeMoneyBack,this),this.addListener(t.ProxyKeyConst.Lobby_ResetMoneyPwd_Back,this.onSetMoneyPwdBack,this)},i.prototype.removeEvent=function(){this.removeListener(t.ProxyKeyConst.Lobby_SaveMoney_Back,this.onSaveMoneyBack,this),this.removeListener(t.ProxyKeyConst.Lobby_TakeMoney_Back,this.onTakeMoneyBack,this),this.removeListener(t.ProxyKeyConst.Lobby_ResetMoneyPwd_Back,this.onSetMoneyPwdBack,this)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseProxy);t.BankProxy=e,__reflect(e.prototype,"lobby.BankProxy")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){return e.call(this,t,i)||this}return __extends(i,e),i.prototype.customerSendMsgReq=function(e){var i={token:GamePlayerMgr.i.getPlayer().getToken(),text:e.text,attachment:e.attachment,attach_fmt:e.attach_fmt};this.send(t.ProxyKeyConst.Lobby_CustomerSendMsg,i),App.EasyLoading.showOnTimeOut(),Log.trace("客服发送消息",e.text)},i.prototype.customerSendMsgAck=function(t){App.ScrollTxtTips.showTip("已成功发送该消息"),App.MessageCenter.dispatch("customerSendMsgAck"),App.EasyLoading.hideLoading()},Object.defineProperty(i.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),i.prototype.addEvent=function(){this.addListener(t.ProxyKeyConst.Lobby_CustomerSendMsg_Back,this.customerSendMsgAck,this)},i.prototype.removeEvent=function(){this.removeListener(t.ProxyKeyConst.Lobby_CustomerSendMsg_Back,this.customerSendMsgAck,this)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseProxy);t.CustomerProxy=e,__reflect(e.prototype,"lobby.CustomerProxy")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){return e.call(this,t,i)||this}return __extends(i,e),i.prototype.bindBankCardListReq=function(e){var i={token:GamePlayerMgr.i.getPlayer().getToken(),type:e.type};this.send(t.ProxyKeyConst.Lobby_BindBankList,i),App.EasyLoading.showOnTimeOut(),Log.trace("获取已绑定的银行卡列表")},i.prototype.bindBankCardListAck=function(t){Log.trace("获取已绑定的银行卡列表返回",t),JSON.stringify(this.model.getBankCardList())!=JSON.stringify(t.list)&&(this.model.saveBankCardList(t.list),App.MessageCenter.dispatch("bindBankCardListAck",t)),App.EasyLoading.hideLoading()},i.prototype.bindBankCardReq=function(e){var i={};i=1==e.type?{token:GamePlayerMgr.i.getPlayer().getToken(),type:e.type,cardholder:e.cardholder,bankname:e.bankname,cardno:e.cardno}:{token:GamePlayerMgr.i.getPlayer().getToken(),type:e.type,cardholder:e.cardholder,cardno:e.cardno},this.model.setExchangeType(e.type),this.send(t.ProxyKeyConst.Lobby_BindBankCard,i),App.EasyLoading.showOnTimeOut(),Log.trace("绑定银行卡请求",i)},i.prototype.bindBankCardAck=function(t){App.MessageCenter.dispatch("bindBankCardAck",t);var e=this.model.getExchangeType();1==e?App.PromTipsView.show("你已成功绑定该银行卡"):App.PromTipsView.show("你已成功绑定该支付宝账号"),App.EasyLoading.hideLoading()},i.prototype.unBindBankCardReq=function(e){var i={token:GamePlayerMgr.i.getPlayer().getToken(),type:e.type,bankid:e.bankid};this.model.setExchangeType(e.type),this.send(t.ProxyKeyConst.Lobby_UnBindBankCard,i),App.EasyLoading.showOnTimeOut(),Log.trace("解除绑定银行卡请求",i)},i.prototype.unbindBankCardAck=function(t){var e=this.model.getCurrIndex();App.MessageCenter.dispatch("unbindBankCardAck",e);var i=this.model.getExchangeType();1==i?App.PromTipsView.show("你已成功解除绑定该银行卡"):App.PromTipsView.show("你已成功解除绑定该支付宝账号"),App.EasyLoading.hideLoading()},i.prototype.exchangeReq=function(e){var i={token:GamePlayerMgr.i.getPlayer().getToken(),money:e.money,bankid:e.bankid};this.send(t.ProxyKeyConst.Lobby_Exchange,i),App.EasyLoading.showOnTimeOut(),Log.trace("兑换请求",i)},i.prototype.exchangeAck=function(t){Log.trace("兑换返回",t),0!=t.scene||0!=t.tableid?(Log.trace("游戏未完成"),GameModuleMgr.i.saveBack2GameInfo(t.scene,t.tableid),App.PromTipsView.show("你有未完成的游戏，是否回到游戏中",function(){GameModuleMgr.i.back2GameFromLobby()},function(){},this,!0)):0===t.scene&&0===t.tableid&&(GamePlayerMgr.i.getPlayer().setMoney(t.balance),App.PromTipsView.show("兑换请求已发起成功，请耐心等待到账")),App.EasyLoading.hideLoading()},Object.defineProperty(i.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),i.prototype.addEvent=function(){this.addListener(t.ProxyKeyConst.Lobby_Exchange_Back,this.exchangeAck,this),this.addListener(t.ProxyKeyConst.Lobby_BindBankList_Back,this.bindBankCardListAck,this),this.addListener(t.ProxyKeyConst.Lobby_BindBankCard_Back,this.bindBankCardAck,this),this.addListener(t.ProxyKeyConst.Lobby_UnBindBankCard_Back,this.unbindBankCardAck,this)},i.prototype.removeEvent=function(){this.removeListener(t.ProxyKeyConst.Lobby_Exchange_Back,this.exchangeAck,this),this.removeListener(t.ProxyKeyConst.Lobby_BindBankList_Back,this.bindBankCardListAck,this),this.removeListener(t.ProxyKeyConst.Lobby_BindBankCard_Back,this.bindBankCardAck,this),this.removeListener(t.ProxyKeyConst.Lobby_UnBindBankCard_Back,this.unbindBankCardAck,this)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseProxy);t.ExchangeProxy=e,__reflect(e.prototype,"lobby.ExchangeProxy")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){return e.call(this,t,i)||this}return __extends(i,e),i.prototype.onLoginBack=function(t){Log.trace("LobbyProxy onLoginBack:1111",t),this.applyFunc("refreshView")},Object.defineProperty(i.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),i.prototype.addEvent=function(){this.addListener(GameConsEvent.Game_Player_LoginWeb_Success,this.onLoginBack,this),this.addListener(t.ProxyKeyConst.ScWorldAgentBackgroundResType,this.onGetAgentUrlBack,this),this.addListener(t.ProxyKeyConst.Lobby_AdListInfo_Back,this.onAdListAck,this),this.addListener(t.ProxyKeyConst.Lobby_AgLogin_Back,this.onAgLoginAck,this)},i.prototype.removeEvent=function(){this.removeMsgEventAll(this)},i.prototype.onGetAgentUrlBack=function(t){Log.info(t.agent_url),App.EasyLoading.hideLoading(),R.openUrlInside(t.agent_url)},i.prototype.onAdListReq=function(){var e=GamePlayerMgr.i.getPlayer(),i={uid:e.getUserId()};this.send(t.ProxyKeyConst.Lobby_AdListInfo,i),App.EasyLoading.showOnTimeOut()},i.prototype.onAdListAck=function(t){Log.trace("广告列表",t.bill_list),this.model.saveAdList(t.bill_list),this.model.setCurryIndex(0),this.model.setLastIndex(1),App.MessageCenter.dispatch("createAdSign",t.bill_list.length),App.MessageCenter.dispatch(GameConsEvent.Game_prCodeAdress,t.promotion_url),App.EasyLoading.hideLoading()},i.prototype.onAgLoginReq=function(){var e=GamePlayerMgr.i.getPlayer(),i={token:e.getToken(),uid:e.getUserId()};this.send(t.ProxyKeyConst.Lobby_AgLogin,i),App.EasyLoading.showOnTimeOut()},i.prototype.onAgLoginAck=function(t){App.MessageCenter.dispatch("AGLoginSuccess")},i.prototype.sendGetAgentUrl=function(){var e=GamePlayerMgr.i.getPlayer(),i={token:e.getToken()};this.send(t.ProxyKeyConst.CsWorldAgentBackgroundReqType,i),App.EasyLoading.showOnTimeOut()},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseProxy);t.LobbyProxy=e,__reflect(e.prototype,"lobby.LobbyProxy")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){return e.call(this,t,i)||this}return __extends(i,e),i.prototype.messageListReq=function(e,i){Log.trace("列表请求");var o={token:e.token,nowpage:e.nowpage};1==i?this.send(t.ProxyKeyConst.Lobby_MailList,o):2==i&&this.send(t.ProxyKeyConst.Lobby_NoticeList,o),App.EasyLoading.showOnTimeOutDealy()},i.prototype.onNoticeListAck=function(t){if(!App.isWebDecorate){var e=t;App.MessageCenter.dispatch("OnNoticeListReqBack",e),App.EasyLoading.hideLoading()}},i.prototype.onMailListAck=function(t){if(!App.isWebDecorate){var e=t;App.MessageCenter.dispatch("onMailListAck",e),App.EasyLoading.hideLoading()}},i.prototype.singleMessageReq=function(e,i){var o={token:e.token,id:e.id};1==i?this.send(t.ProxyKeyConst.Lobby_SingleMail,o):2==i&&this.send(t.ProxyKeyConst.Lobby_SingleNotice,o),App.EasyLoading.showOnTimeOut()},i.prototype.onSingleNoticeAck=function(t){App.isWebDecorate||(this.model.setData(t.id,t,2),App.MessageCenter.dispatch("onSingleNoticeReqBack",t),App.EasyLoading.hideLoading())},i.prototype.onSingleMailAck=function(t){App.isWebDecorate||(this.model.setData(t.id,t,1),App.MessageCenter.dispatch("onSingleMailAck",t),App.EasyLoading.hideLoading())},i.prototype.onDeleteMessageReq=function(e,i){Log.trace("删除单条公告请求");var o={token:e.token,id:e.id};1==i?this.send(t.ProxyKeyConst.Lobby_DeleteSingleMail,o):2==i&&this.send(t.ProxyKeyConst.Lobby_DeleteSingleNotice,o),App.EasyLoading.showOnTimeOut()},i.prototype.onDeleteNoticeAck=function(t){App.isWebDecorate||(Log.trace("onDeleteNoticeAck:",t),App.MessageCenter.dispatch("onDeleteNoticeAck",t),App.EasyLoading.hideLoading())},i.prototype.onDeleteMailAck=function(t){App.isWebDecorate||(Log.trace("onDeleteMailAck:",t),App.MessageCenter.dispatch("onDeleteMailAck",t),App.EasyLoading.hideLoading())},Object.defineProperty(i.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),i.prototype.addEvent=function(){this.addListener(t.ProxyKeyConst.Lobby_NoticeList_Back,this.onNoticeListAck,this),this.addListener(t.ProxyKeyConst.Lobby_SingleNotice_Back,this.onSingleNoticeAck,this),this.addListener(t.ProxyKeyConst.Lobby_DeleteSingleNotice_Back,this.onDeleteNoticeAck,this),this.addListener(t.ProxyKeyConst.Lobby_MailList_Back,this.onMailListAck,this),this.addListener(t.ProxyKeyConst.Lobby_SingleMail_Back,this.onSingleMailAck,this),this.addListener(t.ProxyKeyConst.Lobby_DeleteSingleMail_Back,this.onDeleteMailAck,this)
},i.prototype.removeEvent=function(){this.removeListener(t.ProxyKeyConst.Lobby_NoticeList_Back,this.onNoticeListAck,this),this.removeListener(t.ProxyKeyConst.Lobby_SingleNotice_Back,this.onSingleNoticeAck,this),this.removeListener(t.ProxyKeyConst.Lobby_DeleteSingleNotice_Back,this.onDeleteNoticeAck,this),this.removeListener(t.ProxyKeyConst.Lobby_MailList_Back,this.onMailListAck,this),this.removeListener(t.ProxyKeyConst.Lobby_SingleMail_Back,this.onSingleMailAck,this),this.removeListener(t.ProxyKeyConst.Lobby_DeleteSingleMail_Back,this.onDeleteMailAck,this)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseProxy);t.MessageProxy=e,__reflect(e.prototype,"lobby.MessageProxy")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){return e.call(this,t,i)||this}return __extends(i,e),i.prototype.onRegister=function(e){Log.trace("请求注册");var i={token:GamePlayerMgr.i.getPlayer().getToken(),loginame:e.loginame,password:e.password,regtype:e.registerType,captcha:e.captcha};this.send(t.ProxyKeyConst.Lobby_RegisterAccount,i),App.EasyLoading.showOnTimeOut()},i.prototype.onRegisterBack=function(t){Log.trace("SettingProxy onRegisterBack:",t),App.EasyLoading.hideLoading(),PromTipsView.getInstance().show("注册成功",function(){App.MessageCenter.dispatch("logOutAfertRegist")},function(){},this,!1)},i.prototype.onResetLoginPassword=function(e){var i;i=GamePlayerMgr.i.getPlayer().getIsRegistBytel()?{token:e.token,loginame:e.loginame,new_pwd:e.newpassword,captcha:e.captcha}:{token:e.token,loginame:e.loginame,new_pwd:e.newpassword,old_pwd:e.oldpassword},this.send(t.ProxyKeyConst.Lobby_ResetLoginPassword,i),App.EasyLoading.showOnTimeOut()},i.prototype.onResetLoginPasswordAck=function(t){PromTipsView.getInstance().show("修改密码成功",function(){var t=GamePlayerMgr.i.getPlayer(),e=GamePlayerMgr.i.isVisiter,i={usertype:e?2:1,loginame_or_deviceid:e?GameBase.getDeviceId():t.getLoginame(),uid:t.getUserId(),token:t.getToken()};this.onWebLogOut(i)},function(){},this,!1),App.MessageCenter.dispatch("onResetLoginPasswordAck"),App.EasyLoading.hideLoading()},i.prototype.onWebLogOut=function(e){var i={usertype:e.usertype,loginame_or_deviceid:e.loginame_or_deviceid,uid:e.uid,token:e.token};this.send(t.ProxyKeyConst.Lobby_webLogOut,i),App.EasyLoading.showOnTimeOut()},i.prototype.onWebLogOutAck=function(t){Log.trace("退出登录返回"),App.MessageCenter.dispatch("onWebLogOutAck"),App.EasyLoading.hideLoading()},i.prototype.onResetMoneyPwd=function(e){Log.trace("请求设置资金密码");var i;i=GamePlayerMgr.i.getPlayer().getIsRegistBytel()?{token:e.token,type:2,new_pwd:e.new_pwd,captcha:e.captcha}:{token:e.token,type:2,new_pwd:e.new_pwd,old_pwd:e.old_pwd},this.send(t.ProxyKeyConst.Lobby_ResetMoneyPwd,i),App.EasyLoading.showOnTimeOut()},i.prototype.onResetMoneyPwdAck=function(){Log.trace("设置资金密码返回"),App.EasyLoading.hideLoading(),PromTipsView.getInstance().show("设置资金密码成功"),App.MessageCenter.dispatch("onResetMoneyPwdAck"),GamePlayerMgr.i.getPlayer().setIsPwdSeted(!0)},i.prototype.onGetCaptcha=function(e){Log.trace("获取验证码");var i;i=e?{token:GamePlayerMgr.i.getPlayer().getToken(),phone_no:e.phone_no}:{token:GamePlayerMgr.i.getPlayer().getToken()},this.send(t.ProxyKeyConst.Lobby_GetCaptcha,i),App.EasyLoading.showOnTimeOut(3e4)},i.prototype.onGetCaptchaAck=function(){Log.trace("获取验证码返回"),PromTipsView.getInstance().show("验证码已发送到账号绑定的手机号上,请注意查收"),App.EasyLoading.hideLoading()},Object.defineProperty(i.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),i.prototype.addEvent=function(){this.addListener(t.ProxyKeyConst.Lobby_Lobby_RegisterAccount_Back,this.onRegisterBack,this),this.addListener(t.ProxyKeyConst.Lobby_ResetLoginPassword_Back,this.onResetLoginPasswordAck,this),this.addListener(t.ProxyKeyConst.Lobby_webLogOut_Back,this.onWebLogOutAck,this),this.addListener(t.ProxyKeyConst.Lobby_ResetMoneyPwd_Back,this.onResetMoneyPwdAck,this),this.addListener(t.ProxyKeyConst.Lobby_GetCaptcha_Back,this.onGetCaptchaAck,this)},i.prototype.removeEvent=function(){this.removeListener(t.ProxyKeyConst.Lobby_Lobby_RegisterAccount_Back,this.onRegisterBack,this),this.removeListener(t.ProxyKeyConst.Lobby_ResetLoginPassword_Back,this.onResetLoginPasswordAck,this),this.removeListener(t.ProxyKeyConst.Lobby_webLogOut_Back,this.onWebLogOutAck,this),this.removeListener(t.ProxyKeyConst.Lobby_ResetMoneyPwd_Back,this.onResetMoneyPwdAck,this),this.removeListener(t.ProxyKeyConst.Lobby_GetCaptcha_Back,this.onGetCaptchaAck,this)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseProxy);t.SettingProxy=e,__reflect(e.prototype,"lobby.SettingProxy")}(lobby||(lobby={}));var lobby;!function(t){var e=function(e){function i(t,i){return e.call(this,t,i)||this}return __extends(i,e),i.prototype.roleSetting=function(e){this.send(t.ProxyKeyConst.Lobby_roleSetting,e),App.EasyLoading.showOnTimeOut()},i.prototype.roleSettingAck=function(t){App.MessageCenter.dispatch("roleSettingAck"),App.EasyLoading.hideLoading(),PromTipsView.getInstance().show("设置成功")},Object.defineProperty(i.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),i.prototype.addEvent=function(){this.addListener(t.ProxyKeyConst.Lobby_roleSetting_Back,this.roleSettingAck,this)},i.prototype.removeEvent=function(){this.removeListener(t.ProxyKeyConst.Lobby_roleSetting_Back,this.roleSettingAck,this)},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(BaseProxy);t.UserInfoProxy=e,__reflect(e.prototype,"lobby.UserInfoProxy")}(lobby||(lobby={}));var qr;!function(t){var e=function(){function e(e){this.mode=t.QRMode.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var i=0,o=this.data.length;o>i;i++){var n=[],s=this.data.charCodeAt(i);s>65536?(n[0]=240|(1835008&s)>>>18,n[1]=128|(258048&s)>>>12,n[2]=128|(4032&s)>>>6,n[3]=128|63&s):s>2048?(n[0]=224|(61440&s)>>>12,n[1]=128|(4032&s)>>>6,n[2]=128|63&s):s>128?(n[0]=192|(1984&s)>>>6,n[1]=128|63&s):n[0]=s,this.parsedData.push(n)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return e.prototype.getLength=function(t){return this.parsedData.length},e.prototype.write=function(t){for(var e=0,i=this.parsedData.length;i>e;e++)t.put(this.parsedData[e],8)},e}();t.QR8bitByte=e,__reflect(e.prototype,"qr.QR8bitByte")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){this.buffer=[],this.length=0}return t.prototype.get=function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},t.prototype.put=function(t,e){for(var i=0;e>i;i++)this.putBit(1==(t>>>e-i-1&1))},t.prototype.getLengthInBits=function(){return this.length},t.prototype.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++},t}();t.QRBitBuffer=e,__reflect(e.prototype,"qr.QRBitBuffer")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.create=function(i,o,n,s,r){void 0===o&&(o=200),void 0===n&&(n=200),void 0===s&&(s=0),void 0===r&&(r=2);var a={width:o,height:n,correctLevel:t.QRErrorCorrectLevel.H,color:s},h=new t.QRCodeModel(t.QRUtil._getTypeNumber(i,a.correctLevel),a.correctLevel);return h.addData(i),h.make(),e.draw(h,a)},e.draw=function(t,e){var i=new egret.Sprite,e=e,o=t.getModuleCount();Log.trace("二维码模块数量",o);var n=Math.floor(e.width/o),s=Math.floor(e.height/o);i.graphics.beginFill(e.color);for(var r=0;o>r;r++)for(var a=0;o>a;a++){var h=t.isDark(r,a);h&&i.graphics.drawRect(a*n,r*s,n,s)}return i.graphics.endFill(),i},e}();t.QRCode=e,__reflect(e.prototype,"qr.QRCode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}return e.prototype.addData=function(e){var i=new t.QR8bitByte(e);this.dataList.push(i),this.dataCache=null},e.prototype.isDark=function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},e.prototype.getModuleCount=function(){return this.moduleCount},e.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},e.prototype.makeImpl=function(t,i){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++){this.modules[o]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[o][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,i),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,i)},e.prototype.setupPositionProbePattern=function(t,e){for(var i=-1;7>=i;i++)if(!(-1>=t+i||this.moduleCount<=t+i))for(var o=-1;7>=o;o++)-1>=e+o||this.moduleCount<=e+o||(i>=0&&6>=i&&(0==o||6==o)||o>=0&&6>=o&&(0==i||6==i)||i>=2&&4>=i&&o>=2&&4>=o?this.modules[t+i][e+o]=!0:this.modules[t+i][e+o]=!1)},e.prototype.getBestMaskPattern=function(){for(var e=0,i=0,o=0;8>o;o++){this.makeImpl(!0,o);var n=t.QRUtil.getLostPoint(this);(0==o||e>n)&&(e=n,i=o)}return i},e.prototype.createMovieClip=function(t,e,i){var o=t.createEmptyMovieClip(e,i),n=1;this.make();for(var s=0;s<this.modules.length;s++)for(var r=s*n,a=0;a<this.modules[s].length;a++){var h=a*n,p=this.modules[s][a];p&&(o.beginFill(0,100),o.moveTo(h,r),o.lineTo(h+n,r),o.lineTo(h+n,r+n),o.lineTo(h,r+n),o.endFill())}return o},e.prototype.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},e.prototype.setupPositionAdjustPattern=function(){for(var e=t.QRUtil.getPatternPosition(this.typeNumber),i=0;i<e.length;i++)for(var o=0;o<e.length;o++){var n=e[i],s=e[o];if(null==this.modules[n][s])for(var r=-2;2>=r;r++)for(var a=-2;2>=a;a++)-2==r||2==r||-2==a||2==a||0==r&&0==a?this.modules[n+r][s+a]=!0:this.modules[n+r][s+a]=!1}},e.prototype.setupTypeNumber=function(e){for(var i=t.QRUtil.getBCHTypeNumber(this.typeNumber),o=0;18>o;o++){var n=!e&&1==(i>>o&1);this.modules[Math.floor(o/3)][o%3+this.moduleCount-8-3]=n}for(var o=0;18>o;o++){var n=!e&&1==(i>>o&1);this.modules[o%3+this.moduleCount-8-3][Math.floor(o/3)]=n}},e.prototype.setupTypeInfo=function(e,i){for(var o=this.errorCorrectLevel<<3|i,n=t.QRUtil.getBCHTypeInfo(o),s=0;15>s;s++){var r=!e&&1==(n>>s&1);6>s?this.modules[s][8]=r:8>s?this.modules[s+1][8]=r:this.modules[this.moduleCount-15+s][8]=r}for(var s=0;15>s;s++){var r=!e&&1==(n>>s&1);8>s?this.modules[8][this.moduleCount-s-1]=r:9>s?this.modules[8][15-s-1+1]=r:this.modules[8][15-s-1]=r}this.modules[this.moduleCount-8][8]=!e},e.prototype.mapData=function(e,i){for(var o=-1,n=this.moduleCount-1,s=7,r=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var h=0;2>h;h++)if(null==this.modules[n][a-h]){var p=!1;r<e.length&&(p=1==(e[r]>>>s&1));var c=t.QRUtil.getMask(i,n,a-h);c&&(p=!p),this.modules[n][a-h]=p,s--,-1==s&&(r++,s=7)}if(n+=o,0>n||this.moduleCount<=n){n-=o,o=-o;break}}},e.createData=function(i,o,n){for(var s=t.QRRSBlock.getRSBlocks(i,o),r=new t.QRBitBuffer,a=0;a<n.length;a++){var h=n[a];r.put(h.mode,4),r.put(h.getLength(),t.QRUtil.getLengthInBits(h.mode,i)),h.write(r)}for(var p=0,a=0;a<s.length;a++)p+=s[a].dataCount;if(r.getLengthInBits()>8*p)throw new Error("code length overflow. ("+r.getLengthInBits()+">"+8*p+")");for(r.getLengthInBits()+4<=8*p&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(!1);for(;!(r.getLengthInBits()>=8*p)&&(r.put(e.PAD0,8),!(r.getLengthInBits()>=8*p));)r.put(e.PAD1,8);return e.createBytes(r,s)},e.createBytes=function(e,i){for(var o=0,n=0,s=0,r=new Array(i.length),a=new Array(i.length),h=0;h<i.length;h++){var p=i[h].dataCount,c=i[h].totalCount-p;n=Math.max(n,p),s=Math.max(s,c),r[h]=new Array(p);for(var l=0;l<r[h].length;l++)r[h][l]=255&e.buffer[l+o];o+=p;var u=t.QRUtil.getErrorCorrectPolynomial(c),y=new t.QRPolynomial(r[h],u.getLength()-1),d=y.mod(u);a[h]=new Array(u.getLength()-1);for(var l=0;l<a[h].length;l++){var g=l+d.getLength()-a[h].length;a[h][l]=g>=0?d.get(g):0}}for(var m=0,l=0;l<i.length;l++)m+=i[l].totalCount;for(var b=new Array(m),f=0,l=0;n>l;l++)for(var h=0;h<i.length;h++)l<r[h].length&&(b[f++]=r[h][l]);for(var l=0;s>l;l++)for(var h=0;h<i.length;h++)l<a[h].length&&(b[f++]=a[h][l]);return b},e.PAD0=236,e.PAD1=17,e}();t.QRCodeModel=e,__reflect(e.prototype,"qr.QRCodeModel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.L=1,t.M=0,t.Q=3,t.H=2,t}();t.QRErrorCorrectLevel=e,__reflect(e.prototype,"qr.QRErrorCorrectLevel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.PATTERN000=0,t.PATTERN001=1,t.PATTERN010=2,t.PATTERN011=3,t.PATTERN100=4,t.PATTERN101=5,t.PATTERN110=6,t.PATTERN111=7,t}();t.QRMaskPattern=e,__reflect(e.prototype,"qr.QRMaskPattern")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.glog=function(e){return t.isInit||t.init(),1>e&&console.log("错误:n="+e),t.LOG_TABLE[e]},t.gexp=function(e){for(t.isInit||t.init();0>e;)e+=255;for(;e>=256;)e-=255;return t.EXP_TABLE[e]},t.init=function(){t.isInit=!0;for(var e=0;8>e;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;256>e;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;255>e;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e},t.EXP_TABLE=new Array(256),t.LOG_TABLE=new Array(256),t}();t.QRMath=e,__reflect(e.prototype,"qr.QRMath")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.MODE_NUMBER=1,t.MODE_ALPHA_NUM=2,t.MODE_8BIT_BYTE=4,t.MODE_KANJI=8,t}();t.QRMode=e,__reflect(e.prototype,"qr.QRMode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var i=0;i<t.length&&0==t[i];)i++;this.num=new Array(t.length-i+e);for(var o=0;o<t.length-i;o++)this.num[o]=t[o+i]}return e.prototype.get=function(t){return this.num[t]},e.prototype.getLength=function(){return this.num.length},e.prototype.multiply=function(i){for(var o=new Array(this.getLength()+i.getLength()-1),n=0;n<this.getLength();n++)for(var s=0;s<i.getLength();s++)o[n+s]^=t.QRMath.gexp(t.QRMath.glog(this.get(n))+t.QRMath.glog(i.get(s)));return new e(o,0)},e.prototype.mod=function(i){if(this.getLength()-i.getLength()<0)return this;for(var o=t.QRMath.glog(this.get(0))-t.QRMath.glog(i.get(0)),n=new Array(this.getLength()),s=0;s<this.getLength();s++)n[s]=this.get(s);for(var s=0;s<i.getLength();s++)n[s]^=t.QRMath.gexp(t.QRMath.glog(i.get(s))+o);return new e(n,0).mod(i)},e}();t.QRPolynomial=e,__reflect(e.prototype,"qr.QRPolynomial")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.totalCount=t,this.dataCount=e}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,i){var o=e.getRsBlockTable(t,i);if(void 0==o)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+i);for(var n=o.length/3,s=[],r=0;n>r;r++)for(var a=o[3*r+0],h=o[3*r+1],p=o[3*r+2],c=0;a>c;c++)s.push(new e(h,p));return s},e.getRsBlockTable=function(i,o){switch(o){case t.QRErrorCorrectLevel.L:return e.RS_BLOCK_TABLE[4*(i-1)+0];case t.QRErrorCorrectLevel.M:return e.RS_BLOCK_TABLE[4*(i-1)+1];case t.QRErrorCorrectLevel.Q:return e.RS_BLOCK_TABLE[4*(i-1)+2];case t.QRErrorCorrectLevel.H:return e.RS_BLOCK_TABLE[4*(i-1)+3];default:return}},e}();t.QRRSBlock=e,__reflect(e.prototype,"qr.QRRSBlock")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.getBCHTypeInfo=function(t){for(var i=t<<10;e.getBCHDigit(i)-e.getBCHDigit(e.G15)>=0;)i^=e.G15<<e.getBCHDigit(i)-e.getBCHDigit(e.G15);return(t<<10|i)^e.G15_MASK},e.getBCHTypeNumber=function(t){for(var i=t<<12;e.getBCHDigit(i)-e.getBCHDigit(e.G18)>=0;)i^=e.G18<<e.getBCHDigit(i)-e.getBCHDigit(e.G18);return t<<12|i},e.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},e.getPatternPosition=function(t){return e.PATTERN_POSITION_TABLE[t-1]},e.getMask=function(e,i,o){switch(e){case t.QRMaskPattern.PATTERN000:return(i+o)%2==0;case t.QRMaskPattern.PATTERN001:return i%2==0;case t.QRMaskPattern.PATTERN010:return o%3==0;case t.QRMaskPattern.PATTERN011:return(i+o)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(i/2)+Math.floor(o/3))%2==0;case t.QRMaskPattern.PATTERN101:return i*o%2+i*o%3==0;case t.QRMaskPattern.PATTERN110:return(i*o%2+i*o%3)%2==0;case t.QRMaskPattern.PATTERN111:return(i*o%3+(i+o)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},e.getErrorCorrectPolynomial=function(e){for(var i=new t.QRPolynomial([1],0),o=0;e>o;o++)i=i.multiply(new t.QRPolynomial([1,t.QRMath.gexp(o)],0));return i},e.getLengthInBits=function(e,i){if(i>=1&&10>i)switch(e){case t.QRMode.MODE_NUMBER:return 10;case t.QRMode.MODE_ALPHA_NUM:return 9;case t.QRMode.MODE_8BIT_BYTE:return 8;case t.QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>i)switch(e){case t.QRMode.MODE_NUMBER:return 12;case t.QRMode.MODE_ALPHA_NUM:return 11;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>i))throw new Error("type:"+i);switch(e){case t.QRMode.MODE_NUMBER:return 14;case t.QRMode.MODE_ALPHA_NUM:return 13;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},e.getLostPoint=function(t){for(var e=t.getModuleCount(),i=0,o=0;e>o;o++)for(var n=0;e>n;n++){for(var s=0,r=t.isDark(o,n),a=-1;1>=a;a++)if(!(0>o+a||o+a>=e))for(var h=-1;1>=h;h++)0>n+h||n+h>=e||(0!=a||0!=h)&&r==t.isDark(o+a,n+h)&&s++;s>5&&(i+=3+s-5)}for(var o=0;e-1>o;o++)for(var n=0;e-1>n;n++){var p=0;t.isDark(o,n)&&p++,t.isDark(o+1,n)&&p++,t.isDark(o,n+1)&&p++,t.isDark(o+1,n+1)&&p++,(0==p||4==p)&&(i+=3)}for(var o=0;e>o;o++)for(var n=0;e-6>n;n++)t.isDark(o,n)&&!t.isDark(o,n+1)&&t.isDark(o,n+2)&&t.isDark(o,n+3)&&t.isDark(o,n+4)&&!t.isDark(o,n+5)&&t.isDark(o,n+6)&&(i+=40);for(var n=0;e>n;n++)for(var o=0;e-6>o;o++)t.isDark(o,n)&&!t.isDark(o+1,n)&&t.isDark(o+2,n)&&t.isDark(o+3,n)&&t.isDark(o+4,n)&&!t.isDark(o+5,n)&&t.isDark(o+6,n)&&(i+=40);for(var c=0,n=0;e>n;n++)for(var o=0;e>o;o++)t.isDark(o,n)&&c++;var l=Math.abs(100*c/e/e-50)/5;return i+=10*l},e.prototype.static_isSupportCanvas=function(){return"undefined"!=typeof CanvasRenderingContext2D},e._getTypeNumber=function(i,o){for(var n=1,s=e._getUTF8Length(i),r=0,a=e.QRCodeLimitLength.length;a>=r;r++){var h=0;switch(o){case t.QRErrorCorrectLevel.L:h=e.QRCodeLimitLength[r][0];break;case t.QRErrorCorrectLevel.M:h=e.QRCodeLimitLength[r][1];break;case t.QRErrorCorrectLevel.Q:h=e.QRCodeLimitLength[r][2];break;case t.QRErrorCorrectLevel.H:h=e.QRCodeLimitLength[r][3]}if(h>=s)break;n++}if(n>e.QRCodeLimitLength.length)throw new Error("Too long data");return n},e._getUTF8Length=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)},e.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],e.G15=1335,e.G18=7973,e.G15_MASK=21522,e.QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],e}();t.QRUtil=e,__reflect(e.prototype,"qr.QRUtil")}(qr||(qr={}));